$DisplayFunction = Module[{System`Private`file = OpenTemporary[]}, 
			  Display[{$Display, System`Private`file}, #1]; System`Private`file = 
			  Close[System`Private`file]; System`Private`$DisplayLinkCommands[
			      System`Private`file, $DisplayTitle]; #1] &;

WeightedMean[ points:{ { ( _Integer | _Real ), ( _Integer | _Real ) } .. } ] := Module[
    { xoversig2sum, oneoversig2sum },
    xoversig2sum = Plus @@ ( ( #[[1]] / #[[2]]^2 )& /@ points );
    oneoversig2sum = Plus @@ ( ( 1 / #[[2]]^2 )& /@ points );
    If[ oneoversig2sum == 0, { 0, 0 },
	{ xoversig2sum / oneoversig2sum, Sqrt[ 1 / oneoversig2sum ] } ] ];

<< "../tools/kf_fits.m"

first = { { 2 * 5.00163, 3.16, 0.07 },
	  { 2 * 5.00164, 3.19, 0.10 },
	  { 2 * 5.00156, 3.30, 0.08 },
	  { 2 * 5.00156, 3.41, 0.09 },
	  { 2 * 5.00156, 3.22, 0.08 },
	  { 2 * 5.00162, 3.23, 0.06 },
	  { 2 * 5.00162, 3.36, 0.06 },
	  { 2 * 5.00162, 3.27, 0.09 },
	  { 2 * 5.00163, 3.33, 0.06 },
	  { 2 * 5.00157, 3.37, 0.09 },
	  { 2 * 5.00109, 3.47, 0.13 },
	  { 2 * 5.00158, 3.27, 0.05 },
	  { 2 * 5.00160, 3.31, 0.04 },
	  { 2 * 5.00163, 3.63, 0.18 },
	  { 2 * 5.00160, 3.24, 0.05 },
	  { 2 * 5.00262, 3.14, 0.09 },
	  { 2 * 5.00352, 3.32, 0.28 },
	  { 2 * 5.00866, 4.43, 0.26 },
	  { 2 * 5.00861, 4.18, 0.26 },
	  { 2 * 5.01559, 5.67, 0.36 },
	  { 2 * 5.01062, 7.43, 0.09 },
	  { 2 * 5.01065, 7.43, 0.09 },
	  { 2 * 5.01061, 7.60, 0.09 },
	  { 2 * 5.01063, 7.57, 0.09 },
	  { 2 * 5.01063, 7.39, 0.09 },
	  { 2 * 5.02665, 3.63, 0.05 },
	  { 2 * 5.00858, 4.44, 0.06 },
	  { 2 * 5.01534, 6.22, 0.10 },
	  { 2 * 5.01535, 6.25, 0.14 },
	  { 2 * 5.01538, 6.44, 0.19 },
	  { 2 * 5.02062, 3.79, 0.08 },
	  { 2 * 5.00653, 3.15, 0.24 },
	  { 2 * 5.00656, 3.85, 0.18 },
	  { 2 * 5.00655, 3.34, 0.07 },
	  { 2 * 5.01756, 4.19, 0.06 },
	  { 2 * 5.01067, 7.69, 0.17 },
	  { 2 * 5.01071, 7.69, 0.11 },
	  { 2 * 5.01063, 7.58, 0.10 },
	  { 2 * 5.01065, 7.51, 0.13 },
	  { 2 * 5.01264, 9.74, 0.12 },
	  { 2 * 5.01258, 9.67, 0.18 },
	  { 2 * 5.01261, 9.50, 0.28 },
	  { 2 * 5.01261, 10.0, 0.48 },
	  { 2 * 5.01271, 10.0, 0.22 },
	  { 2 * 5.01255, 9.44, 0.12 },
	  { 2 * 5.01256, 9.77, 0.15 },
	  { 2 * 5.01265, 9.53, 0.15 },
	  { 2 * 5.01266, 9.53, 0.09 },
	  { 2 * 5.01274, 9.58, 0.10 },
	  { 2 * 5.01275, 9.59, 0.09 },
	  { 2 * 5.01272, 9.59, 0.17 },
	  { 2 * 5.01275, 9.44, 0.16 },
	  { 2 * 5.01280, 9.36, 0.09 },
	  { 2 * 5.01285, 9.78, 0.20 },
	  { 2 * 5.01285, 9.67, 0.22 },
	  { 2 * 5.01286, 9.39, 0.09 },
	  { 2 * 5.01285, 9.21, 0.09 },
	  { 2 * 5.01280, 9.27, 0.53 },
	  { 2 * 5.01283, 9.50, 0.12 },
	  { 2 * 5.01280, 9.92, 0.25 },
	  { 2 * 5.01283, 9.36, 0.26 },
	  { 2 * 5.01285, 9.31, 0.09 },
	  { 2 * 5.01289, 9.89, 0.27 },
	  { 2 * 5.01291, 9.24, 0.09 },
	  { 2 * 5.01289, 9.29, 0.09 },
	  { 2 * 5.01287, 9.33, 0.08 },
	  { 2 * 5.01286, 9.41, 0.08 },
	  { 2 * 5.01286, 9.40, 0.09 },
	  { 2 * 5.01286, 9.49, 0.17 },
	  { 2 * 5.01286, 9.26, 0.10 },
	  { 2 * 5.01286, 9.29, 0.24 },
	  { 2 * 5.01286, 9.46, 0.09 },
	  { 2 * 5.01288, 9.50, 0.08 },
	  { 2 * 5.01288, 9.40, 0.08 },
	  { 2 * 5.01283, 9.62, 0.08 },
	  { 2 * 5.01283, 9.46, 0.08 },
	  { 2 * 5.01281, 9.51, 0.09 },
	  { 2 * 5.01289, 9.36, 0.09 },
	  { 2 * 5.01290, 9.48, 0.08 },
	  { 2 * 5.01291, 9.66, 0.12 },
	  { 2 * 4.99860, 3.45, 0.15 },
	  { 2 * 4.99855, 3.07, 0.20 },
	  { 2 * 4.99860, 3.34, 0.15 },
	  { 2 * 4.99863, 3.41, 0.06 },
	  { 2 * 4.99856, 3.33, 0.05 },
	  { 2 * 4.99864, 3.33, 0.05 },
	  { 2 * 4.99862, 3.25, 0.05 },
	  { 2 * 4.99863, 3.23, 0.05 },
	  { 2 * 4.99862, 3.29, 0.06 },
	  { 2 * 4.99861, 3.41, 0.05 },
	  { 2 * 4.99853, 3.29, 0.05 },
	  { 2 * 4.99864, 3.33, 0.05 },
	  { 2 * 4.99859, 3.35, 0.05 },
	  { 2 * 4.99856, 3.28, 0.05 },
	  { 2 * 4.99860, 3.41, 0.05 },
	  { 2 * 4.99867, 3.34, 0.05 },
	  { 2 * 4.99862, 3.28, 0.06 } };

second = { { 2 * 5.01066, 7.75, 0.09 },
	   { 2 * 5.01063, 7.76, 0.09 },
	   { 2 * 5.01063, 7.56, 0.09 },
	   { 2 * 5.01061, 7.78, 0.09 },
	   { 2 * 5.02662, 3.66, 0.06 },
	   { 2 * 5.00871, 4.64, 0.07 },
	   { 2 * 5.01547, 6.12, 0.08 },
	   { 2 * 5.01548, 6.07, 0.09 },
	   { 2 * 5.02068, 3.88, 0.06 },
	   { 2 * 5.00676, 3.46, 0.06 },
	   { 2 * 5.01768, 4.20, 0.08 },
	   { 2 * 5.01073, 7.78, 0.09 },
	   { 2 * 5.01071, 7.85, 0.09 },
	   { 2 * 5.01074, 7.79, 0.09 },
	   { 2 * 5.01264, 9.50, 0.15 },
	   { 2 * 4.99876, 3.32, 0.05 },
	   { 2 * 4.99878, 3.33, 0.05 },
	   { 2 * 4.99878, 3.25, 0.05 },
	   { 2 * 4.99881, 3.23, 0.05 },
	   { 2 * 4.99883, 3.32, 0.05 },
	   { 2 * 4.99886, 3.40, 0.08 },
	   { 2 * 4.99885, 3.32, 0.05 },
	   { 2 * 4.99889, 3.33, 0.05 },
	   { 2 * 4.99886, 3.36, 0.06 },
	   { 2 * 4.99889, 3.33, 0.05 },
	   { 2 * 4.99883, 3.33, 0.05 },
	   { 2 * 4.99883, 3.34, 0.06 },
	   { 2 * 4.99880, 3.28, 0.05 },
	   { 2 * 4.99883, 3.30, 0.05 },
	   { 2 * 4.99884, 3.35, 0.05 },
	   { 2 * 4.99884, 3.39, 0.05 },
	   { 2 * 5.01259, 9.64, 0.09 },
	   { 2 * 5.01266, 9.53, 0.09 },
	   { 2 * 5.01266, 9.17, 0.11 },
	   { 2 * 5.01270, 9.73, 0.11 },
	   { 2 * 5.01267, 9.41, 0.09 },
	   { 2 * 5.01267, 9.40, 0.09 },
	   { 2 * 5.01266, 9.47, 0.09 },
	   { 2 * 5.01265, 9.32, 0.09 },
	   { 2 * 5.01268, 9.51, 0.10 },
	   { 2 * 5.01272, 9.34, 0.12 },
	   { 2 * 5.01269, 9.48, 0.18 },
	   { 2 * 5.01269, 9.41, 0.09 },
	   { 2 * 5.01273, 9.42, 0.13 },
	   { 2 * 5.01274, 9.27, 0.17 },
	   { 2 * 5.01271, 9.43, 0.09 },
	   { 2 * 5.01271, 9.50, 0.09 },
	   { 2 * 5.01274, 9.40, 0.09 },
	   { 2 * 5.01277, 9.36, 0.10 },
	   { 2 * 5.01290, 9.36, 0.09 },
	   { 2 * 5.01298, 9.46, 0.11 },
	   { 2 * 5.01300, 9.18, 0.19 },
	   { 2 * 5.01303, 9.33, 0.09 },
	   { 2 * 5.01266, 9.72, 0.34 },
	   { 2 * 5.01269, 9.03, 0.19 },
	   { 2 * 5.01261, 9.58, 0.09 },
	   { 2 * 5.01257, 9.44, 0.09 },
	   { 2 * 5.01255, 9.50, 0.11 },
	   { 2 * 5.01258, 9.32, 0.09 },
	   { 2 * 5.01260, 9.49, 0.08 },
	   { 2 * 5.01259, 9.37, 0.08 } };

( firstfit = FitToFunc[ KuraevFadinY2s, first ] ) // InputForm

firstfit = 
{127.82559587400397, 93, {KFJustFunc, {121.66295398324662, 10.02451694773903, 
   4.127893411968313, 3.72117903100971}, {area, mean, sigma, back}, 
  {"MeV nb", "GeV", "MeV", "nb"}, 
  {{0.5819153301693653, 9.761633902156581*^-6, 0.021486342455557486, 
    -0.0024934198259887754}, {9.761633902156398*^-6, 7.266472996137893*^-10, 
    4.407879085519752*^-7, -1.053438429663937*^-8}, 
   {0.02148634245555745, 4.407879085519818*^-7, 0.0009080839358366424, 
    -0.000053958646320424095}, {-0.0024934198259887867, 
    -1.0534384296640067*^-8, -0.00005395864632042465, 
    0.00006646348805834195}}}}

( secondfit = FitToFunc[ KuraevFadinY2s, second ] ) // InputForm

secondfit = 
{65.31992205970005, 57, {KFJustFunc, {124.0664459169152, 10.024415306620826, 
   4.261114709545921, 3.7359973974945486}, {area, mean, sigma, back}, 
  {"MeV nb", "GeV", "MeV", "nb"}, 
  {{0.6012335939369146, 7.110263435668404*^-6, 0.02071434903075605, 
    -0.0034947456059051464}, {7.110263435668521*^-6, 7.032367668520818*^-10, 
    2.8895301407141206*^-7, -7.729362982852103*^-9}, 
   {0.02071434903075607, 2.8895301407141195*^-7, 0.0008442689839768714, 
    -0.0000702717627310339}, {-0.003494745605905132, -7.729362982850497*^-9, 
    -0.00007027176273103334, 0.00009643471407455845}}}}

Print[ firstfit[[3]][[2]][[3]], " +/- ", Sqrt[firstfit[[3]][[5]][[3,3]]], " MeV" ]

4.14257 +/- 0.0301005 MeV

Print[ secondfit[[3]][[2]][[3]], " +/- ", Sqrt[secondfit[[3]][[5]][[3,3]]], " MeV" ]

4.27456 +/- 0.0290535 MeV

$DisplayFunction = Display[ "firstfit.gif", #, "GIF" ]&;
PlotFuncData[ firstfit[[3]], first,
	      "First Y(2s) scan",
	      {ImageSize->72*6, PlotRange->{9.002,10.058}} ];

$DisplayFunction = Display[ "secondfit.gif", #, "GIF" ]&;
PlotFuncData[ secondfit[[3]], second,
	      "Second Y(2s) scan",
	      {ImageSize->72*6, PlotRange->{9.002,10.058}} ];

firstderiv = Chop[ D[ EvalFunc[ firstfit[[3]], x ], x ] ];
secondderiv = Chop[ D[ EvalFunc[ secondfit[[3]], x ], x ] ];

$DisplayFunction = Display[ "derivatives.gif", #, "GIF" ]&;

Plot[ {firstderiv, secondderiv}, {x, 9.992, 10.058}
      , PlotLabel -> "Derivatives of scan fits --- red = first, blue = second"
      , PlotStyle -> { RGBColor[1,0,0], RGBColor[0,0,1] }
      , ImageSize -> 72*6
    ];

x / 2 /. FindRoot[ firstderiv == 0, {x, 2*5.0126} ]

Out[18]= 5.01254

x / 2 /. FindRoot[ secondderiv == 0, {x, 2*5.0126} ]

Out[19]= 5.0125


EvalFunc[ firstfit[[3]], 2*5.01254 ]

Out[13]= 9.51024 nb

EvalUncertFunc[ firstfit[[3]], 2*5.01254 ] / EvalFunc[ firstfit[[3]], 2*5.01254 ]

Out[17]= 0.00137972




EvalFunc[ firstfit[[3]], 2*5.0125 ]

Out[14]= 9.50929 nb

EvalUncertFunc[ firstfit[[3]], 2*5.0125 ] / EvalFunc[ firstfit[[3]], 2*5.0125 ]

Out[18]= 0.00140695


Exit
[Mathematica finished.]

