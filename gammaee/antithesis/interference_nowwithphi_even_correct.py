import biggles, Numeric
from math import *

data = [ \
  [0.2, 0.0, 241.119079233, 323.928883599], \
  [0.2, 22.5, 240.991270345, 323.531728051], \
  [0.2, 45.0, 240.698137136, 323.247137423], \
  [0.2, 67.5, 240.380523113, 323.105197133], \
  [0.2, 90.0, 240.179641964, 323.140663426], \
  [0.2, 112.5, 240.161228307, 323.343744437], \
  [0.2, 135.0, 240.285679841, 323.682593468], \
  [0.2, 157.5, 240.43826646, 324.108176268], \
  [0.2, 180.0, 240.502474496, 324.526125379], \
  [0.2, 202.5, 240.427171963, 324.951137091], \
  [0.2, 225.0, 240.271735336, 325.248721192], \
  [0.2, 247.5, None, None], \
  [0.2, 270.0, 240.192047497, 325.352903607], \
  [0.2, 292.5, 240.411579049, 325.145164966], \
  [0.2, 315.0, 240.735821038, 324.803252567], \
  [0.2, 337.5, 241.01716983, 324.375901851], \
  [0.4, 0.0, 243.293899874, 323.612463446], \
  [0.4, 22.5, None, None], \
  [0.4, 45.0, 241.798153798, 322.246700272], \
  [0.4, 67.5, 240.736879527, 321.975760964], \
  [0.4, 90.0, None, None], \
  [0.4, 112.5, 240.335524662, 322.448438273], \
  [0.4, 135.0, 241.030789946, 323.121860245], \
  [0.4, 157.5, 241.77344332, 323.964911149], \
  [0.4, 180.0, 242.073225951, 324.865828439], \
  [0.4, 202.5, 241.731478851, 325.668542485], \
  [0.4, 225.0, None, None], \
  [0.4, 247.5, 240.294070678, 326.546685276], \
  [0.4, 270.0, 240.199076288, 326.469922367], \
  [0.4, 292.5, 240.842317645, 326.058232678], \
  [0.4, 315.0, 241.943635484, 325.370649726], \
  [0.4, 337.5, 242.935694037, 324.50417132], \
  [0.6, 0.0, 246.701927014, 323.293951848], \
  [0.6, 22.5, 245.689912972, 322.108928111], \
  [0.6, 45.0, 243.475267891, 321.2568141], \
  [0.6, 67.5, 241.251545677, 320.850437571], \
  [0.6, 90.0, 240.169297366, 320.960240108], \
  [0.6, 112.5, 240.704936996, 321.560610341], \
  [0.6, 135.0, 242.41340196, 322.563839069], \
  [0.6, 157.5, 244.189256431, 323.818320703], \
  [0.6, 180.0, None, None], \
  [0.6, 202.5, None, None], \
  [0.6, 225.0, 242.286423602, 327.275389957], \
  [0.6, 247.5, 240.604851439, 327.701816068], \
  [0.6, 270.0, 240.206666128, 327.591845604], \
  [0.6, 292.5, 241.48204857, 326.970207096], \
  [0.6, 315.0, 243.815072762, 325.922094819], \
  [0.6, 337.5, 245.94335729, 324.634368659], \
  [0.8, 0.0, 251.335353364, 322.973965907], \
  [0.8, 22.5, 249.554392381, 321.400867222], \
  [0.8, 45.0, 245.717217489, 320.269421918], \
  [0.8, 67.5, None, None], \
  [0.8, 90.0, 240.164909989, 319.879323611], \
  [0.8, 112.5, 241.267086931, 320.67029295], \
  [0.8, 135.0, 244.427729306, 322.005185904], \
  [0.8, 157.5, 247.68192382, 323.684879599], \
  [0.8, 180.0, None, None], \
  [0.8, 202.5, 247.584415076, 327.096394612], \
  [0.8, 225.0, 244.238425874, 328.292568218], \
  [0.8, 247.5, 241.091623689, 328.869824237], \
  [0.8, 270.0, 240.214766797, 328.724100382], \
  [0.8, 292.5, 242.333756306, 327.890203558], \
  [0.8, 315.0, 246.357463422, 326.48536706], \
  [0.8, 337.5, 250.041828305, 324.760610433], \
  [1.0, 0.0, 257.18534209, 322.649403039], \
  [1.0, 22.5, 254.410339837, 320.692273031], \
  [1.0, 45.0, 248.514601463, 319.287883305], \
  [1.0, 67.5, 242.741605344, 318.630551357], \
  [1.0, 90.0, 240.16099343, 318.807976577], \
  [1.0, 112.5, 242.017361472, 319.78990087], \
  [1.0, 135.0, 247.066724148, 321.444676726], \
  [1.0, 157.5, 252.249358147, 323.542562141], \
  [1.0, 180.0, 254.407209463, 325.770479367], \
  [1.0, 202.5, 252.161590862, 327.823005459], \
  [1.0, 225.0, None, None], \
  [1.0, 247.5, None, None], \
  [1.0, 270.0, 240.223506744, 329.866451341], \
  [1.0, 292.5, 243.401185686, 328.811243471], \
  [1.0, 315.0, 249.57671973, 327.051247867], \
  [1.0, 337.5, 255.232196012, 324.880837627], \
  [1.2, 0.0, 264.2442599, 322.326288894], \
  [1.2, 22.5, 260.243716229, 319.983096321], \
  [1.2, 45.0, 251.856254351, 318.31081411], \
  [1.2, 67.5, 243.710642319, 317.530459537], \
  [1.2, 90.0, 240.157600019, 317.741175871], \
  [1.2, 112.5, 242.954143587, 318.912135478], \
  [1.2, 135.0, 250.32407727, 320.88889582], \
  [1.2, 157.5, 257.930489189, 323.264514818], \
  [1.2, 180.0, 261.077650602, 326.074493998], \
  [1.2, 202.5, None, None], \
  [1.2, 225.0, 250.090986446, 330.350764599], \
  [1.2, 247.5, 242.607999118, 331.235971568], \
  [1.2, 270.0, 240.232682525, 331.017609095], \
  [1.2, 292.5, 244.687429113, 329.735724291], \
  [1.2, 315.0, 253.479882526, 327.614662994], \
  [1.2, 337.5, 261.517868409, 325.004727591], \
  [1.4, 0.0, 272.504350384, 321.997470306], \
  [1.4, 22.5, 267.042035305, 319.275149255], \
  [1.4, 45.0, 255.731633504, 317.338056292], \
  [1.4, 67.5, 244.824800613, 316.437312768], \
  [1.4, 90.0, 240.154699864, 316.683186127], \
  [1.4, 112.5, 244.072894759, 318.037780316], \
  [1.4, 135.0, 254.192778547, 320.337518708], \
  [1.4, 157.5, 264.585892214, 323.254318744], \
  [1.4, 180.0, 269.028063277, 326.372970615], \
  [1.4, 202.5, 264.677989379, 329.256766279], \
  [1.4, 225.0, 254.015623086, 331.382771691], \
  [1.4, 247.5, 243.645438179, 332.421203728], \
  [1.4, 270.0, 240.242453925, 332.173584361], \
  [1.4, 292.5, 246.196165515, 330.663885879], \
  [1.4, 315.0, 258.073510393, 328.17691037], \
  [1.4, 337.5, 268.898870277, 325.121319306], \
  [1.6, 0.0, 281.956600825, 321.67058177], \
  [1.6, 22.5, 274.789914263, 318.572206235], \
  [1.6, 45.0, 260.130911852, 316.369729623], \
  [1.6, 67.5, 246.081002291, 315.354042667], \
  [1.6, 90.0, 240.152280193, 315.63235633], \
  [1.6, 112.5, 245.371673826, 317.171603613], \
  [1.6, 135.0, 258.665527583, 319.778620136], \
  [1.6, 157.5, 272.334611071, 323.093192223], \
  [1.6, 180.0, 278.264097897, 326.650832941], \
  [1.6, 202.5, 272.635217415, 329.96418158], \
  [1.6, 225.0, 258.622831309, 332.43510103], \
  [1.6, 247.5, 244.874115849, 333.625376316], \
  [1.6, 270.0, 240.25327419, 333.337448039], \
  [1.6, 292.5, None, None], \
  [1.6, 315.0, 263.364057565, 328.739588201], \
  [1.6, 337.5, 277.378246715, 325.244065386], \
  [1.8, 0.0, 292.592989316, 321.337155892], \
  [1.8, 22.5, 283.475484436, 317.866495473], \
  [1.8, 45.0, 265.044815194, 315.409552575], \
  [1.8, 67.5, 247.476256619, 314.273215821], \
  [1.8, 90.0, 240.150323441, 314.587500059], \
  [1.8, 112.5, None, None], \
  [1.8, 135.0, None, None], \
  [1.8, 157.5, None, None], \
  [1.8, 180.0, 288.814061362, 326.956628645], \
  [1.8, 202.5, 281.748001393, 330.670295769], \
  [1.8, 225.0, 263.915954778, 333.468980138], \
  [1.8, 247.5, None, None], \
  [1.8, 270.0, 240.264485136, 334.509987003], \
  [1.8, 292.5, 249.896515159, 332.55202177], \
  [1.8, 315.0, 269.358479993, 329.301543482], \
  [1.8, 337.5, 286.95634118, 325.34984949], \
  [2.0, 0.0, 304.406696447, 321.006125008], \
  [2.0, 22.5, 293.084243249, 317.159530224], \
  [2.0, 45.0, 270.462008912, 314.450555202], \
  [2.0, 67.5, 249.007749225, 313.200513132], \
  [2.0, 90.0, 240.14878264, 313.551009823], \
  [2.0, 112.5, 248.496461747, 315.446939733], \
  [2.0, 135.0, 269.383225223, 318.672759832], \
  [2.0, 157.5, 291.021866615, 322.79548836], \
  [2.0, 180.0, 300.701887388, 327.252384254], \
  [2.0, 202.5, 292.057370688, 331.386693135], \
  [2.0, 225.0, None, None], \
  [2.0, 247.5, 247.922933646, 336.051895157], \
  [2.0, 270.0, 240.276344567, 335.690782642], \
  [2.0, 292.5, 252.09576947, 333.49329134], \
  [2.0, 315.0, 276.064074058, 329.866618815], \
  [2.0, 337.5, 297.636665854, 325.461302294], \
  [2.2, 0.0, 317.387155211, 320.665164886], \
  [2.2, 22.5, 303.604687861, 316.456310056], \
  [2.2, 45.0, 276.373635321, 313.494375005], \
  [2.2, 67.5, 250.671681565, 312.135825314], \
  [2.2, 90.0, None, None], \
  [2.2, 112.5, None, None], \
  [2.2, 135.0, None, None], \
  [2.2, 157.5, 301.976087428, 322.624674788], \
  [2.2, 180.0, 313.924752981, 327.547480813], \
  [2.2, 202.5, None, None], \
  [2.2, 225.0, 276.612814908, 335.620640022], \
  [2.2, 247.5, None, None], \
  [2.2, 270.0, 240.288872886, 336.881856143], \
  [2.2, 292.5, 254.532402788, 334.445863014], \
  [2.2, 315.0, 283.48709944, 330.427403515], \
  [2.2, 337.5, None, None], \
  [2.4, 0.0, 331.529044164, 320.329246211], \
  [2.4, 22.5, 315.022952267, 315.750905582], \
  [2.4, 45.0, 282.77032742, 312.549976933], \
  [2.4, 67.5, 252.466709569, 311.077645269], \
  [2.4, 90.0, 240.147018693, 311.493427371], \
  [2.4, 112.5, 252.305603835, 313.73936202], \
  [2.4, 135.0, 282.426007539, 317.562324782], \
  [2.4, 157.5, 313.993895762, 322.46083552]]

def makeplot(yint=None, phi=None, show=None):
  if yint == None:
    filt = filter(lambda (y,p,c,a): p == phi and c != None, data)
    if show == "chi":
      return zip(*map(lambda (y,p,c,a): (y,c), filt))
    elif show == "area":
      return zip(*map(lambda (y,p,c,a): (y,a), filt))
  elif phi == None:
    filt = filter(lambda (y,p,c,a): y == yint and c != None, data)
    if show == "chi":
      return zip(*map(lambda (y,p,c,a): (p,c), filt))
    elif show == "area":
      return zip(*map(lambda (y,p,c,a): (p,a), filt))

def dothatplot(whatphi):
  p = biggles.FramedArray(2,1)
  x, y = makeplot(phi=whatphi, show="chi")
  x = list(x)
  y = list(y)
  x.append(0.)
  y.append(240.4)
  p[0,0].add(biggles.Points(x, y, symboltype="filled circle"))
  p[0,0].add(biggles.LineY(240.4))
  p[0,0].add(biggles.LineY(240.4+1.))
  x, y = makeplot(phi=whatphi, show="area")
  x = list(x)
  y = list(y)
  x.append(0.)
  y.append(324.13)
  p[1,0].add(biggles.Points(x, y, symboltype="filled circle"))
#  p[1,0].add(biggles.LineY(324.13))
#  p[1,0].add(biggles.LineY(324.13*0.99))
  p.xrange = 0., 3.
  p.ylabel = r"Area (MeV nb)               $\chi^2$"
  p.xlabel = r"$y_{ggg} / y_{qq} = sqrt(f B_{ggg} / B_{qq}$)"
  p[0,0].yrange = 230., 330.
  p[1,0].yrange = 310., 339.999
  p.title = r"Fit results with $\phi_g$ = "+str(whatphi)+r"$\degree$"
  p.write_eps("interference_nowwithphi_"+str(whatphi)+".eps")
  p.show()

dothatplot(0.0)
dothatplot(22.5)
dothatplot(45.0)
dothatplot(67.5)
dothatplot(90.0)
dothatplot(112.5)
dothatplot(135.0)
dothatplot(157.5)
dothatplot(180.0)
dothatplot(202.5)
dothatplot(225.0)
dothatplot(247.5)
dothatplot(270.0)
dothatplot(292.5)
dothatplot(315.0)
dothatplot(337.5)











