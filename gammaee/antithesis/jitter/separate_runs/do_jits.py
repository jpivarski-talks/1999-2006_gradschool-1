import biggles

jit1s = [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.08, 0.10, 0.12, 0.14, 0.16, 0.18, 0.20, 0.30, 0.40, 0.50, 1.00, ]
area1s = [13.704176722382, 13.7076878062539, 13.7079336362488, 13.7139828505366, 13.7150006412671, 13.7175989732161, 13.734747972964, 13.7384113522286, 13.7607912549843, 13.7870461093518, 13.8585832399202, 13.8445044821281, 13.9150781915381, 14.173085877517, 14.7048968397143, 15.4222891367708, 19.4779342696967, ]
area1s_err = [0.000574890973053824, 0.0013064770903085, 0.00189423520985813, 0.00234509104397976, 0.0035677999590025, 0.00391237985328172, 0.00499473899010318, 0.00807020934226908, 0.0102828128378692, 0.011490207427274, 0.0133769060167417, 0.0159181312915944, 0.0166851417763084, 0.0330879757579312, 0.046605708140599, 0.0735256300337587, 0.180593256347746, ]
chi21s = [509.987998860202, 512.695962163438, 513.06219800164, 514.579662588548, 522.297736830647, 522.656240029568, 541.449542934124, 569.350832824341, 607.027658929303, 657.532472606588, 726.223615532351, 802.174105441539, 902.401561050371, 1608.92957011581, 2971.2542084823, 4997.49711972271, 19576.6237535351, ]
chi21s_err = [0.434620221526658, 0.745672863531967, 1.09666554164008, 1.58184856306588, 1.8925938847017, 2.33618872373058, 3.2683317841407, 5.06576960104131, 8.25441048518781, 12.0785477000407, 13.5806388224564, 19.1186653170867, 24.7225488888323, 63.9867376603958, 147.038616239773, 219.579262086548, 688.990000862804, ]
jit2s = [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.08, 0.10, 0.12, 0.14, 0.16, 0.18, 0.30, 0.50, ]
area2s = [5.58644520739236, 5.586131193453, 5.58651206862411, 5.5885137275455, 5.58665346518346, 5.58723271949526, 5.59662425829897, 5.60106726481922, 5.6037649864683, 5.61030607239625, 5.62956334577618, 5.62836950451264, 5.71026462550126, 5.96918694683636, ]
area2s_err = [0.000389044865945045, 0.000776534584596912, 0.00122591565530329, 0.00149489777341945, 0.00223031061122431, 0.00244304235046321, 0.00334601204241575, 0.00340605846158103, 0.00498301177638756, 0.00668916741571166, 0.00730600799626178, 0.00702695336086539, 0.0121616060762111, 0.0270178534447567, ]
chi22s = [78.1224833085909, 78.04348187025, 78.2654995964911, 78.5389673941133, 78.6667606717981, 78.7979248425543, 80.4968239475293, 82.1122926471891, 83.3590530120508, 86.4106629360708, 88.6772312843324, 89.9745266399528, 127.961184154285, 242.99061927717, ]
chi22s_err = [0.0453936431812024, 0.0772925069019921, 0.107579874970517, 0.174556034680944, 0.218493322710589, 0.234374338656285, 0.381471107777302, 0.505573519626345, 0.791985139197155, 1.36735733796088, 1.45282032436277, 1.29387622551007, 4.29478095998199, 13.6281042194124, ]
jit3s = [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.08, 0.10, 0.12, 0.16, 0.18, 0.30, 0.50, ]
area3s = [3.582227624365, 3.58183937637111, 3.58374647589867, 3.58734209884433, 3.58440064261881, 3.59609628220923, 3.59489328666949, 3.60892494936692, 3.61403610693226, 3.63657334037871, 3.66696667101542, 3.78058739067348, 4.31349837715971, ]
area3s_err = [0.00018839477053724, 0.000637064638564542, 0.000870550215966283, 0.00174694559642423, 0.00163989164823001, 0.00237400939944428, 0.00248913528582047, 0.00700415424112794, 0.0046054928089751, 0.0072202537349899, 0.0153725170763844, 0.0185825459561764, 0.0486039614566255, ]
chi23s = [412.185881788786, 412.359857645139, 412.817763054244, 412.956977687333, 414.373493665381, 415.280413184615, 418.820160702333, 427.601581555077, 427.808809349903, 442.681342322516, 475.951534550542, 557.036461568087, 1102.11401128589, ]
chi23s_err = [0.141364426590384, 0.262594035717164, 0.367958704288996, 0.710840643142633, 0.690199664629423, 1.21218927998725, 1.21731192153008, 5.11646554504093, 2.40220723315513, 5.23830942533408, 14.1491181418469, 12.767438367915, 57.6641809947519, ]

p = biggles.FramedPlot()
p.add(biggles.Points(area1s, chi21s, symboltype="filled circle", symbolsize=1))
p.add(biggles.SymmetricErrorBarsY(area1s, chi21s, chi21s_err, symboltype="filled circle", symbolsize=1))
p.add(biggles.SymmetricErrorBarsX(area1s, chi21s, area1s_err, symboltype="filled circle", symbolsize=1))
for a, c, j in zip(area1s, chi21s, jit1s):
  a += 0.0005
  c += 0.002
  if j == 0.01:
    p.add(biggles.DataLabel(a, c, "0.01 MeV RMS jitter", texthalign = "left", textvalign = "top"))
  else:
    p.add(biggles.DataLabel(a, c, str(j), texthalign = "left", textvalign = "top"))
p.x2.range = -0.01*7, 0.03*7
p.y2.range = -5*7, 20*7
p.xrange = Numeric.array(p.x2.range) + 13.70411
p.yrange = Numeric.array(p.y2.range) + 509.74716
p.x1.label = "Best-fit area with jitter (MeV nbish)"
p.x2.label = "Difference from no-jitter best fit (MeV nbish)"
p.y1.label = r"$\chi^2$ with jitter"
p.y2.label = r"$\chi^2$ above no-jitter best fit"
p.aspect_ratio = 1.2
p.show()
p.write_eps("/home/mccann/tmp.ps")

p = biggles.FramedPlot()
p.add(biggles.Points(area2s, chi22s, symboltype="filled circle", symbolsize=1))
p.add(biggles.SymmetricErrorBarsY(area2s, chi22s, chi22s_err, symboltype="filled circle", symbolsize=1))
p.add(biggles.SymmetricErrorBarsX(area2s, chi22s, area2s_err, symboltype="filled circle", symbolsize=1))
for a, c, j in zip(area2s, chi22s, jit2s):
  p.add(biggles.DataLabel(a, c, str(j), texthalign = "left", textvalign = "top"))
p.x2.range = -0.02, 0.07
p.y2.range = -5, 20
p.xrange = Numeric.array(p.x2.range) + 5.58588
p.yrange = Numeric.array(p.y2.range) + 78.0905
p.show()

p = biggles.FramedPlot()
p.add(biggles.Points(area3s, chi23s, symboltype="filled circle", symbolsize=1))
p.add(biggles.SymmetricErrorBarsY(area3s, chi23s, chi23s_err, symboltype="filled circle", symbolsize=1))
p.add(biggles.SymmetricErrorBarsX(area3s, chi23s, area3s_err, symboltype="filled circle", symbolsize=1))
for a, c, j in zip(area3s, chi23s, jit3s):
  p.add(biggles.DataLabel(a, c, str(j), texthalign = "left", textvalign = "top"))
p.x2.range = -0.02, 0.07
p.y2.range = -5, 30
p.xrange = Numeric.array(p.x2.range) + 3.5817
p.yrange = Numeric.array(p.y2.range) + 412.015
p.show()


