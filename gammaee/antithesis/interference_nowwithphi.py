import biggles, Numeric
from math import *

data = [ \
  [0.2, 0.0, 241.119079233, 323.928883599], \
  [0.2, 22.5, 240.369472713, 324.515099388], \
  [0.2, 45.0, 240.585914932, 324.037662549], \
  [0.2, 67.5, None, None], \
  [0.2, 90.0, None, None], \
  [0.2, 112.5, 240.905226879, 323.988217958], \
  [0.2, 135.0, 240.496470977, 324.547223667], \
  [0.2, 157.5, 241.008479022, 323.944579987], \
  [0.2, 180.0, 240.195373737, 324.441251899], \
  [0.2, 202.5, 240.287917191, 324.153350753], \
  [0.2, 225.0, 240.449442045, 324.117846914], \
  [0.2, 247.5, 240.290125653, 324.457395178], \
  [0.2, 270.0, 241.099007368, 323.93742671], \
  [0.2, 292.5, 240.440079622, 324.525705231], \
  [0.2, 315.0, 240.726644834, 324.00422725], \
  [0.2, 337.5, 240.157096083, 324.299499281], \
  [0.4, 0.0, 243.293899874, 323.612463446], \
  [0.4, 22.5, 241.299733995, 324.743627242], \
  [0.4, 45.0, 241.611924664, 323.804694423], \
  [0.4, 67.5, 240.336895772, 324.189270365], \
  [0.4, 90.0, 240.19434146, 324.376836649], \
  [0.4, 112.5, 242.63066837, 323.716144593], \
  [0.4, 135.0, 242.044751501, 324.861163289], \
  [0.4, 157.5, 242.951960413, 323.63338842], \
  [0.4, 180.0, None, None], \
  [0.4, 202.5, 240.622797945, 324.011285574], \
  [0.4, 225.0, 241.165498245, 323.956060034], \
  [0.4, 247.5, 240.871419055, 324.631655454], \
  [0.4, 270.0, 243.23222443, 323.625211855], \
  [0.4, 292.5, 241.703369838, 324.822194954], \
  [0.4, 315.0, 242.064878133, 323.740470444], \
  [0.4, 337.5, 240.174557705, 324.298149449], \
  [0.6, 0.0, 246.701927014, 323.293951848], \
  [0.6, 22.5, 242.556386996, 324.955085685], \
  [0.6, 45.0, 243.443022832, 323.5463453], \
  [0.6, 67.5, 240.728604831, 324.079587443], \
  [0.6, 90.0, 240.176867422, 324.333488978], \
  [0.6, 112.5, 245.439066421, 323.432933507], \
  [0.6, 135.0, 244.809970759, 325.155877437], \
  [0.6, 157.5, None, None], \
  [0.6, 180.0, None, None], \
  [0.6, 202.5, 241.384419559, 323.818503439], \
  [0.6, 225.0, 242.537659772, 323.760398755], \
  [0.6, 247.5, 241.500097248, 324.733664663], \
  [0.6, 270.0, 246.585623796, 323.313913649], \
  [0.6, 292.5, None, None], \
  [0.6, 315.0, 244.339623509, 323.458030453], \
  [0.6, 337.5, 240.294108512, 324.229332731], \
  [0.8, 0.0, 251.335353364, 322.973965907], \
  [0.8, 22.5, 243.4379986, 325.070522195], \
  [0.8, 45.0, 246.20028827, 323.25522449], \
  [0.8, 67.5, 241.574620011, 323.936242378], \
  [0.8, 90.0, 240.148460033, 324.227060815], \
  [0.8, 112.5, 249.372324454, 323.142359014], \
  [0.8, 135.0, 248.665272041, 325.440404441], \
  [0.8, 157.5, 250.327850691, 323.003560262], \
  [0.8, 180.0, None, None], \
  [0.8, 202.5, 242.764222897, 323.589337381], \
  [0.8, 225.0, 244.724037965, 323.540626542], \
  [0.8, 247.5, 241.720605974, 324.759177814], \
  [0.8, 270.0, 251.155828844, 322.995769717], \
  [0.8, 292.5, 245.689845066, 325.264324567], \
  [0.8, 315.0, 247.637023909, 323.16343106], \
  [0.8, 337.5, 240.682283857, 324.115817101], \
  [1.0, 0.0, 257.18534209, 322.649403039], \
  [1.0, 22.5, 243.285665604, 325.068593103], \
  [1.0, 45.0, 249.964968104, 322.975857295], \
  [1.0, 67.5, 243.060367729, 323.746467733], \
  [1.0, 90.0, 240.302350691, 324.060583549], \
  [1.0, 112.5, 254.455533747, 322.847608366], \
  [1.0, 135.0, None, None], \
  [1.0, 157.5, 255.785263957, 322.678741967], \
  [1.0, 180.0, 240.192639185, 324.506220333], \
  [1.0, 202.5, 244.916512323, 323.337292311], \
  [1.0, 225.0, 247.835136383, 323.305358696], \
  [1.0, 247.5, 241.361436318, 324.67354354], \
  [1.0, 270.0, 256.937167122, 322.679182391], \
  [1.0, 292.5, 246.19712613, 325.321244252], \
  [1.0, 315.0, 252.0101721, 322.858830066], \
  [1.0, 337.5, None, None], \
  [1.2, 0.0, 264.2442599, 322.326288894], \
  [1.2, 22.5, 242.224746028, 324.977774419], \
  [1.2, 45.0, 254.78879407, 322.676902947], \
  [1.2, 67.5, None, None], \
  [1.2, 90.0, 240.88174371, 323.849057486], \
  [1.2, 112.5, 260.700616511, 322.54613321], \
  [1.2, 135.0, 248.506270008, 325.383176588], \
  [1.2, 157.5, 262.426838463, 322.355960642], \
  [1.2, 180.0, 240.188816589, 324.36543192], \
  [1.2, 202.5, 247.957697592, 323.069695726], \
  [1.2, 225.0, 251.949220516, 323.050608612], \
  [1.2, 247.5, 240.698098493, 324.50837646], \
  [1.2, 270.0, 263.924085499, 322.359413913], \
  [1.2, 292.5, 244.680830596, 325.226289973], \
  [1.2, 315.0, 257.49197151, 322.544383988], \
  [1.2, 337.5, 243.070171593, 323.773247653], \
  [1.4, 0.0, 272.504350384, 321.997470306], \
  [1.4, 22.5, 240.997326646, 324.814060826], \
  [1.4, 45.0, 260.705387723, 322.355880047], \
  [1.4, 67.5, 248.516444677, 323.31825393], \
  [1.4, 90.0, 242.104726383, 323.601221202], \
  [1.4, 112.5, 268.114296806, 322.244858144], \
  [1.4, 135.0, 244.691550567, 325.032773912], \
  [1.4, 157.5, 270.25061807, 322.028296922], \
  [1.4, 180.0, 240.670883796, 324.193472249], \
  [1.4, 202.5, 251.96863959, 322.781263099], \
  [1.4, 225.0, 257.117150437, 322.79004518], \
  [1.4, 247.5, None, None], \
  [1.4, 270.0, 272.109438507, 322.03722283], \
  [1.4, 292.5, 242.550240035, 325.042923826], \
  [1.4, 315.0, 264.101792086, 322.226813315], \
  [1.4, 337.5, 245.407892633, 323.565827007], \
  [1.6, 0.0, 281.956600825, 321.67058177], \
  [1.6, 22.5, 240.236078473, 324.611119461], \
  [1.6, 45.0, 267.736270339, 322.038828241], \
  [1.6, 67.5, 252.677517308, 323.081453026], \
  [1.6, 90.0, 244.135705312, 323.328382085], \
  [1.6, 112.5, None, None], \
  [1.6, 135.0, 241.973845421, 324.677964695], \
  [1.6, 157.5, 279.253089754, 321.698669158], \
  [1.6, 180.0, 241.870727703, 323.989714901], \
  [1.6, 202.5, 257.005751416, 322.481314532], \
  [1.6, 225.0, 263.373746115, 322.520191413], \
  [1.6, 247.5, 240.271707144, 323.999288866], \
  [1.6, 270.0, 281.485581688, 321.712187421], \
  [1.6, 292.5, 240.900690915, 324.832471849], \
  [1.6, 315.0, 271.851392123, 321.899968256], \
  [1.6, 337.5, 248.665058057, 323.3421979], \
  [1.8, 0.0, 292.592989316, 321.337155892], \
  [1.8, 22.5, 240.292967452, 324.387117795], \
  [1.8, 45.0, 275.893380059, 321.717405417], \
  [1.8, 67.5, 257.875718329, 322.829701563], \
  [1.8, 90.0, 247.09008282, 323.036298173], \
  [1.8, 112.5, 286.448750387, 321.616717303], \
  [1.8, 135.0, 240.468760362, 324.316220449], \
  [1.8, 157.5, 289.429716009, 321.35359591], \
  [1.8, 180.0, 243.948602523, 323.770038572], \
  [1.8, 202.5, 263.107643121, 322.172344601], \
  [1.8, 225.0, 270.741711831, 322.24476699], \
  [1.8, 247.5, 241.152017654, 323.698475077], \
  [1.8, 270.0, 292.04581654, 321.384380895], \
  [1.8, 292.5, 240.166922133, 324.595117174], \
  [1.8, 315.0, 280.745885689, 321.573503288], \
  [1.8, 337.5, 252.918360877, 323.101456474], \
  [2.0, 0.0, 304.406696447, 321.006125008], \
  [2.0, 22.5, 241.346404362, 324.148091], \
  [2.0, 45.0, 285.183298955, 321.387265658], \
  [2.0, 67.5, 264.148222458, 322.572819628], \
  [2.0, 90.0, 251.043749603, 322.729424641], \
  [2.0, 112.5, 297.367088808, 321.312926174], \
  [2.0, 135.0, 240.194414155, 323.94433473], \
  [2.0, 157.5, 300.774522468, 321.022381447], \
  [2.0, 180.0, 247.009652545, 323.533919918], \
  [2.0, 202.5, 270.298168396, 321.853962361], \
  [2.0, 225.0, 279.234143818, 321.963217976], \
  [2.0, 247.5, 242.992872701, 323.38492982], \
  [2.0, 270.0, 303.781601284, 321.055975115], \
  [2.0, 292.5, 240.514418372, 324.347578859], \
  [2.0, 315.0, 290.786747478, 321.241624705], \
  [2.0, 337.5, 258.21927518, 322.848175591], \
  [2.2, 0.0, 317.387155211, 320.665164886], \
  [2.2, 22.5, None, None], \
  [2.2, 45.0, 295.609416456, 321.05306214], \
  [2.2, 67.5, None, None], \
  [2.2, 90.0, 256.047561513, 322.413356447], \
  [2.2, 112.5, None, None], \
  [2.2, 135.0, 241.150812244, 323.573522814], \
  [2.2, 157.5, 313.280753273, 320.682965163], \
  [2.2, 180.0, 251.119976993, 323.287554783], \
  [2.2, 202.5, 278.594467415, 321.528217967], \
  [2.2, 225.0, 288.861691766, 321.672425415], \
  [2.2, 247.5, 245.880043153, 323.053768754], \
  [2.2, 270.0, 316.685393218, 320.723046447], \
  [2.2, 292.5, 242.012114944, 324.095035309], \
  [2.2, 315.0, 301.973307684, 320.899882354], \
  [2.2, 337.5, 264.603728662, 322.593451475], \
  [2.4, 0.0, 331.529044164, 320.329246211], \
  [2.4, 22.5, 246.766326985, 323.650925708], \
  [2.4, 45.0, 307.172381234, 320.712176043], \
  [2.4, 67.5, 280.010762403, 322.033500269], \
  [2.4, 90.0, 262.135233366, 322.082624803], \
  [2.4, 112.5, 322.683419474, 320.663494409], \
  [2.4, 135.0, 243.333154855, 323.203467923], \
  [2.4, 157.5, 326.941762839, 320.345139833], \
  [2.4, 180.0, None, None], \
  [2.4, 202.5, 288.006115484, 321.199433326], \
  [2.4, 225.0, 299.6270136, 321.378387801], \
  [2.4, 247.5, 249.862061256, 322.71783146], \
  [2.4, 270.0, 330.750364493, 320.388367579], \
  [2.4, 292.5, 244.692581092, 323.841128532], \
  [2.4, 315.0, 314.303921462, 320.563761941], \
  [2.4, 337.5, None, None], \
  [2.6, 0.0, 346.820729156, 319.989574419], \
  [2.6, 22.5, 251.206392505, 323.389713899], \
  [2.6, 45.0, None, None], \
  [2.6, 67.5, 289.627487815, 321.750641284], \
  [2.6, 90.0, 269.326604221, 321.748972525], \
  [2.6, 112.5, 337.070696142, 320.349917914], \
  [2.6, 135.0, 246.734170774, 322.826906981], \
  [2.6, 157.5, None, None], \
  [2.6, 180.0, 262.646390156, 322.778225622], \
  [2.6, 202.5, None, None], \
  [2.6, 225.0, 311.533380105, 321.081681003], \
  [2.6, 247.5, 254.967196536, 322.369454679], \
  [2.6, 270.0, 345.96673431, 320.05237316], \
  [2.6, 292.5, 248.56813066, 323.585266708], \
  [2.6, 315.0, 327.773292508, 320.221018537], \
  [2.6, 337.5, 280.707472053, 322.05968065], \
  [2.8, 0.0, 363.257001842, 319.648129319], \
  [2.8, 22.5, 256.821296632, 323.125553055], \
  [2.8, 45.0, 333.698353425, 320.028425631], \
  [2.8, 67.5, 300.378070442, 321.471841022], \
  [2.8, 90.0, 277.63561149, 321.411139488], \
  [2.8, 112.5, 352.602058526, 320.025980177], \
  [2.8, 135.0, 251.345937992, 322.449467823], \
  [2.8, 157.5, 357.698083161, 319.650901378], \
  [2.8, 180.0, 270.105888337, 322.509842407], \
  [2.8, 202.5, 310.193552674, 320.518657727], \
  [2.8, 225.0, 324.5794553, 320.771061199], \
  [2.8, 247.5, 261.210158064, 322.01857445], \
  [2.8, 270.0, 362.32732771, 319.712395788], \
  [2.8, 292.5, 253.645283419, 323.31817358], \
  [2.8, 315.0, 342.376244257, 319.872422905], \
  [2.8, 337.5, 290.451699142, 321.770134386], \
  [3.0, 0.0, 380.828141892, 319.300451059], \
  [3.0, 22.5, 263.618304521, 322.861451724], \
  [3.0, 45.0, 348.654323969, 319.678999275], \
  [3.0, 67.5, None, None], \
  [3.0, 90.0, 287.066710638, 321.063328706], \
  [3.0, 112.5, 369.272853149, 319.697825784], \
  [3.0, 135.0, 257.159076397, 322.069063902], \
  [3.0, 157.5, 374.778146953, 319.301478264], \
  [3.0, 180.0, None, None], \
  [3.0, 202.5, 322.972176588, 320.170732486], \
  [3.0, 225.0, 338.763500577, 320.475813805], \
  [3.0, 247.5, 268.59873236, 321.658163984], \
  [3.0, 270.0, 379.82504544, 319.372750672], \
  [3.0, 292.5, 259.924025196, 323.042888807], \
  [3.0, 315.0, 358.108508262, 319.522415763], \
  [3.0, 337.5, 301.333125842, 321.499903501]]

def makeplot(yint=None, phi=None, show=None):
  if yint == None:
    filt = filter(lambda (y,p,c,a): p == phi and c != None, data)
    if show == "chi":
      return zip(*map(lambda (y,p,c,a): (y,c), filt))
    elif show == "area":
      return zip(*map(lambda (y,p,c,a): (y,a), filt))
  elif phi == None:
    filt = filter(lambda (y,p,c,a): y == yint and c != None, data)
    if show == "chi":
      return zip(*map(lambda (y,p,c,a): (p,c), filt))
    elif show == "area":
      return zip(*map(lambda (y,p,c,a): (p,a), filt))

def dothatplot(whatphi):
  p = biggles.FramedArray(2,1)
  x, y = makeplot(phi=whatphi, show="chi")
  x = list(x)
  y = list(y)
  x.append(0.)
  y.append(240.4)
  p[0,0].add(biggles.Points(x, y, symboltype="filled circle"))
  p[0,0].add(biggles.LineY(240.4))
  p[0,0].add(biggles.LineY(240.4+1.))
  x, y = makeplot(phi=whatphi, show="area")
  x = list(x)
  y = list(y)
  x.append(0.)
  y.append(324.13)
  p[1,0].add(biggles.Points(x, y, symboltype="filled circle"))
#  p[1,0].add(biggles.LineY(324.13))
#  p[1,0].add(biggles.LineY(324.13*0.99))
  p.xrange = 0., 3.
  p.ylabel = r"Area (MeV nb)               $\chi^2$"
  p.xlabel = r"$y_{ggg} / y_{qq} = sqrt(f B_{ggg} / B_{qq}$)"
  p.title = r"Fit results with $\phi_g$ = "+str(whatphi)+r"$\degree$"
  p.write_eps("interference_nowwithphi_"+str(whatphi)+".eps")
  p.show()

dothatplot(0.0)
dothatplot(22.5)
dothatplot(45.0)
dothatplot(67.5)
dothatplot(90.0)
dothatplot(112.5)
dothatplot(135.0)
dothatplot(157.5)
dothatplot(180.0)
dothatplot(202.5)
dothatplot(225.0)
dothatplot(247.5)
dothatplot(270.0)
dothatplot(292.5)
dothatplot(315.0)
dothatplot(337.5)











