#!/usr/local/bin/perl

%bs = (
       122536 => [-1.205759e-03, 6.794680e-04],
       122537 => [-1.173429e-03, 7.601352e-04],
       122538 => [-1.331610e-03, 6.451725e-04],
       122539 => [-1.387300e-03, 6.792025e-04],
       122540 => [-1.292647e-03, 6.741462e-04],
       122541 => [-1.254241e-03, 6.355481e-04],
       122542 => [-1.308802e-03, 5.959043e-04],
       122545 => [-1.301668e-03, 6.668702e-04],
       122548 => [-1.460440e-03, 6.753113e-04],
       122549 => [-1.286053e-03, 5.348960e-04],
       122550 => [-1.384120e-03, 6.028351e-04],
       122551 => [-1.278679e-03, 6.843900e-04],
       122555 => [-1.285573e-03, 6.429950e-04],
       122556 => [-1.252910e-03, 6.667738e-04],
       122557 => [-1.269193e-03, 5.983703e-04],
       122559 => [-1.317262e-03, 6.864222e-04],
       122560 => [-1.328809e-03, 6.964991e-04],
       122562 => [-1.237291e-03, 6.765716e-04],
       122603 => [-1.386009e-03, 6.243336e-04],
       122604 => [-1.588263e-03, 6.177521e-04],
       122605 => [-1.304515e-03, 6.912191e-04],
       122606 => [-1.520336e-03, 6.682543e-04],
       122608 => [-1.285519e-03, 6.509590e-04],
       122610 => [-1.240905e-03, 6.844060e-04],
       122616 => [-1.349902e-03, 7.547413e-04],
       122618 => [-1.412571e-03, 7.137092e-04],
       122619 => [-1.350548e-03, 6.825744e-04],
       122620 => [-1.355664e-03, 6.522973e-04],
       122623 => [-1.267319e-03, 6.935844e-04],
       122625 => [-1.255956e-03, 7.257618e-04],
       122626 => [-1.206207e-03, 7.105770e-04],
       122628 => [-1.213271e-03, 6.628397e-04],
       122629 => [-1.337082e-03, 6.720167e-04],
       122631 => [-1.198511e-03, 6.688592e-04],
       122632 => [-1.362148e-03, 6.451016e-04],
       122634 => [-1.231936e-03, 7.045994e-04],
       122640 => [-1.373900e-03, 6.815749e-04],
       122641 => [-1.375523e-03, 7.013866e-04],
       122642 => [-1.479129e-03, 6.187184e-04],
       122643 => [-1.259653e-03, 6.352971e-04],
       122646 => [-1.351194e-03, 6.770781e-04],
       122647 => [-1.315923e-03, 6.429162e-04],
       122648 => [-1.375774e-03, 7.088461e-04],
       122649 => [-1.281105e-03, 6.703645e-04],
       122650 => [-1.286488e-03, 6.768164e-04],
       122653 => [-1.354871e-03, 6.365207e-04],
       122654 => [-1.276058e-03, 6.320224e-04],
       122661 => [-1.240453e-03, 6.488893e-04],
       122665 => [-1.445770e-03, 6.798942e-04],
       122667 => [-1.247732e-03, 6.977600e-04],
       122673 => [-1.357020e-03, 6.500295e-04],
       );

foreach $run ( 122536, 122537, 122538, 122539, 122540, 122541, 122542, 122545,
	       122548, 122549, 122550, 122551, 122555, 122556, 122557,
	       122559, 122560, 122562, 122563, 122564, 122567, 122568, 122569,
	       122570, 122571, 122572, 122573, 122574, 122575, 122576, 122577,
	       122578, 122579, 122585, 122586, 122587, 122590, 122593, 122594,
	       122595, 122596, 122599, 122600, 122602, 122603, 122604, 122605,
	       122606, 122608, 122610, 122613, 122614, 122615, 122616, 122617,
	       122618, 122619, 122620, 122623, 122625, 122626,
	       122628, 122629, 122631, 122632, 122634, 122640, 122641,
	       122642, 122643, 122646, 122647, 122648, 122649, 122650, 122653,
	       122654, 122657, 122658, 122661, 122665, 122667, 122668, 122669,
	       122672, 122673 ) {
    open( TCL, "> r$run.tcl" );
    print TCL "
default prompt off
exception continueEventLoop on

module sel HbookHistogramModule
hbook file rzn/r$run.rzn
hbook init

run_file \$env(C3_SCRIPTS)/runOnPass2.tcl

prod sel DBEventHeaderProd
prod sel CesrBeamEnergyProd
prod sel EventPropertiesProd

module sel DBModule
database in /nfs/cleo3/database/data17/db event startrun beginrun endrun
database read_collection pass2 hadron
database run $run

proc sel EventTypeFilterProc
param EventTypeFilterProc Hadron true

proc sel ../../build_SunOS/shlib/HadronFilterProc
param HadronFilterProc noBunchWeight true
param HadronFilterProc ntupleSize 50
param HadronFilterProc noBeamSpot true
param HadronFilterProc beamSpotX $bs{$run}->[0]
param HadronFilterProc beamSpotY $bs{$run}->[1]

param HadronFilterProc fillBuffer false
go

hbook terminate
exit
";
    
    open( RUN, "> r$run.run" );
    print RUN "#!/usr/local/bin/tcsh

cd \$HOME/hadron_filter/run/dec25-01/
. /nfs/cleo3/scripts/cleo3defs
c3cur

suez -f r$run.tcl > log/r$run.log
";
}


