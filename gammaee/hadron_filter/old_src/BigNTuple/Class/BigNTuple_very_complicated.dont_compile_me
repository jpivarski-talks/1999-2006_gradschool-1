// -*- C++ -*-
//
// Package:     BigNTuple
// Module:      BigNTuple
// 
// Description: <one line class summary>
//
// Implementation:
//     <Notes on implementation>
//
// Author:      Jim McCann
// Created:     Thu May 30 15:00:07 EDT 2002
// $Id$
//
// Revision history
//
// $Log$
//

#include "Experiment/Experiment.h"

// system include files

// user include files
#include "BigNTuple/BigNTuple.h"
#include "Experiment/report.h"
#include "Experiment/units.h"  // for converting to/from standard CLEO units

#include "DataHandler/Record.h"
#include "DataHandler/Frame.h"
#include "FrameAccess/extract.h"
#include "FrameAccess/FAItem.h"
#include "FrameAccess/FATable.h"

#include "Navigation/NavTrack.h"
#include "TrackRoot/TRHelixFit.h"
#include "TrackRoot/TRTrackFitQuality.h"
#include "TrackRoot/TRSeedTrackQuality.h"
#include "TrackDelivery/TDKinematicFit.h"

#include "Navigation/NavTrack.h"
#include "TrackRoot/TRHelixFit.h"
#include "TrackRoot/TRTrackFitQuality.h"
#include "TrackRoot/TRSeedTrackQuality.h"
#include "TrackDelivery/TDKinematicFit.h"
#include "C3Mu/MuTrack.h"
#include "Navigation/NavShower.h"
#include "C3cc/CcShowerAttributes.h"
#include "Navigation/NavConReg.h"
#include "KinematicTrajectory/KTKinematicData.h"
#include "Navigation/NavTkShMatch.h"
#include "C3cc/CcAssignedEnergyHit.h"
#include "BunchFinder/BunchDecision.h"
#include "TrackletBunchFinder/TrackletBunchDecision.h"
#include "/home/mccann/hadron_filter/src/EventVertex/EventVertex/EventVertex.h"

//RICH example 
//Dedx example
//Event Shape example


// STL classes
// You may have to uncomment some of these or other stl headers 
// depending on what other header files you include (e.g. FrameAccess etc.)!
//#include <string>
//#include <vector>
//#include <set>
//#include <map>
//#include <algorithm>
//#include <utility>

//
// constants, enums and typedefs
//
static const char* const kFacilityString = "Processor.BigNTuple" ;

// ---- cvs-based strings (Id and Tag with which file was checked out)
static const char* const kIdString  = "$Id: processor.cc,v 1.30 2002/04/02 22:04:09 ajm36 Exp $";
static const char* const kTagString = "$Name: v06_05_01 $";

//
// static data member definitions
//



//
// constructors and destructor
//
BigNTuple::BigNTuple( void )               // anal1
   : Processor( "BigNTuple" )
   , m_lookForCosmics( "lookForCosmics", this, false )
   , m_getBunchData( "getBunchData", this, true )
{
   report( DEBUG, kFacilityString ) << "here in ctor()" << endl;

   // ---- bind a method to a stream -----
   // These lines ARE VERY IMPORTANT! If you don't bind the 
   // code you've just written (the "action") to a stream, 
   // your code won't get executed!

   bind( &BigNTuple::event,    Stream::kEvent );
   //bind( &BigNTuple::beginRun, Stream::kBeginRun );
   //bind( &BigNTuple::endRun,   Stream::kEndRun );

   // do anything here that needs to be done at creation time
   // (e.g. allocate resources etc.)

}

BigNTuple::~BigNTuple()                    // anal5
{
   report( DEBUG, kFacilityString ) << "here in dtor()" << endl;
 
   // do anything here that needs to be done at desctruction time
   // (e.g. close files, deallocate resources etc.)

}

//
// member functions
//

// ------------ methods for beginning/end "Interactive" ------------
// --------------------------- init method -------------------------
void
BigNTuple::init( void )          // anal1 "Interactive"
{
   report( DEBUG, kFacilityString ) << "here in init()" << endl;

   // do any initialization here based on Parameter Input by User
   // (e.g. run expensive algorithms that are based on parameters
   //  specified by user at run-time)

}

// -------------------- terminate method ----------------------------
void
BigNTuple::terminate( void )     // anal5 "Interactive"
{
   report( DEBUG, kFacilityString ) << "here in terminate()" << endl;

   // do anything here BEFORE New Parameter Change
   // (e.g. write out result based on parameters from user-input)
 
}

const double cosmic_energy_low = 0.210-0.060;
const double cosmic_energy_high = 0.210+0.060;

const double cosmic_phi0diff_low = 3.1415926-0.005;
const double cosmic_phi0diff_high = 3.1415926+0.005;

const double cosmic_d0sum_low = -0.0005;
const double cosmic_d0sum_high = 0.0005;
		    
const double cosmic_z0diff_low = -0.001;
const double cosmic_z0diff_high = 0.001;
		    
const double cosmic_cotThetadiff_low = -0.015;
const double cosmic_cotThetadiff_high = 0.015;

const char* ntuple_labels[BigNTuple::kEntries] = {
   "w_z0",
   "w_d0",
   "charge",
   "ch_px",
   "ch_py",
   "ch_pz",
   "n_px",
   "n_py",
   "n_pz",
   "num_sh",
   "num_un",
   "num_tr",
   "tot_sh_e",
   "max_sh_e",
   "tot_un_e",
   "max_un_e",
   "tot_tr_p",
   "max_tr_p",
   "tot_tr_e",
   "max_tr_e",
   "bw_best",
   "bw_next",
   "v_x",
   "v_y",
   "v_z",
   "v_chi2",
   "v_chi2pT",
};

// ---------------- standard place to book histograms ---------------
void
BigNTuple::hist_book( HIHistoManager& iHistoManager )
{
   report( DEBUG, kFacilityString ) << "here in hist_book()" << endl;

   // book your histograms here

   m_cosmic = iHistoManager.ntuple(
      1, "cosmic", kEntries, 262144, ntuple_labels );

   m_other = iHistoManager.ntuple(
      2, "other", kEntries, 262144, ntuple_labels );

   m_cosmic_energy = iHistoManager.histogram(
      100, "cosmic energy", 100, cosmic_energy_low, cosmic_energy_high );
   m_cosmic_phi0diff = iHistoManager.histogram(
      200, "cosmic phi0diff", 100, cosmic_phi0diff_low, cosmic_phi0diff_high );
   m_cosmic_d0sum = iHistoManager.histogram(
      300, "cosmic d0sum", 100, cosmic_d0sum_low, cosmic_d0sum_high );
   m_cosmic_z0diff = iHistoManager.histogram(
      400, "cosmic z0diff", 100, cosmic_z0diff_low, cosmic_z0diff_high );
   m_cosmic_cotThetadiff = iHistoManager.histogram(
      500, "cosmic cotThetadiff", 100, cosmic_cotThetadiff_low, cosmic_cotThetadiff_high );

   m_cosmic_un_cosTh = iHistoManager.histogram(
      600, "cosmic unmatched shower cos(theta)", 100, -1., 1. );
   m_other_un_cosTh = iHistoManager.histogram(
      650, "other unmatched shower cos(theta)", 100, -1., 1. );
}

// --------------------- methods bound to streams -------------------
ActionBase::ActionResult
BigNTuple::event( Frame& iFrame )          // anal3 equiv.
{
   report( DEBUG, kFacilityString ) << "here in event()" << endl;

   DABoolean isCosmic( false );

   FATable< NavShower > navshowers;
   extract( iFrame.record( Stream::kEvent ), navshowers );
   FATable< NavShower >::const_iterator showers_end = navshowers.end();

   FATable< NavTrack > navtracks;
   extract( iFrame.record( Stream::kEvent ), navtracks );
   FATable< NavTrack >::const_iterator tracks_end = navtracks.end();

   FAItem< TrackletBunchDecision > bunchDecision;
   if ( m_getBunchData.value() )
      extract( iFrame.record( Stream::kEvent ), bunchDecision );

   FAItem< EventVertex > eventVertex;
   if ( navtracks.size() > 2 )
      extract( iFrame.record( Stream::kEvent ), eventVertex );

   if ( m_lookForCosmics.value() )
      if ( navtracks.size() == 2 ) {

	 FATable< MuTrack > mutracks;
	 extract( iFrame.record( Stream::kEvent ), mutracks );

	 if ( mutracks.size() == 2 ) {

	    FATable< MuTrack >::const_iterator secondMu = mutracks.begin();
	    FATable< MuTrack >::const_iterator firstMu = secondMu;
	    secondMu++;

	    if ( firstMu->dpthmu() > 3.  &&
		 secondMu->dpthmu() > 3.     ) {

	       FATable< NavTrack >::const_iterator secondNav = navtracks.begin();
	       FATable< NavTrack >::const_iterator firstNav = secondNav;
	       secondNav++;

	       if ( ! firstNav->pionQuality()->fitAbort()  &&
		    ! secondNav->pionQuality()->fitAbort()     ) {

		  if ( ! firstNav->seedQuality()->originUsed()  &&
		       ! secondNav->seedQuality()->originUsed()     ) {

		     int suspicious_showers( 0 );
		     double suspicious_energy[2];
		     for ( FATable< NavShower >::const_iterator shower_iter = navshowers.begin();
			   shower_iter != showers_end;
			   shower_iter++ ) {

			double energy( shower_iter->attributes().energy() );

			if ( cosmic_energy_low < energy && energy < cosmic_energy_high  &&
			     ! shower_iter->attributes().hot()                          &&
			     shower_iter->trackMatches().size() == 1                       ) {

			   if ( suspicious_showers < 2 )
			      suspicious_energy[ suspicious_showers ] = energy;
			   suspicious_showers++;

			}
		     } // end loop over showers

		     if ( suspicious_showers == 2 ) {

			FAItem< TRHelixFit > firstHelix = firstNav->pionHelix();
			FAItem< TRHelixFit > secondHelix = secondNav->pionHelix();

			double phi0diff( firstHelix->phi0() - secondHelix->phi0() );
			if ( phi0diff < 0. ) phi0diff *= -1.;
			double d0sum( firstHelix->d0() + secondHelix->d0() );
			double z0diff( firstHelix->z0() - secondHelix->z0() );
			double cotThetadiff( firstHelix->cotTheta() + secondHelix->cotTheta() );

			report( DEBUG, kFacilityString ) << "energy1 = " << suspicious_energy[0] << endl;
			report( DEBUG, kFacilityString ) << "energy2 = " << suspicious_energy[1] << endl;
			report( DEBUG, kFacilityString ) << "phi0diff = " << phi0diff << endl;
			report( DEBUG, kFacilityString ) << "d0sum = " << d0sum << endl;
			report( DEBUG, kFacilityString ) << "z0diff = " << z0diff << endl;
			report( DEBUG, kFacilityString ) << "cotThetadiff = " << cotThetadiff << endl;

			if ( cosmic_phi0diff_low < phi0diff         &&  phi0diff < cosmic_phi0diff_high         &&
			     cosmic_d0sum_low < d0sum               &&  d0sum < cosmic_d0sum_high               &&
			     cosmic_z0diff_low < z0diff             &&  z0diff < cosmic_z0diff_high             &&
			     cosmic_cotThetadiff_low < cotThetadiff && cotThetadiff < cosmic_cotThetadiff_high     ) {

			   isCosmic = true;

			   m_cosmic_energy->fill( suspicious_energy[0] );
			   m_cosmic_energy->fill( suspicious_energy[1] );
			   m_cosmic_phi0diff->fill( phi0diff );
			   m_cosmic_d0sum->fill( d0sum );
			   m_cosmic_z0diff->fill( z0diff );
			   m_cosmic_cotThetadiff->fill( cotThetadiff );

			} } } } } } } // end tests for isCosmic

   for ( int tracki = 0;  tracki < navtracks.size();  tracki++ ) {
      for ( int trackj = tracki + 1;  trackj < navtracks.size();  trackj++ ) {
	 double x(0.), sigx(0.), y(0.), sigy(0.);

	 KTHelix helixi( *navtracks[tracki].pionHelix() );
	 KTHelix helixj( *navtracks[trackj].pionHelix() );

	 if ( calculate_crossing( helixi, helixj, x, sigx, y, sigy ) )
	    cout << "YAY! x = " << x << " +/- " << sigx << ", y = " << y << " +/- " << sigy << endl;
	 if ( calculate_crossing( helixj, helixi, x, sigx, y, sigy ) )
	    cout << "YAY! x = " << x << " +/- " << sigx << ", y = " << y << " +/- " << sigy << endl;
      }
   }

   float v[kEntries];
   for ( int i = 0;  i < kEntries;  i++ ) v[i] = 0.;
   
   double w_z0_denom( 0. );
   double w_d0_denom( 0. );

   // track loop
   for ( FATable< NavTrack >::const_iterator track_iter = navtracks.begin();
	 track_iter != tracks_end;
	 track_iter++ )
      if ( ! track_iter->pionQuality()->fitAbort()  &&
	   ! track_iter->seedQuality()->originUsed()   ) {

	 v[kNumTracks] += 1.;

	 v[kChargedMomX] += track_iter->pionFit()->momentum().x();
	 v[kChargedMomY] += track_iter->pionFit()->momentum().y();
	 v[kChargedMomZ] += track_iter->pionFit()->momentum().z();

	 if ( track_iter->pionHelix()->curvature() > 0. )
	    v[kCharge] += 1.;
	 else
	    v[kCharge] -= 1.;

	 report( DEBUG, kFacilityString )
	    << "hasNullErrorMatrix() = " << track_iter->pionHelix()->hasNullErrorMatrix()
	    << ", errorMatrix()[ kZ0 ][ kZ0 ] = "
	    << track_iter->pionHelix()->errorMatrix()( KTHelix::kZ0, KTHelix::kZ0 )
	    << ", z0 = " << track_iter->pionHelix()->z0() << endl;

	 float z0err2( 1. );
	 if ( ! track_iter->pionHelix()->hasNullErrorMatrix()  &&
	      track_iter->pionHelix()->errorMatrix()( KTHelix::kZ0, KTHelix::kZ0 ) > 0. )
	    z0err2 = track_iter->pionHelix()->errorMatrix()( KTHelix::kZ0, KTHelix::kZ0 );

	 v[kWeightedZ0] += track_iter->pionHelix()->z0() / z0err2;
	 w_z0_denom += 1. / z0err2;

	 float d0err2( 1. );
	 if ( ! track_iter->pionHelix()->hasNullErrorMatrix()  &&
	      track_iter->pionHelix()->errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) > 0. )
	    d0err2 = track_iter->pionHelix()->errorMatrix()( KTHelix::kD0, KTHelix::kD0 );

	 v[kWeightedD0] += abs( track_iter->pionHelix()->d0() ) / d0err2;
	 w_d0_denom += 1. / d0err2;

	 v[kTotalTrackMomentum] += track_iter->pionFit()->momentum().mag();
	 if ( track_iter->pionFit()->momentum().mag() > v[kMaxTrackMomentum] )
	    v[kMaxTrackMomentum] = track_iter->pionFit()->momentum().mag();

	 v[kTotalTrackEnergy] += track_iter->pionFit()->energy();
	 if ( track_iter->pionFit()->energy() > v[kMaxTrackEnergy] )
	    v[kMaxTrackEnergy] = track_iter->pionFit()->energy();
      } // end loop over tracks

   if ( w_z0_denom != 0. )
      v[kWeightedZ0] /= w_z0_denom;
   
   if ( w_d0_denom != 0. )
      v[kWeightedD0] /= w_d0_denom;
   
   // shower loop
   for ( FATable< NavShower >::const_iterator shower_iter = navshowers.begin();
	 shower_iter != showers_end;
	 shower_iter++ )
      if ( ( shower_iter->attributes().goodBarrel()  ||
	     shower_iter->attributes().goodEndcap()     )  &&
	   ! shower_iter->attributes().hot()                   ) {
	 const double energy = shower_iter->attributes().energy();

	 v[kNumShowers] += 1.;
	 v[kTotalShowerEnergy] += energy;

	 if ( energy > v[kMaxShowerEnergy] ) v[kMaxShowerEnergy] = energy;

	 if ( shower_iter->noTrackMatch() ) {

	    v[kNumUnmatched] += 1.;
	    v[kTotalUnmatchedEnergy] += energy;

	    if ( energy > v[kMaxUnmatchedEnergy] ) v[kMaxUnmatchedEnergy] = energy;

	    v[kNeutralMomX] += shower_iter->attributes().momentum().x();
	    v[kNeutralMomY] += shower_iter->attributes().momentum().y();
	    v[kNeutralMomZ] += shower_iter->attributes().momentum().z();

	    if ( m_lookForCosmics.value()  &&  isCosmic )
	       m_cosmic_un_cosTh->fill( shower_iter->attributes().theta() );
	    else
	       m_other_un_cosTh->fill( shower_iter->attributes().theta() );

	 } // end if no track match
      }

   if ( m_getBunchData.value() )
      if ( bunchDecision->numberOfTestedBunches() > 0 ) {
	 v[kBunchWeightBest] = bunchDecision->bestBunchInfo().bweight();
	 v[kBunchWeightNext] = bunchDecision->bunchInfo( 1 ).bweight();
      }

   if ( navtracks.size() > 2  &&
	eventVertex->vertexType() == EventVertex::kGoodEvent ) {
      v[kVertexX] = eventVertex->vertexPosition().x();
      v[kVertexY] = eventVertex->vertexPosition().y();
      v[kVertexZ] = eventVertex->vertexPosition().z();
      v[kVertexChi2] = eventVertex->vertexChiSquare();
      v[kVertexChi2perTrack] = ( eventVertex->vertexChiSquare() / 
				 eventVertex->numTrackFinalVertex() );
   }

   for ( int j = 0;  j < kEntries;  j++ )
      report( DEBUG, kFacilityString )
	 << ntuple_labels[j] << " = " << v[j] << endl;

   // put the variables into the ntuple
   if ( m_lookForCosmics.value()  &&  isCosmic )
      m_cosmic->fill( v );
   else
      m_other->fill( v );

   return ActionBase::kPassed;
}

/*
ActionBase::ActionResult
BigNTuple::beginRun( Frame& iFrame )       // anal2 equiv.
{
   report( DEBUG, kFacilityString ) << "here in beginRun()" << endl;

   return ActionBase::kPassed;
}
*/

/*
ActionBase::ActionResult
BigNTuple::endRun( Frame& iFrame )         // anal4 equiv.
{
   report( DEBUG, kFacilityString ) << "here in endRun()" << endl;

   return ActionBase::kPassed;
}
*/

//
// const member functions
//

//
// static member functions
//

DABoolean BigNTuple::calculate_crossing(
   KTHelix& a, KTHelix& b,
   double& x, double& sigx, double& y, double& sigy )
{
   double x1(0), y1(0), x2(0), y2(0), x3(0), y3(0), x4(0), y4(0);

   // You could still find an intersection, but this won't happen
   // often enough for me to worry about it.
   if ( a.curvature() == 0.  ||  b.curvature() == 0. ) return false;

   if ( ! sol1( a, b, x1, y1 ) ) return false;
   if ( ! sol2( a, b, x2, y2 ) ) return false;
   if ( ! sol3( a, b, x3, y3 ) ) return false;
   if ( ! sol4( a, b, x4, y4 ) ) return false;

   double deviation1( radial_deviations( a, b, x1, y1 ) );
   double deviation2( radial_deviations( a, b, x2, y2 ) );
   double deviation3( radial_deviations( a, b, x3, y3 ) );
   double deviation4( radial_deviations( a, b, x4, y4 ) );
   
   // Only two of the four solutions will be on both circles. Of those
   // two, I want the one which is closest to the origin.
   double goodx1, goody1, goodx2, goody2;
   double goodex1(0.), goodey1(0.), goodex2(0.), goodey2(0.);

   // The following algorithm has been tested with 100,000 random
   // trials (I was mostly worried about a mis-type).
   
   // Pick a best (goodx1 and goody1) and then throw it out of the running by increasing its "deviation"
   if ( deviation1 <= deviation2  &&  deviation1 <= deviation3  &&  deviation1 <= deviation4 ) {
      goodx1 = x1;  goody1 = y1;
      if ( ! errsol1( a, b, goodex1, goodey1 ) ) return false;
      deviation1 = deviation2 + deviation3 + deviation4;
   }
   else if ( deviation2 <= deviation3  &&  deviation2 <= deviation4  &&  deviation2 <= deviation1 ) {
      goodx1 = x2;  goody1 = y2;
      if ( ! errsol2( a, b, goodex1, goodey1 ) ) return false;
      deviation2 = deviation3 + deviation4 + deviation1;
   }
   else if ( deviation3 <= deviation4  &&  deviation3 <= deviation1  &&  deviation3 <= deviation2 ) {
      goodx1 = x3;  goody1 = y3;
      if ( ! errsol3( a, b, goodex1, goodey1 ) ) return false;
      deviation3 = deviation4 + deviation1 + deviation2;
   }
   else if ( deviation4 <= deviation1  &&  deviation4 <= deviation2  &&  deviation4 <= deviation3 ) {
      goodx1 = x4;  goody1 = y4;
      if ( ! errsol4( a, b, goodex1, goodey1 ) ) return false;
      deviation4 = deviation1 + deviation2 + deviation3;
   }
   // Pick a second-best (goodx2 and goody2)
   if ( deviation1 <= deviation2  &&  deviation1 <= deviation3  &&  deviation1 <= deviation4 ) {
      goodx2 = x1;  goody2 = y1;
      if ( ! errsol1( a, b, goodex2, goodey2 ) ) return false;
   }
   else if ( deviation2 <= deviation3  &&  deviation2 <= deviation4  &&  deviation2 <= deviation1 ) {
      goodx2 = x2;  goody2 = y2;
      if ( ! errsol2( a, b, goodex2, goodey2 ) ) return false;
   }
   else if ( deviation3 <= deviation4  &&  deviation3 <= deviation1  &&  deviation3 <= deviation2 ) {
      goodx2 = x3;  goody2 = y3;
      if ( ! errsol3( a, b, goodex2, goodey2 ) ) return false;
   }
   else if ( deviation4 <= deviation1  &&  deviation4 <= deviation2  &&  deviation4 <= deviation3 ) {
      goodx2 = x4;  goody2 = y4;
      if ( ! errsol4( a, b, goodex2, goodey2 ) ) return false;
   }

   // So that I can look at a few:
   double Ra( 1./2./a.curvature() );
   double x0a( -(a.d0() + Ra) * sin(a.phi0()) );
   double y0a( (a.d0() + Ra) * cos(a.phi0()) );
   double Rb( 1./2./b.curvature() );
   double x0b( -(b.d0() + Rb) * sin(b.phi0()) );
   double y0b( (b.d0() + Rb) * cos(b.phi0()) );
   cout << "LOOKIT {{" << x0a << "+" << Ra << "*Cos[t]," << y0a << "+" << Ra << "*Sin[t]}, "
	<< "{" << x0b << "+" << Rb << "*Cos[t]," << y0b << "+" << Rb << "*Sin[t]}, "
	<< "{ {" << goodx1 << "," << goody1 << "},ErrorBar[" << goodex1 << "," << goodey1 << "] }, "
	<< "{ {" << goodx2 << "," << goody2 << "},ErrorBar[" << goodex2 << "," << goodey2 << "] }}" << endl;

   // return the closer one
   double goodmag1( sqr(goodx1) + sqr(goody1) );
   double goodmag2( sqr(goodx2) + sqr(goody2) );
   if ( goodmag1 < goodmag2 ) {
      x = goodx1;
      sigx = goodex1;
      y = goody1;
      sigy = goodey1;
      return true;
   }
   else {
      x = goodx2;
      sigx = goodex2;
      y = goody2;
      sigy = goodey2;
      return true;
   }
}

double BigNTuple::radial_deviations( KTHelix& a, KTHelix& b, double x, double y )
{
   double Ra( 1./2./a.curvature() );
   double x0a( -(a.d0() + Ra) * sin(a.phi0()) );
   double y0a( (a.d0() + Ra) * cos(a.phi0()) );
   double Rb( 1./2./b.curvature() );
   double x0b( -(b.d0() + Rb) * sin(b.phi0()) );
   double y0b( (b.d0() + Rb) * cos(b.phi0()) );

   return ( abs( sqr(x - x0a) + sqr(y - y0a) - sqr(Ra) ) +
	    abs( sqr(x - x0b) + sqr(y - y0b) - sqr(Rb) ) );
}

DABoolean BigNTuple::sol1( KTHelix& a, KTHelix& b, double& x, double& y )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double sqrtarg1( 4/pow(curvb,2) - (4*pow(1 + 2*curvb*d0b,2)*
					pow(cos(phi0b),2))/pow(curvb,2) - 
		    (4*(1 + 2*curvb*d0b)*cos(phi0b)*
		     (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
					   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
		      (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
					 cos(phi0a - 2*phi0b) + 
					 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
					 (curvb + 4*pow(curva,2)*d0b + 
					  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
		    (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
			    pow(curva,2)*(1 + 4*curvb*d0b + 
					    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
			    2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
		       )) - (2*pow(curva,2) + 2*pow(curvb,2) - 
			     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
			     64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
			     32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
			     64*pow(curva,3)*curvb*d0a*d0b - 64*curva*pow(curvb,3)*d0a*d0b - 
			     64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
			     320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
			     512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
			     256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
			     32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
			     320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
			     64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
			     320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
			     320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
			     512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
			     256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
			     64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
			     512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
			     512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
			     32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
			     256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
			     256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
			     pow(1 + 2*curva*d0a,2)*
			     (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
			      16*curva*pow(curvb,2)*d0a*
			      (1 + 4*curvb*d0b + 2*pow(curvb,2)*
			       (pow(d0a,2) + 2*pow(d0b,2))) + 
			      pow(curva,2)*(1 + 8*curvb*d0b + 
					      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
					      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
					      16*pow(curvb,4)*
					      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))))
			     *cos(2*phi0a) - 2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
			     (4*pow(curva,2)*d0b + 
			      curvb*(1 + 4*curva*d0a + 
				     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
			     cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
			     4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
			     4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
			     8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
			     32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
			     32*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
			     24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
			     cos(2*(phi0a - 2*phi0b)) + 
			     64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
			     cos(2*(phi0a - 2*phi0b)) + pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
			     8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
			     24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
			     cos(4*phi0a - 2*phi0b) + 
			     32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
			     cos(4*phi0a - 2*phi0b) + 
			     16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
			     cos(4*phi0a - 2*phi0b) + 
			     4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
			     32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
			     96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
			     cos(4*phi0a - 2*phi0b) + 
			     128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
			     cos(4*phi0a - 2*phi0b) + 
			     64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
			     cos(4*phi0a - 2*phi0b) + 
			     4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
			     32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
			     96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
			     cos(4*phi0a - 2*phi0b) + 
			     128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
			     cos(4*phi0a - 2*phi0b) + 
			     64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
			     cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
			     12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
			     8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
			     48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
			     56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
			     32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
			     144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
			     160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
			     64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a - phi0b) + 
			     8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
			     12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
			     16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
			     216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
			     16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
			     576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
			     cos(phi0a - phi0b) + 112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
			     cos(phi0a - phi0b) + 384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
			     d0b*cos(phi0a - phi0b) + 
			     288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
			     cos(phi0a - phi0b) + 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
			     d0b*cos(phi0a - phi0b) + 
			     128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
			     cos(phi0a - phi0b) + 56*pow(curva,3)*curvb*pow(d0b,2)*
			     cos(phi0a - phi0b) + 48*curva*pow(curvb,3)*pow(d0b,2)*
			     cos(phi0a - phi0b) + 112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
			     cos(phi0a - phi0b) + 576*pow(curva,2)*pow(curvb,3)*d0a*
			     pow(d0b,2)*cos(phi0a - phi0b) + 
			     1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
			     cos(phi0a - phi0b) + 960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
			     pow(d0b,2)*cos(phi0a - phi0b) + 
			     144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
			     32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
			     288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
			     cos(phi0a - phi0b) + 384*pow(curva,2)*pow(curvb,4)*d0a*
			     pow(d0b,3)*cos(phi0a - phi0b) + 
			     960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
			     cos(phi0a - phi0b) + 640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
			     pow(d0b,3)*cos(phi0a - phi0b) + 
			     160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
			     320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
			     cos(phi0a - phi0b) + 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
			     cos(phi0a - phi0b) + 128*pow(curva,4)*pow(curvb,4)*d0a*
			     pow(d0b,5)*cos(phi0a - phi0b) - 
			     2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
			     2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
			     8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
			     24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
			     8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
			     88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
			     cos(2*(phi0a - phi0b)) - 
			     128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
			     cos(2*(phi0a - phi0b)) - 
			     64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
			     cos(2*(phi0a - phi0b)) - 
			     24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
			     8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
			     96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
			     96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
			     96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
			     352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
        12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
        12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*(phi0a - phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*(phi0a - phi0b)) + 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
        12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
        8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(3*phi0a - phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(3*phi0a - phi0b) - 
        12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
        16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*phi0a - phi0b) - 
        112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(3*phi0a - phi0b) - 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
        pow(curvb,2)*cos(2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
        40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
        8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(2*phi0b) + 
        64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
        160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
        16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
        72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,2)*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
         pow(d0b,2)*cos(2*phi0b) + 
        96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
         cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,4)*cos(2*phi0b) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
        4*curva*curvb*cos(phi0a + phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
        32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a + phi0b) - 
        80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
        240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a + phi0b) - 
        256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a + phi0b) - 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a + phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a + phi0b) - 32*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a + phi0b) - 24*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a + phi0b) - 64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a + phi0b) - 240*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a + phi0b) - 384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
        256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a + phi0b) - 160*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a + phi0b) - 256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a + phi0b) - 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a + phi0b) - 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a + phi0b))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) - (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))\
      - (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) );
   double sqrtarg2( -(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
           8*pow(curvb,2)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*pow(d0a,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
           32*curva*curvb*d0a*d0b + 
           32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
           8*pow(curva,2)*pow(d0b,2) + 4*pow(curvb,2)*pow(d0b,2) + 
           32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
           32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
           16*pow(curva,2)*curvb*pow(d0b,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
           8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            (curva*d0b + curvb*
               (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
            cos(phi0a - phi0b) + 
           pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
            cos(2*(phi0a - phi0b)))*
         pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
           curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
       (pow(curva,4)*pow(curvb,4))) );

   if ( sqrtarg1 < 0.  ||  sqrtarg2 < 0. ) return false;

   x = -(curvb*sqrt(sqrtarg1) + 2*sin(phi0b) + 4*curvb*d0b*sin(phi0b))/(4.*curvb);
   y = -(sqrt(2)*pow(curva,2)*pow(curvb,2)*sqrt(sqrtarg2) - 
        curva*cos(phi0a) - 2*pow(curva,2)*d0a*cos(phi0a) - 
        4*pow(curvb,2)*d0a*cos(phi0a) - 
        12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
        curva*cos(phi0a - 2*phi0b) + 
        2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
        4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
        4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
        4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
        4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
        4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
        12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b))/
     (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
         pow(curva,2)*(1 + 4*curvb*d0b + 
            4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
         2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
       );

   return true;
}

DABoolean BigNTuple::errsol1( KTHelix& a, KTHelix& b, double& ex, double& ey )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double ed0ad0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0acurva( a.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0aphi0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvacurva( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvaphi0a( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0aphi0a( a.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double ed0bd0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0bcurvb( b.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0bphi0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvbcurvb( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvbphi0b( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0bphi0b( b.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double dxdd0a( -((-4*(1 + 2*curvb*d0b)*
           (-((1 + 2*curva*d0a)*
                (4*pow(curvb,2) + 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
             2*curva*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
           cos(phi0b))/
         (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))) + 
        (4*(1 + 2*curvb*d0b)*(4*curva*pow(curvb,2) + 
             8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
         (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)) - 
        (-64*pow(curva,2)*pow(curvb,2)*d0a - 
           192*pow(curva,3)*pow(curvb,2)*pow(d0a,2) - 
           128*pow(curva,4)*pow(curvb,2)*pow(d0a,3) - 
           64*pow(curva,3)*curvb*d0b - 64*curva*pow(curvb,3)*d0b - 
           128*pow(curva,4)*curvb*d0a*d0b - 
           640*pow(curva,2)*pow(curvb,3)*d0a*d0b - 
           1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b - 
           1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b - 
           320*pow(curva,3)*pow(curvb,2)*pow(d0b,2) - 
           64*curva*pow(curvb,4)*pow(d0b,2) - 
           640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2) - 
           640*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2) - 
           1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
           1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
           512*pow(curva,3)*pow(curvb,3)*pow(d0b,3) - 
           1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3) - 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,4) - 
           512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4) + 
           pow(1 + 2*curva*d0a,2)*
            (32*pow(curvb,4)*d0a + 64*curva*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(32*pow(curvb,2)*d0a + 
                 128*pow(curvb,3)*d0a*d0b + 
                 16*pow(curvb,4)*(4*pow(d0a,3) + 8*d0a*pow(d0b,2))))*
            cos(2*phi0a) + 4*curva*(1 + 2*curva*d0a)*
            (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*cos(2*phi0a) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(4*curva + 8*pow(curva,2)*d0a)*
            pow(1 + 2*curvb*d0b,3)*cos(phi0a - 3*phi0b) - 
           4*pow(curva,2)*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) + 
           4*pow(curva,3)*cos(2*(phi0a - 2*phi0b)) + 
           8*pow(curva,4)*d0a*cos(2*(phi0a - 2*phi0b)) + 
           32*pow(curva,3)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
           64*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
           96*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           192*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           128*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           256*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           64*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           8*curva*pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
           48*pow(curva,2)*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
           96*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
            cos(4*phi0a - 2*phi0b) + 
           64*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
            cos(4*phi0a - 2*phi0b) + 
           32*curva*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
           192*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           32*curva*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
           192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           12*pow(curva,2)*curvb*cos(phi0a - phi0b) + 
           8*pow(curvb,3)*cos(phi0a - phi0b) + 
           96*pow(curva,3)*curvb*d0a*cos(phi0a - phi0b) + 
           112*curva*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
           96*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
            cos(phi0a - phi0b) + 
           640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
            cos(phi0a - phi0b) + 
           320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a - phi0b) + 16*pow(curva,4)*d0b*cos(phi0a - phi0b) + 
           216*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
           16*pow(curvb,4)*d0b*cos(phi0a - phi0b) + 
           1152*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
           224*curva*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
           1152*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a - phi0b) + 
           864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
            cos(phi0a - phi0b) + 
           1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
            cos(phi0a - phi0b) + 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a - phi0b) + 
           112*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
           576*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           2880*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           2880*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           288*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           384*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           1920*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           1920*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a - phi0b) + 
           128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*
            cos(phi0a - phi0b) - 8*pow(curva,3)*cos(2*(phi0a - phi0b)) - 
           24*curva*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
           16*pow(curva,4)*d0a*cos(2*(phi0a - phi0b)) - 
           176*pow(curva,2)*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
            cos(2*(phi0a - phi0b)) - 
           256*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
            cos(2*(phi0a - phi0b)) - 
           96*pow(curva,3)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
           96*curva*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
           192*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           704*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(2*(phi0a - phi0b)) - 
           352*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           96*curva*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
           704*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           704*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) - 
           512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) + 
           12*pow(curva,2)*curvb*cos(3*(phi0a - phi0b)) + 
           48*pow(curva,3)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
           48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
           72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
           288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*(phi0a - phi0b)) + 
           144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) + 
           384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) + 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) - 
           12*pow(curva,2)*curvb*cos(3*phi0a - phi0b) - 
           8*pow(curvb,3)*cos(3*phi0a - phi0b) - 
           48*pow(curva,3)*curvb*d0a*cos(3*phi0a - phi0b) - 
           112*curva*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
           48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
           432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
            cos(3*phi0a - phi0b) - 
           640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
            cos(3*phi0a - phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
            cos(3*phi0a - phi0b) - 
           72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
           16*pow(curvb,4)*d0b*cos(3*phi0a - phi0b) - 
           288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
           224*curva*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*phi0a - phi0b) - 
           864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
            cos(3*phi0a - phi0b) - 
           1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
            cos(3*phi0a - phi0b) - 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(3*phi0a - phi0b) - 
           144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 
           384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*phi0a - phi0b) + 8*curva*pow(curvb,2)*cos(2*phi0b) + 
           80*pow(curva,2)*pow(curvb,2)*d0a*cos(2*phi0b) + 
           192*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
           128*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
           64*pow(curva,3)*curvb*d0b*cos(2*phi0b) + 
           32*curva*pow(curvb,3)*d0b*cos(2*phi0b) + 
           128*pow(curva,4)*curvb*d0a*d0b*cos(2*phi0b) + 
           320*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
           768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
           512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
           320*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
           32*curva*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
           640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           320*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           768*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*phi0b) + 512*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
            pow(d0b,2)*cos(2*phi0b) + 
           512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
           1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
           512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*cos(2*phi0b) - 
           48*pow(curva,3)*curvb*d0a*cos(phi0a + phi0b) - 
           64*curva*pow(curvb,3)*d0a*cos(phi0a + phi0b) - 
           48*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
           384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
            cos(phi0a + phi0b) - 
           640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
            cos(phi0a + phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a + phi0b) - 
           80*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a + phi0b) - 
           480*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
           128*curva*pow(curvb,4)*d0a*d0b*cos(phi0a + phi0b) - 
           480*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a + phi0b) - 
           768*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
            cos(phi0a + phi0b) - 
           1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
            cos(phi0a + phi0b) - 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a + phi0b) - 
           64*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
           240*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           1152*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           1152*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           256*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           160*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           768*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           768*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a + phi0b) - 
           128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(phi0a + phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (2*(4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b)))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (4*pow(curvb,2) + 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
             2*curva*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
           (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                   4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) - 
        (sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) - 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) - 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdphi0a( -((8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
           cos(phi0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sin(phi0a - phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
           (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b))*sin(phi0a - phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (4*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
             (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b)) - 
                2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b))))/
         (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))) + 
        (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
           pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
           (1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sin(phi0a - phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                   4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
             (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b)) - 
                2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) - 
        (sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) - 
        (-2*pow(1 + 2*curva*d0a,2)*
            (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*sin(2*phi0a) + 
           2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            sin(phi0a - 3*phi0b) - 
           2*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) - 
           8*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) - 
           8*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) - 
           16*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) - 
           64*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) - 
           64*pow(curva,4)*curvb*pow(d0a,2)*d0b*
            sin(2*(phi0a - 2*phi0b)) - 
           48*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
            sin(2*(phi0a - 2*phi0b)) - 
           192*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
            sin(2*(phi0a - 2*phi0b)) - 
           192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            sin(2*(phi0a - 2*phi0b)) - 
           64*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
            sin(2*(phi0a - 2*phi0b)) - 
           256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
            sin(2*(phi0a - 2*phi0b)) - 
           256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            sin(2*(phi0a - 2*phi0b)) - 
           32*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
            sin(2*(phi0a - 2*phi0b)) - 
           128*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
            sin(2*(phi0a - 2*phi0b)) - 
           128*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            sin(2*(phi0a - 2*phi0b)) - 
           4*pow(curvb,2)*sin(4*phi0a - 2*phi0b) - 
           32*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) - 
           96*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
            sin(4*phi0a - 2*phi0b) - 
           128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
            sin(4*phi0a - 2*phi0b) - 
           64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
            sin(4*phi0a - 2*phi0b) - 
           16*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) - 
           128*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) - 
           384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
            sin(4*phi0a - 2*phi0b) - 
           512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
            sin(4*phi0a - 2*phi0b) - 
           256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
            sin(4*phi0a - 2*phi0b) - 
           16*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
           128*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
           384*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            sin(4*phi0a - 2*phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            sin(4*phi0a - 2*phi0b) - 
           256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            sin(4*phi0a - 2*phi0b) + 2*curva*curvb*sin(phi0a - phi0b) - 
           12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) - 
           8*pow(curvb,3)*d0a*sin(phi0a - phi0b) - 
           48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) - 
           56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) - 
           32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) - 
           144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
            sin(phi0a - phi0b) - 
           160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
            sin(phi0a - phi0b) - 
           64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a - phi0b) - 
           8*pow(curva,3)*d0b*sin(phi0a - phi0b) - 
           12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) - 
           16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) - 
           216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a - phi0b) - 
           16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) - 
           576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(phi0a - phi0b) - 
           112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a - phi0b) - 
           384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(phi0a - phi0b) - 
           288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
            sin(phi0a - phi0b) - 
           320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
            sin(phi0a - phi0b) - 
           128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
            sin(phi0a - phi0b) - 
           56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) - 
           48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) - 
           112*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a - phi0b) - 
           576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(phi0a - phi0b) - 
           1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(phi0a - phi0b) - 
           960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(phi0a - phi0b) - 
           144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) - 
           288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
            sin(phi0a - phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
            sin(phi0a - phi0b) - 
           64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a - phi0b) - 
           128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
            sin(phi0a - phi0b) + 4*pow(curva,2)*sin(2*(phi0a - phi0b)) + 
           4*pow(curvb,2)*sin(2*(phi0a - phi0b)) + 
           16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) + 
           48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) + 
           16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) + 
           176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
            sin(2*(phi0a - phi0b)) + 
           256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
            sin(2*(phi0a - phi0b)) + 
           128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
            sin(2*(phi0a - phi0b)) + 
           48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) + 
           16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) + 
           192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) + 
           192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) + 
           192*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*(phi0a - phi0b)) + 
           704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
            sin(2*(phi0a - phi0b)) + 
           176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
           704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           192*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
           704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            sin(2*(phi0a - phi0b)) + 
           128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            sin(2*(phi0a - phi0b)) - 6*curva*curvb*sin(3*(phi0a - phi0b)) - 
           36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) - 
           72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) - 
           48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) - 
           36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) - 
           216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*(phi0a - phi0b)) - 
           432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(3*(phi0a - phi0b)) - 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(3*(phi0a - phi0b)) - 
           72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) - 
           432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(3*(phi0a - phi0b)) - 
           864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(3*(phi0a - phi0b)) - 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(3*(phi0a - phi0b)) - 
           48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) - 
           288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(3*(phi0a - phi0b)) - 
           576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(3*(phi0a - phi0b)) - 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(3*(phi0a - phi0b)) + 6*curva*curvb*sin(3*phi0a - phi0b) + 
           36*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) + 
           24*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) + 
           72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) + 
           168*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) + 
           48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
            sin(3*phi0a - phi0b) + 
           480*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
            sin(3*phi0a - phi0b) + 
           192*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
            sin(3*phi0a - phi0b) + 
           36*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) + 
           216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*phi0a - phi0b) + 
           48*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) + 
           432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(3*phi0a - phi0b) + 
           336*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(3*phi0a - phi0b) + 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(3*phi0a - phi0b) + 
           864*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
            sin(3*phi0a - phi0b) + 
           960*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
            sin(3*phi0a - phi0b) + 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
            sin(3*phi0a - phi0b) + 
           72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(3*phi0a - phi0b) + 
           864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(3*phi0a - phi0b) + 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(3*phi0a - phi0b) + 
           48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) + 
           288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(3*phi0a - phi0b) + 
           576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(3*phi0a - phi0b) + 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(3*phi0a - phi0b) - 4*curva*curvb*sin(phi0a + phi0b) + 
           24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
           32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
           16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
           128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
            sin(phi0a + phi0b) + 
           160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
            sin(phi0a + phi0b) + 
           64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a + phi0b) + 
           80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
           240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(phi0a + phi0b) + 
           64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
           160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(phi0a + phi0b) + 
           256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
            sin(phi0a + phi0b) + 
           320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
            sin(phi0a + phi0b) + 
           128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
            sin(phi0a + phi0b) + 
           32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
           24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
           64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
           240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(phi0a + phi0b) + 
           576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(phi0a + phi0b) + 
           384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(phi0a + phi0b) + 
           128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
           256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
            sin(phi0a + phi0b) + 
           320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
            sin(phi0a + phi0b) + 
           64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a + phi0b) + 
           128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
            sin(phi0a + phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) - 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) - 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdcurva( -((-4*(1 + 2*curvb*d0b)*cos(phi0b)*
           (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
                cos(phi0a)) - 2*d0a*
              (curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
                4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
                (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b))))/
         (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))) + 
        (4*(1 + 2*curvb*d0b)*(4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
         (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)) - 
        (4*curva - 64*curva*pow(curvb,2)*pow(d0a,2) - 
           192*pow(curva,2)*pow(curvb,2)*pow(d0a,3) - 
           128*pow(curva,3)*pow(curvb,2)*pow(d0a,4) - 
           192*pow(curva,2)*curvb*d0a*d0b - 64*pow(curvb,3)*d0a*d0b - 
           256*pow(curva,3)*curvb*pow(d0a,2)*d0b - 
           640*curva*pow(curvb,3)*pow(d0a,2)*d0b - 
           1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b - 
           1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b - 
           64*curva*pow(curvb,2)*pow(d0b,2) - 
           960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
           64*pow(curvb,4)*d0a*pow(d0b,2) - 
           1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
           640*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
           1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
           128*curva*pow(curvb,3)*pow(d0b,3) - 
           1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3) - 
           2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
           64*curva*pow(curvb,4)*pow(d0b,4) - 
           768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
           pow(1 + 2*curva*d0a,2)*
            (16*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              2*curva*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*cos(2*phi0a) + 
           4*d0a*(1 + 2*curva*d0a)*
            (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*cos(2*phi0a) - 
           2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
            (8*curva*d0b + curvb*
               (4*d0a + 8*curva*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) - 
           4*curva*d0a*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) - 
           2*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) + 2*curva*cos(2*(phi0a - 2*phi0b)) + 
           12*pow(curva,2)*d0a*cos(2*(phi0a - 2*phi0b)) + 
           16*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
           16*curva*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
           96*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
           128*pow(curva,3)*curvb*pow(d0a,2)*d0b*
            cos(2*(phi0a - 2*phi0b)) + 
           48*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - 2*phi0b)) + 
           288*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           64*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - 2*phi0b)) + 
           384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           512*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           32*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - 2*phi0b)) + 
           192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           8*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
           48*curva*pow(curvb,2)*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
           96*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
            cos(4*phi0a - 2*phi0b) + 
           64*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
            cos(4*phi0a - 2*phi0b) + 
           32*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
           192*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           32*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
           192*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) - 2*curvb*cos(phi0a - phi0b) + 
           24*curva*curvb*d0a*cos(phi0a - phi0b) + 
           144*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
           56*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
           128*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
           288*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
           480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a - phi0b) + 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
            cos(phi0a - phi0b) + 24*pow(curva,2)*d0b*cos(phi0a - phi0b) + 
           12*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
           64*pow(curva,3)*d0a*d0b*cos(phi0a - phi0b) + 
           432*curva*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
           1728*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a - phi0b) + 
           112*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
           1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(phi0a - phi0b) + 
           576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a - phi0b) + 
           960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a - phi0b) + 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
            cos(phi0a - phi0b) + 
           168*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
           48*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
           448*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
           1152*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
           4320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           3840*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           32*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
           1152*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           768*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a - phi0b) + 
           2880*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           2560*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a - phi0b) + 
           1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
            cos(phi0a - phi0b) + 
           192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*
            cos(phi0a - phi0b) + 
           512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
            cos(phi0a - phi0b) - 4*curva*cos(2*(phi0a - phi0b)) - 
           24*pow(curva,2)*d0a*cos(2*(phi0a - phi0b)) - 
           24*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
           32*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
           176*curva*pow(curvb,2)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
           384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
            cos(2*(phi0a - phi0b)) - 
           256*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
            cos(2*(phi0a - phi0b)) - 
           48*curva*curvb*d0b*cos(2*(phi0a - phi0b)) - 
           288*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           96*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           384*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
           704*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
            cos(2*(phi0a - phi0b)) - 
           176*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
           1056*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           96*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
           1408*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           704*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           256*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           128*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - phi0b)) - 
           768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) + 2*curvb*cos(3*(phi0a - phi0b)) + 
           24*curva*curvb*d0a*cos(3*(phi0a - phi0b)) + 
           72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
           64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
           12*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
           144*curva*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
           432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*(phi0a - phi0b)) + 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(3*(phi0a - phi0b)) + 
           24*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
           288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
           864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           16*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
           192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
           576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) + 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) - 2*curvb*cos(3*phi0a - phi0b) - 
           24*curva*curvb*d0a*cos(3*phi0a - phi0b) - 
           72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
           56*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
           64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
           288*curva*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
           480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
            cos(3*phi0a - phi0b) - 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
            cos(3*phi0a - phi0b) - 
           12*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
           144*curva*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
           432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*phi0a - phi0b) - 
           112*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(3*phi0a - phi0b) - 
           576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(3*phi0a - phi0b) - 
           960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(3*phi0a - phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
            cos(3*phi0a - phi0b) - 
           24*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
           288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*phi0a - phi0b) - 
           864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           16*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
           192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*phi0a - phi0b) - 
           576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 4*curva*cos(2*phi0b) + 
           8*pow(curvb,2)*d0a*cos(2*phi0b) + 
           80*curva*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
           192*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
           128*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
           16*curva*curvb*d0b*cos(2*phi0b) + 
           192*pow(curva,2)*curvb*d0a*d0b*cos(2*phi0b) + 
           32*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
           256*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
           320*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
           768*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
           512*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
           64*pow(curva,3)*pow(d0b,2)*cos(2*phi0b) + 
           144*curva*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
           960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           32*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            cos(2*phi0b) + 320*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*phi0b) + 768*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
            pow(d0b,2)*cos(2*phi0b) + 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            cos(2*phi0b) + 384*pow(curva,3)*curvb*pow(d0b,3)*
            cos(2*phi0b) + 256*curva*pow(curvb,3)*pow(d0b,3)*
            cos(2*phi0b) + 1536*pow(curva,2)*pow(curvb,3)*d0a*
            pow(d0b,3)*cos(2*phi0b) + 
           2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            cos(2*phi0b) + 832*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
            cos(2*phi0b) + 128*curva*pow(curvb,4)*pow(d0b,4)*
            cos(2*phi0b) + 768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*phi0b) + 1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*
            pow(d0b,4)*cos(2*phi0b) + 
           768*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
           4*curvb*cos(phi0a + phi0b) - 
           72*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
           32*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
           64*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
           256*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
           480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a + phi0b) - 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
            cos(phi0a + phi0b) - 
           160*curva*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
           720*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a + phi0b) - 
           64*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
           640*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(phi0a + phi0b) - 
           512*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a + phi0b) - 
           960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a + phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
            cos(phi0a + phi0b) - 
           96*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
           24*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
           256*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
           480*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
           1728*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           1536*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           16*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
           1024*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           320*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a + phi0b) - 
           1152*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a + phi0b) - 
           1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
            cos(phi0a + phi0b) - 
           192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*
            cos(phi0a + phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
            cos(phi0a + phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (2*(4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b)))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) + 
        (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
           (4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                   4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (8*sqrt(2)*curva*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b)) - 
        (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
                cos(phi0a)) - 2*d0a*
              (curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
                4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
                (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (4*sqrt(2)*curva*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) - 
        (sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) - 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) - 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdd0b( -(4*curvb*sin(phi0b) + 
        (curvb*((-16*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/curvb - 
             (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((1 + 2*curvb*d0b)*
                   (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                     (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
                      cos(phi0b)) + 
                  2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (4*(1 + 2*curvb*d0b)*
                (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)) - 
             (8*cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (-64*pow(curva,3)*curvb*d0a - 64*curva*pow(curvb,3)*d0a - 
                64*pow(curva,4)*curvb*pow(d0a,2) - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4) - 
                64*pow(curva,2)*pow(curvb,2)*d0b - 
                640*pow(curva,3)*pow(curvb,2)*d0a*d0b - 
                128*curva*pow(curvb,4)*d0a*d0b - 
                640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b - 
                640*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b - 
                1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b - 
                192*pow(curva,2)*pow(curvb,3)*pow(d0b,2) - 
                1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2) - 
                1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                 pow(d0b,2) - 
                128*pow(curva,2)*pow(curvb,4)*pow(d0b,3) - 
                1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3) - 
                1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                 pow(d0b,3) + 
                pow(1 + 2*curva*d0a,2)*
                 (16*curva*pow(curvb,2)*d0a*
                    (4*curvb + 8*pow(curvb,2)*d0b) + 
                   pow(curva,2)*
                    (8*curvb + 80*pow(curvb,2)*d0b + 
                      128*pow(curvb,3)*pow(d0b,2) + 
                      64*pow(curvb,3)*(pow(d0a,2) + pow(d0b,2)) + 
                      16*pow(curvb,4)*(8*pow(d0a,2)*d0b + 8*pow(d0b,3)))
                   )*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
                 cos(phi0a - 3*phi0b) - 
                12*curva*curvb*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                8*pow(curva,2)*curvb*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                48*pow(curva,2)*pow(curvb,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,3)*pow(curvb,2)*d0a*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curvb,3)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                8*pow(curvb,4)*d0b*cos(4*phi0a - 2*phi0b) + 
                64*curva*pow(curvb,4)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                8*pow(curva,3)*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                112*pow(curva,3)*curvb*d0b*cos(phi0a - phi0b) + 
                96*curva*pow(curvb,3)*d0b*cos(phi0a - phi0b) + 
                224*pow(curva,4)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
                1152*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                2880*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                1920*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                432*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                96*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a - phi0b) + 
                864*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1152*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                2880*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1920*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) - 
                24*pow(curva,2)*curvb*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*pow(curvb,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                16*pow(curvb,4)*d0b*cos(2*(phi0a - phi0b)) - 
                704*pow(curva,3)*pow(curvb,2)*d0a*d0b*
                 cos(2*(phi0a - phi0b)) - 
                192*curva*pow(curvb,4)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(3*(phi0a - phi0b)) + 
                48*curva*pow(curvb,3)*d0b*cos(3*(phi0a - phi0b)) + 
                288*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) - 
                12*curva*pow(curvb,2)*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                48*curva*pow(curvb,3)*d0b*cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) + 8*pow(curva,2)*curvb*cos(2*phi0b) + 
                4*pow(curvb,3)*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(2*phi0b) + 
                32*pow(curva,4)*d0b*cos(2*phi0b) + 
                144*pow(curva,2)*pow(curvb,2)*d0b*cos(2*phi0b) + 
                8*pow(curvb,4)*d0b*cos(2*phi0b) + 
                640*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
                64*curva*pow(curvb,4)*d0a*d0b*cos(2*phi0b) + 
                640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 
                288*pow(curva,4)*curvb*pow(d0b,2)*cos(2*phi0b) + 
                384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
                1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                832*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
                256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(2*phi0b) + 
                1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
                384*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(2*phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*curvb*d0b*cos(phi0a + phi0b) - 
                48*curva*pow(curvb,3)*d0b*cos(phi0a + phi0b) - 
                128*pow(curva,4)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
                480*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(phi0a + phi0b) - 
                1152*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                768*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                48*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a + phi0b) - 
                768*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                480*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                1152*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                768*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (2*(pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *(2*pow(curva,2) + 2*pow(curvb,2) - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                  64*pow(curva,3)*curvb*d0a*d0b - 
                  64*curva*pow(curvb,3)*d0a*d0b - 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                  320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) - 
                  320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,2) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                   pow(d0b,2) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
                   pow(d0b,2) - 
                  64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,3) - 
                  32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,4) + 
                  pow(1 + 2*curva*d0a,2)*
                   (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*d0a*
                      (1 + 4*curvb*d0b + 
                        2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                     pow(curva,2)*
                      (1 + 8*curvb*d0b + 
                        64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                        8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                        16*pow(curvb,4)*
                         (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                           2*pow(d0b,4))))*cos(2*phi0a) - 
                  2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                   (4*pow(curva,2)*d0b + 
                     curvb*(1 + 4*curva*d0a + 
                        4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                   cos(phi0a - 3*phi0b) + 
                  pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                  8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - 2*phi0b)) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(4*phi0a - 2*phi0b) + 
                  16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) - 
                  2*curva*curvb*cos(phi0a - phi0b) + 
                  12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                  8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                  48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                  32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a - phi0b) + 
                  8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                  12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                  16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a - phi0b) + 
                  16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a - phi0b) + 
                  56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                  48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                  112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,2)*cos(phi0a - phi0b) + 
                  960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                  288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a - phi0b) - 
                  2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                  2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                  24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*(phi0a - phi0b)) - 
                  24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) + 
                  2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                  12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                  24*pow(curva,3)*curvb*pow(d0a,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*pow(curva,4)*curvb*pow(d0a,3)*
                   cos(3*(phi0a - phi0b)) + 
                  12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  24*curva*pow(curvb,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*curva*pow(curvb,4)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) - 
                  2*curva*curvb*cos(3*phi0a - phi0b) - 
                  12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                  8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(3*phi0a - phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(3*phi0a - phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(3*phi0a - phi0b) - 
                  12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*phi0a - phi0b) - 
                  16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(3*phi0a - phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                  pow(curvb,2)*cos(2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                  40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*phi0b) + 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*phi0b) + 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*phi0b) + 8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                  64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*phi0b) + 
                  16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                  72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                   cos(2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                   cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                  32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a + phi0b) - 
                  80*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a + phi0b) - 
                  32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                  64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a + phi0b)))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
                (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                        4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (8*sqrt(2)*pow(curva,2)*pow(curvb,2)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                ((1 + 2*curvb*d0b)*
                   (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                     (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
                      cos(phi0b)) + 
                  2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) - 
             (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*sin(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,3)) - 
                  ((4*curvb + 32*curva*curvb*d0a + 
                       32*pow(curva,2)*curvb*pow(d0a,2) + 
                       16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                       64*curva*pow(curvb,2)*d0a*d0b + 
                       64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                       48*pow(curva,2)*curvb*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                       16*curvb*(1 + 2*curva*d0a)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) - 
             (sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*sin(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,3)) - 
                  ((4*curvb + 32*curva*curvb*d0a + 
                       32*pow(curva,2)*curvb*pow(d0a,2) + 
                       16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                       64*curva*pow(curvb,2)*d0a*d0b + 
                       64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                       48*pow(curva,2)*curvb*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                       16*curvb*(1 + 2*curva*d0a)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))))/
         (2.*sqrt(4/pow(curvb,2) - 
             (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,2) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*pow(curva,2) + 2*pow(curvb,2) - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                64*pow(curva,3)*curvb*d0a*d0b - 
                64*curva*pow(curvb,3)*d0a*d0b - 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
                32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (1 + 8*curvb*d0b + 
                      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      16*pow(curvb,4)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 
                2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 
                2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 
                2*curva*curvb*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                pow(curvb,2)*cos(2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 
                96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*curvb*cos(phi0a + phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2))))/(4.*curvb) );
   double dxdphi0b( -(2*cos(phi0b) + 4*curvb*d0b*cos(phi0b) + 
        (curvb*((-8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sin(phi0a - phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                (2*pow(curva,2) + 2*pow(curvb,2) - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                  64*pow(curva,3)*curvb*d0a*d0b - 
                  64*curva*pow(curvb,3)*d0a*d0b - 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                  320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) - 
                  320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,2) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                   pow(d0b,2) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
                   pow(d0b,2) - 
                  64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,3) - 
                  32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,4) + 
                  pow(1 + 2*curva*d0a,2)*
                   (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*d0a*
                      (1 + 4*curvb*d0b + 
                        2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                     pow(curva,2)*
                      (1 + 8*curvb*d0b + 
                        64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                        8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                        16*pow(curvb,4)*
                         (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                           2*pow(d0b,4))))*cos(2*phi0a) - 
                  2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                   (4*pow(curva,2)*d0b + 
                     curvb*(1 + 4*curva*d0a + 
                        4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                   cos(phi0a - 3*phi0b) + 
                  pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                  8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - 2*phi0b)) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(4*phi0a - 2*phi0b) + 
                  16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) - 
                  2*curva*curvb*cos(phi0a - phi0b) + 
                  12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                  8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                  48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                  32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a - phi0b) + 
                  8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                  12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                  16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a - phi0b) + 
                  16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a - phi0b) + 
                  56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                  48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                  112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,2)*cos(phi0a - phi0b) + 
                  960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                  288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a - phi0b) - 
                  2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                  2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                  24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*(phi0a - phi0b)) - 
                  24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) + 
                  2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                  12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                  24*pow(curva,3)*curvb*pow(d0a,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*pow(curva,4)*curvb*pow(d0a,3)*
                   cos(3*(phi0a - phi0b)) + 
                  12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  24*curva*pow(curvb,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*curva*pow(curvb,4)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) - 
                  2*curva*curvb*cos(3*phi0a - phi0b) - 
                  12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                  8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(3*phi0a - phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(3*phi0a - phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(3*phi0a - phi0b) - 
                  12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*phi0a - phi0b) - 
                  16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(3*phi0a - phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                  pow(curvb,2)*cos(2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                  40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*phi0b) + 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*phi0b) + 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*phi0b) + 8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                  64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*phi0b) + 
                  16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                  72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                   cos(2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                   cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                  32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a + phi0b) - 
                  80*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a + phi0b) - 
                  32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                  64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a + phi0b))*sin(phi0a - phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (8*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0b))/
              pow(curvb,2) + (4*(1 + 2*curvb*d0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sin(phi0b))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
                pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
                (1 + 2*curvb*d0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sin(phi0a - phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*sin(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (4*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*
                (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*(1 + 2*curvb*d0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))*
                (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((2*(1 + 2*curvb*d0b)*
                     (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*cos(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,4)) - 
                  ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        sin(phi0a - phi0b) + 
                       2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        sin(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) - 
             (sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                ((2*(1 + 2*curvb*d0b)*
                     (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*cos(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,4)) - 
                  ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        sin(phi0a - phi0b) + 
                       2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        sin(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) - 
             (-6*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 sin(phi0a - 3*phi0b) + 
                4*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 sin(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 sin(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 sin(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 sin(2*(phi0a - 2*phi0b)) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 sin(2*(phi0a - 2*phi0b)) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 sin(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 sin(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 sin(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 sin(2*(phi0a - 2*phi0b)) + 
                2*pow(curvb,2)*sin(4*phi0a - 2*phi0b) + 
                16*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) + 
                48*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 sin(4*phi0a - 2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 sin(4*phi0a - 2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 sin(4*phi0a - 2*phi0b) + 
                8*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) + 
                64*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) + 
                192*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 sin(4*phi0a - 2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 sin(4*phi0a - 2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 sin(4*phi0a - 2*phi0b) + 
                8*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) + 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) + 
                192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) - 2*curva*curvb*sin(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*sin(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 sin(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 sin(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 sin(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*sin(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 sin(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 sin(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 sin(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 sin(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 sin(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 sin(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 sin(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 sin(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 sin(phi0a - phi0b) - 
                4*pow(curva,2)*sin(2*(phi0a - phi0b)) - 
                4*pow(curvb,2)*sin(2*(phi0a - phi0b)) - 
                16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) - 
                48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) - 
                16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 sin(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 sin(2*(phi0a - phi0b)) - 
                128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 sin(2*(phi0a - phi0b)) - 
                48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) - 
                16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) - 
                192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) - 
                192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) - 
                192*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) - 
                704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                192*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 sin(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 sin(2*(phi0a - phi0b)) + 
                6*curva*curvb*sin(3*(phi0a - phi0b)) + 
                36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) + 
                72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) + 
                48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) + 
                36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 sin(3*(phi0a - phi0b)) + 
                432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(3*(phi0a - phi0b)) + 
                288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(3*(phi0a - phi0b)) + 
                72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) + 
                432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(3*(phi0a - phi0b)) + 
                864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(3*(phi0a - phi0b)) + 
                576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(3*(phi0a - phi0b)) + 
                48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) + 
                288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(3*(phi0a - phi0b)) + 
                576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(3*(phi0a - phi0b)) + 
                384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(3*(phi0a - phi0b)) - 
                2*curva*curvb*sin(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 sin(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 sin(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 sin(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 sin(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 sin(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 sin(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 sin(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 sin(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(3*phi0a - phi0b) + 4*pow(curva,2)*sin(2*phi0b) - 
                2*pow(curvb,2)*sin(2*phi0b) - 
                16*curva*pow(curvb,2)*d0a*sin(2*phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*sin(2*phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*sin(2*phi0b) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*sin(2*phi0b) - 
                16*pow(curva,2)*curvb*d0b*sin(2*phi0b) - 
                8*pow(curvb,3)*d0b*sin(2*phi0b) - 
                128*pow(curva,3)*curvb*d0a*d0b*sin(2*phi0b) - 
                64*curva*pow(curvb,3)*d0a*d0b*sin(2*phi0b) - 
                128*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*phi0b) - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 sin(2*phi0b) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 sin(2*phi0b) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 sin(2*phi0b) - 32*pow(curva,4)*pow(d0b,2)*sin(2*phi0b) - 
                144*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*sin(2*phi0b) - 
                8*pow(curvb,4)*pow(d0b,2)*sin(2*phi0b) - 
                640*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 sin(2*phi0b) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(2*phi0b) - 
                640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*phi0b) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*phi0b) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 sin(2*phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 sin(2*phi0b) - 
                192*pow(curva,4)*curvb*pow(d0b,3)*sin(2*phi0b) - 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*sin(2*phi0b) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 sin(2*phi0b) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 sin(2*phi0b) - 
                416*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*sin(2*phi0b) - 
                128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*sin(2*phi0b) - 
                512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 sin(2*phi0b) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 sin(2*phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*sin(2*phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*sin(2*phi0b) - 
                4*curva*curvb*sin(phi0a + phi0b) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
                32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 sin(phi0a + phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 sin(phi0a + phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 sin(phi0a + phi0b) + 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(phi0a + phi0b) + 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(phi0a + phi0b) + 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 sin(phi0a + phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 sin(phi0a + phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 sin(phi0a + phi0b) + 
                32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(phi0a + phi0b) + 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(phi0a + phi0b) + 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(phi0a + phi0b) + 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 sin(phi0a + phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 sin(phi0a + phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 sin(phi0a + phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 sin(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2)))/
         (2.*sqrt(4/pow(curvb,2) - 
             (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,2) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*pow(curva,2) + 2*pow(curvb,2) - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                64*pow(curva,3)*curvb*d0a*d0b - 
                64*curva*pow(curvb,3)*d0a*d0b - 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
                32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (1 + 8*curvb*d0b + 
                      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      16*pow(curvb,4)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 
                2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 
                2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 
                2*curva*curvb*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                pow(curvb,2)*cos(2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 
                96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*curvb*cos(phi0a + phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2))))/(4.*curvb) );
   double dxdcurvb( (2*sin(phi0b) + 4*curvb*d0b*sin(phi0b) + 
        curvb*sqrt(4/pow(curvb,2) - 
           (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
           (4*(1 + 2*curvb*d0b)*cos(phi0b)*
              (-((1 + 2*curva*d0a)*
                   (curva + 4*pow(curvb,2)*d0a + 
                     4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                (1 + 2*curvb*d0b)*
                 (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    cos(phi0a - 2*phi0b) + 
                   curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                   (curvb + 4*pow(curva,2)*d0b + 
                      4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
            (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b))) - 
           (2*pow(curva,2) + 2*pow(curvb,2) - 
              32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
              64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
              32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
              64*pow(curva,3)*curvb*d0a*d0b - 
              64*curva*pow(curvb,3)*d0a*d0b - 
              64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
              320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
              512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
              256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
              32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
              320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
              64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
              320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
              320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
              512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
              64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
              512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
              512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
              32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
              256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
              pow(1 + 2*curva*d0a,2)*
               (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*d0a*
                  (1 + 4*curvb*d0b + 
                    2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                 pow(curva,2)*
                  (1 + 8*curvb*d0b + 
                    64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                    8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                    16*pow(curvb,4)*
                     (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                       2*pow(d0b,4))))*cos(2*phi0a) - 
              2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
               (4*pow(curva,2)*d0b + 
                 curvb*(1 + 4*curva*d0a + 
                    4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
               cos(phi0a - 3*phi0b) + 
              pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
              4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
              4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
              8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
              32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
              32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
               cos(2*(phi0a - 2*phi0b)) + 
              24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
               cos(2*(phi0a - 2*phi0b)) + 
              96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
               cos(2*(phi0a - 2*phi0b)) + 
              96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
               cos(2*(phi0a - 2*phi0b)) + 
              32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
               cos(2*(phi0a - 2*phi0b)) + 
              128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
               cos(2*(phi0a - 2*phi0b)) + 
              128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
               cos(2*(phi0a - 2*phi0b)) + 
              16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
               cos(2*(phi0a - 2*phi0b)) + 
              64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
               cos(2*(phi0a - 2*phi0b)) + 
              64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
               cos(2*(phi0a - 2*phi0b)) + 
              pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
              8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
              24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
               cos(4*phi0a - 2*phi0b) + 
              32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
               cos(4*phi0a - 2*phi0b) + 
              16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
               cos(4*phi0a - 2*phi0b) + 
              4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
              32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
              96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
               cos(4*phi0a - 2*phi0b) + 
              128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
               cos(4*phi0a - 2*phi0b) + 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
               cos(4*phi0a - 2*phi0b) + 
              4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
              32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) + 
              96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) + 
              128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) + 
              64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
              12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
              8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
              48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
              56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
              32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
              144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
               cos(phi0a - phi0b) + 
              160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
               cos(phi0a - phi0b) + 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
               cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
              12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
              16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
              216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
              16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
              576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(phi0a - phi0b) + 
              112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
              384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(phi0a - phi0b) + 
              288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
               cos(phi0a - phi0b) + 
              320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
               cos(phi0a - phi0b) + 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
               cos(phi0a - phi0b) + 
              56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
              48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
              112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
              576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(phi0a - phi0b) + 
              1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(phi0a - phi0b) + 
              960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(phi0a - phi0b) + 
              144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
              288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
               cos(phi0a - phi0b) + 
              320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
               cos(phi0a - phi0b) + 
              64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
               cos(phi0a - phi0b) + 
              128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
               cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
              2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
              8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
              24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
              8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
              88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
               cos(2*(phi0a - phi0b)) - 
              128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
               cos(2*(phi0a - phi0b)) - 
              64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
               cos(2*(phi0a - phi0b)) - 
              24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
              8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
              96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
              96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
              96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
               cos(2*(phi0a - phi0b)) - 
              352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
               cos(2*(phi0a - phi0b)) - 
              88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
              352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
               cos(2*(phi0a - phi0b)) - 
              64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
               cos(2*(phi0a - phi0b)) + 
              2*curva*curvb*cos(3*(phi0a - phi0b)) + 
              12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
              24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
              16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
              12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
              72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
               cos(3*(phi0a - phi0b)) + 
              144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(3*(phi0a - phi0b)) + 
              96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(3*(phi0a - phi0b)) + 
              24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
              144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(3*(phi0a - phi0b)) + 
              288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(3*(phi0a - phi0b)) + 
              192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(3*(phi0a - phi0b)) + 
              16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
              96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(3*(phi0a - phi0b)) + 
              192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(3*(phi0a - phi0b)) + 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
              12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
              8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
              24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
              56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
              16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
              144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
               cos(3*phi0a - phi0b) - 
              160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
               cos(3*phi0a - phi0b) - 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
               cos(3*phi0a - phi0b) - 
              12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
              72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
              16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
              144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(3*phi0a - phi0b) - 
              112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
               cos(3*phi0a - phi0b) - 
              96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(3*phi0a - phi0b) - 
              288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
               cos(3*phi0a - phi0b) - 
              320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
               cos(3*phi0a - phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
               cos(3*phi0a - phi0b) - 
              24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
              144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(3*phi0a - phi0b) - 
              288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(3*phi0a - phi0b) - 
              192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(3*phi0a - phi0b) - 
              16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
              96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(3*phi0a - phi0b) - 
              192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(3*phi0a - phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
              pow(curvb,2)*cos(2*phi0b) + 
              8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
              40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
              64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
              32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
              8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
              4*pow(curvb,3)*d0b*cos(2*phi0b) + 
              64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
              32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
              64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
              160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
               cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
               d0b*cos(2*phi0b) + 
              128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
               cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
              72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
              4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
              320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
               cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
               cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
               pow(d0b,2)*cos(2*phi0b) + 
              160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
               cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
               pow(d0b,2)*cos(2*phi0b) + 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
               cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
               cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
               cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
               pow(d0b,3)*cos(2*phi0b) + 
              512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
               cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
               cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
               cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
               pow(d0b,4)*cos(2*phi0b) + 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
               cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
               cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
               cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
              24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
              32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
              16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
              128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
               cos(phi0a + phi0b) - 
              160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
               cos(phi0a + phi0b) - 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
               cos(phi0a + phi0b) - 
              80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
              240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(phi0a + phi0b) - 
              64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
              160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(phi0a + phi0b) - 
              256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
               cos(phi0a + phi0b) - 
              320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
               cos(phi0a + phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
               cos(phi0a + phi0b) - 
              32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
              24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
              64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
              240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(phi0a + phi0b) - 
              576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(phi0a + phi0b) - 
              384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(phi0a + phi0b) - 
              128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
              256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
               cos(phi0a + phi0b) - 
              320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
               cos(phi0a + phi0b) - 
              64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
               cos(phi0a + phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
               cos(phi0a + phi0b))/
            pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b),2) - 
           (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
              sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                      8*pow(curvb,2)*pow(d0a,2) + 
                      16*curva*pow(curvb,2)*pow(d0a,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                      4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                      32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                      8*pow(curva,2)*pow(d0b,2) + 
                      4*pow(curvb,2)*pow(d0b,2) + 
                      32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                      32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                       pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                      8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                       (curva*d0b + 
                         curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2))
                         )*cos(phi0a - phi0b) + 
                      pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                       cos(2*(phi0a - phi0b)))*
                    pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                      curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                  (pow(curva,4)*pow(curvb,4)))))/
            (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b)) - 
           (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
              (-((1 + 2*curva*d0a)*
                   (curva + 4*pow(curvb,2)*d0a + 
                     4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                (1 + 2*curvb*d0b)*
                 (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    cos(phi0a - 2*phi0b) + 
                   curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                   (curvb + 4*pow(curva,2)*d0b + 
                      4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
              sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                      8*pow(curvb,2)*pow(d0a,2) + 
                      16*curva*pow(curvb,2)*pow(d0a,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                      4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                      32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                      8*pow(curva,2)*pow(d0b,2) + 
                      4*pow(curvb,2)*pow(d0b,2) + 
                      32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                      32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                       pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                      8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                       (curva*d0b + 
                         curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2))
                         )*cos(phi0a - phi0b) + 
                      pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                       cos(2*(phi0a - phi0b)))*
                    pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                      curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                  (pow(curva,4)*pow(curvb,4)))))/
            pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b),2)))/(4.*pow(curvb,2)) - 
     (4*d0b*sin(phi0b) + sqrt(4/pow(curvb,2) - 
          (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
          (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) - 
          (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)) + 
        (curvb*(-8/pow(curvb,3) - 
             (16*d0b*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/pow(curvb,2) + 
             (8*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,3) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                     pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
                  2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (4*(1 + 2*curvb*d0b)*
                (2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)) - 
             (8*d0b*cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (pow(curvb,2)*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (4*curvb - 64*pow(curva,2)*curvb*pow(d0a,2) - 
                128*pow(curva,3)*curvb*pow(d0a,3) - 
                64*pow(curva,4)*curvb*pow(d0a,4) - 
                64*pow(curva,3)*d0a*d0b - 
                192*curva*pow(curvb,2)*d0a*d0b - 
                64*pow(curva,4)*pow(d0a,2)*d0b - 
                960*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b - 
                1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b - 
                768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b - 
                64*pow(curva,2)*curvb*pow(d0b,2) - 
                640*pow(curva,3)*curvb*d0a*pow(d0b,2) - 
                256*curva*pow(curvb,3)*d0a*pow(d0b,2) - 
                640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2) - 
                1280*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
                 pow(d0b,2) - 
                2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                 pow(d0b,2) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
                 pow(d0b,2) - 
                192*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3) - 
                1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                 pow(d0b,3) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,4) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                 pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-4*curvb + 64*pow(curvb,3)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (4*d0b + 4*curvb*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   32*curva*curvb*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (8*d0b + 192*pow(curvb,2)*d0b*
                       (pow(d0a,2) + pow(d0b,2)) + 
                      16*curvb*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      64*pow(curvb,3)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2)))*
                 cos(phi0a - 3*phi0b) - 
                12*curva*(1 + 2*curva*d0a)*d0b*pow(1 + 2*curvb*d0b,2)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                8*pow(curva,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
                48*pow(curva,2)*curvb*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,3)*curvb*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 2*curvb*cos(4*phi0a - 2*phi0b) + 
                16*curva*curvb*d0a*cos(4*phi0a - 2*phi0b) + 
                48*pow(curva,2)*curvb*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,3)*curvb*pow(d0a,3)*cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,4)*cos(4*phi0a - 2*phi0b) + 
                12*pow(curvb,2)*d0b*cos(4*phi0a - 2*phi0b) + 
                96*curva*pow(curvb,2)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                288*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curvb,3)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                128*curva*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*cos(phi0a - phi0b) + 
                12*pow(curva,2)*d0a*cos(phi0a - phi0b) + 
                24*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                168*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*pow(d0a,3)*cos(phi0a - phi0b) + 
                432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 24*curva*curvb*d0b*cos(phi0a - phi0b) + 
                432*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
                64*pow(curvb,3)*d0a*d0b*cos(phi0a - phi0b) + 
                1152*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                448*curva*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                768*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                144*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
                1728*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                4320*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                2880*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                288*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a - phi0b) + 
                128*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a - phi0b) + 
                576*pow(curva,4)*curvb*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                3840*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                2560*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 4*curvb*cos(2*(phi0a - phi0b)) - 
                48*curva*curvb*d0a*cos(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*curvb*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*curvb*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,4)*curvb*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*d0b*cos(2*(phi0a - phi0b)) - 
                24*pow(curvb,2)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                288*curva*pow(curvb,2)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
                1056*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*curvb*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                32*pow(curvb,3)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                704*pow(curva,3)*curvb*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                384*curva*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                704*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1408*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 2*curva*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                24*curva*curvb*d0b*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*curvb*d0a*d0b*cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 2*curva*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                168*curva*pow(curvb,2)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                24*curva*curvb*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*curvb*d0a*d0b*cos(3*phi0a - phi0b) - 
                64*pow(curvb,3)*d0a*d0b*cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                448*curva*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) + 2*curvb*cos(2*phi0b) + 
                16*curva*curvb*d0a*cos(2*phi0b) + 
                80*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0b) + 
                128*pow(curva,3)*curvb*pow(d0a,3)*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*d0b*cos(2*phi0b) + 
                12*pow(curvb,2)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*d0a*d0b*cos(2*phi0b) + 
                96*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*pow(d0a,2)*d0b*cos(2*phi0b) + 
                480*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                768*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 
                144*pow(curva,2)*curvb*pow(d0b,2)*cos(2*phi0b) + 
                16*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
                640*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(2*phi0b) + 
                128*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                640*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 96*pow(curva,4)*pow(d0b,3)*cos(2*phi0b) + 
                384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
                1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                416*pow(curva,4)*curvb*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                576*pow(curva,4)*pow(curvb,2)*pow(d0b,5)*cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,3)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*cos(phi0a + phi0b) - 
                24*pow(curva,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                96*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*pow(d0a,3)*cos(phi0a + phi0b) - 
                384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
                480*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                256*curva*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                1024*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                72*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                720*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                1728*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                1152*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a + phi0b) - 
                64*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a + phi0b) - 
                512*pow(curva,4)*curvb*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                640*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (2*(2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                (2*pow(curva,2) + 2*pow(curvb,2) - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                  64*pow(curva,3)*curvb*d0a*d0b - 
                  64*curva*pow(curvb,3)*d0a*d0b - 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                  320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) - 
                  320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,2) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                   pow(d0b,2) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
                   pow(d0b,2) - 
                  64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,3) - 
                  32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,4) + 
                  pow(1 + 2*curva*d0a,2)*
                   (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*d0a*
                      (1 + 4*curvb*d0b + 
                        2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                     pow(curva,2)*
                      (1 + 8*curvb*d0b + 
                        64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                        8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                        16*pow(curvb,4)*
                         (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                           2*pow(d0b,4))))*cos(2*phi0a) - 
                  2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                   (4*pow(curva,2)*d0b + 
                     curvb*(1 + 4*curva*d0a + 
                        4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                   cos(phi0a - 3*phi0b) + 
                  pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                  8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - 2*phi0b)) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(4*phi0a - 2*phi0b) + 
                  16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) - 
                  2*curva*curvb*cos(phi0a - phi0b) + 
                  12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                  8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                  48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                  32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a - phi0b) + 
                  8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                  12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                  16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a - phi0b) + 
                  16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a - phi0b) + 
                  56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                  48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                  112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,2)*cos(phi0a - phi0b) + 
                  960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                  288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a - phi0b) - 
                  2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                  2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                  24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*(phi0a - phi0b)) - 
                  24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) + 
                  2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                  12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                  24*pow(curva,3)*curvb*pow(d0a,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*pow(curva,4)*curvb*pow(d0a,3)*
                   cos(3*(phi0a - phi0b)) + 
                  12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  24*curva*pow(curvb,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*curva*pow(curvb,4)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) - 
                  2*curva*curvb*cos(3*phi0a - phi0b) - 
                  12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                  8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(3*phi0a - phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(3*phi0a - phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(3*phi0a - phi0b) - 
                  12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*phi0a - phi0b) - 
                  16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(3*phi0a - phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                  pow(curvb,2)*cos(2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                  40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*phi0b) + 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*phi0b) + 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*phi0b) + 8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                  64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*phi0b) + 
                  16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                  72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                   cos(2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                   cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                  32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a + phi0b) - 
                  80*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a + phi0b) - 
                  32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                  64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a + phi0b)))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
                (2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (8*sqrt(2)*pow(curva,2)*curvb*d0b*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (4*sqrt(2)*pow(curva,2)*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                     pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
                  2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) - 
             (4*sqrt(2)*pow(curva,2)*curvb*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,4)*pow(curvb,4)) - 
                  ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                       16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                       32*curva*d0a*d0b + 
                       32*pow(curva,2)*pow(d0a,2)*d0b + 
                       8*curvb*pow(d0b,2) + 
                       64*curva*curvb*d0a*pow(d0b,2) + 
                       64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                       16*pow(curva,2)*pow(d0b,3) + 
                       16*pow(curva,2)*curvb*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                        cos(phi0a - phi0b) - 
                       16*(1 + 2*curva*d0a)*d0b*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)) + 
                  (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,5))))/
              ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) - 
             (sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,4)*pow(curvb,4)) - 
                  ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                       16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                       32*curva*d0a*d0b + 
                       32*pow(curva,2)*pow(d0a,2)*d0b + 
                       8*curvb*pow(d0b,2) + 
                       64*curva*curvb*d0a*pow(d0b,2) + 
                       64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                       16*pow(curva,2)*pow(d0b,3) + 
                       16*pow(curva,2)*curvb*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                        cos(phi0a - phi0b) - 
                       16*(1 + 2*curva*d0a)*d0b*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)) + 
                  (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,5))))/
              (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))))/
         (2.*sqrt(4/pow(curvb,2) - 
             (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,2) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*pow(curva,2) + 2*pow(curvb,2) - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                64*pow(curva,3)*curvb*d0a*d0b - 
                64*curva*pow(curvb,3)*d0a*d0b - 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
                32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (1 + 8*curvb*d0b + 
                      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      16*pow(curvb,4)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 
                2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 
                2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 
                2*curva*curvb*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                pow(curvb,2)*cos(2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 
                96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*curvb*cos(phi0a + phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2))))/(4.*curvb) );

   double dydd0a( ((4*curva*pow(curvb,2) + 
          8*pow(curva,2)*pow(curvb,2)*d0a - 
          4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (-2*pow(curva,2)*cos(phi0a) - 
        4*pow(curvb,2)*cos(phi0a) - 
        24*curva*pow(curvb,2)*d0a*cos(phi0a) - 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
        2*pow(curva,2)*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0b*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        4*curva*curvb*cos(2*phi0a - phi0b) + 
        8*pow(curva,2)*curvb*d0a*cos(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydphi0a( (curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
        sin(phi0a - phi0b)*(-(curva*cos(phi0a)) - 
          2*pow(curva,2)*d0a*cos(phi0a) - 4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (curva*sin(phi0a) + 2*pow(curva,2)*d0a*sin(phi0a) + 
        4*pow(curvb,2)*d0a*sin(phi0a) + 
        12*curva*pow(curvb,2)*pow(d0a,2)*sin(phi0a) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*sin(phi0a) - 
        curva*sin(phi0a - 2*phi0b) - 
        2*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) - 
        4*curva*curvb*d0b*sin(phi0a - 2*phi0b) - 
        8*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) - 
        4*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) - 2*curvb*sin(2*phi0a - phi0b) - 
        8*curva*curvb*d0a*sin(2*phi0a - phi0b) - 
        8*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) - 
        4*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) - 
        16*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurva( ((4*pow(curvb,2)*d0a + 
          2*curva*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
          2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (-cos(phi0a) - 4*curva*d0a*cos(phi0a) - 
        12*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
        16*curva*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
        cos(phi0a - 2*phi0b) + 4*curva*d0a*cos(phi0a - 2*phi0b) + 
        4*curvb*d0b*cos(phi0a - 2*phi0b) + 
        16*curva*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
        4*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        16*curva*pow(curvb,2)*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        4*curvb*d0a*cos(2*phi0a - phi0b) + 
        8*curva*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        8*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        16*curva*pow(curvb,2)*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) - 
        8*curva*d0b*cos(phi0b) - 24*curva*curvb*pow(d0b,2)*cos(phi0b) - 
        16*curva*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*curva*pow(curvb,2)*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydd0b( ((pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
          4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (4*curva*curvb*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0a*cos(phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*d0b*cos(phi0a - 2*phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - 2*phi0b) + 
        2*pow(curvb,2)*cos(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0a - phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0a - phi0b) - 
        4*pow(curva,2)*cos(phi0b) - 2*pow(curvb,2)*cos(phi0b) - 
        24*pow(curva,2)*curvb*d0b*cos(phi0b) - 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curvb + 32*curva*curvb*d0a + 
                  32*pow(curva,2)*curvb*pow(d0a,2) + 
                  16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                  64*curva*pow(curvb,2)*d0a*d0b + 
                  64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                  48*pow(curva,2)*curvb*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                  16*curvb*(1 + 2*curva*d0a)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
	 )) );
   double dydphi0b( -(curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
         sin(phi0a - phi0b)*(-(curva*cos(phi0a)) - 
           2*pow(curva,2)*d0a*cos(phi0a) - 
           4*pow(curvb,2)*d0a*cos(phi0a) - 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
           curva*cos(phi0a - 2*phi0b) + 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
           4*pow(curva,2)*d0b*cos(phi0b) - 
           2*pow(curvb,2)*d0b*cos(phi0b) - 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (2*curva*sin(phi0a - 2*phi0b) + 
        4*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) + 
        8*curva*curvb*d0b*sin(phi0a - 2*phi0b) + 
        16*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) + curvb*sin(2*phi0a - phi0b) + 
        4*curva*curvb*d0a*sin(2*phi0a - phi0b) + 
        4*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) + 
        2*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) + curvb*sin(phi0b) + 
        4*pow(curva,2)*d0b*sin(phi0b) + 2*pow(curvb,2)*d0b*sin(phi0b) + 
        12*pow(curva,2)*curvb*pow(d0b,2)*sin(phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*sin(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((2*(1 + 2*curvb*d0b)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*cos(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,4)) - 
             ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) + 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurvb( ((2*curvb + 8*curva*curvb*d0a + 
          pow(curva,2)*(4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
          4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
          2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (-8*curvb*d0a*cos(phi0a) - 
        24*curva*curvb*pow(d0a,2)*cos(phi0a) - 
        16*pow(curva,2)*curvb*pow(d0a,3)*cos(phi0a) + 
        4*curva*d0b*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*d0a*d0b*cos(phi0a - 2*phi0b) + 
        8*curva*curvb*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        16*pow(curva,2)*curvb*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        cos(2*phi0a - phi0b) + 4*curva*d0a*cos(2*phi0a - phi0b) + 
        4*pow(curva,2)*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        4*curvb*d0b*cos(2*phi0a - phi0b) + 
        16*curva*curvb*d0a*d0b*cos(2*phi0a - phi0b) + 
        16*pow(curva,2)*curvb*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) - 
        cos(phi0b) - 4*curvb*d0b*cos(phi0b) - 
        12*pow(curva,2)*pow(d0b,2)*cos(phi0b) - 
        16*pow(curva,2)*curvb*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*pow(curva,2)*curvb*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                  16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                  32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                  8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                  64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                  16*pow(curva,2)*pow(d0b,3) + 
                  16*pow(curva,2)*curvb*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                   cos(phi0a - phi0b) - 
                  16*(1 + 2*curva*d0a)*d0b*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,5))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );

   ex = sqrt( ed0ad0a * sqr( dxdd0a ) +
	      ephi0aphi0a * sqr( dxdphi0a ) +
	      ecurvacurva * sqr( dxdcurva ) +
	      2 * ed0acurva * dxdd0a * dxdcurva +
	      2 * ed0aphi0a * dxdd0a * dxdphi0a +
	      2 * ecurvaphi0a * dxdcurva * dxdphi0a +
	      ed0bd0b * sqr( dxdd0b ) +
	      ephi0bphi0b * sqr( dxdphi0b ) +
	      ecurvbcurvb * sqr( dxdcurvb ) +
	      2 * ed0bcurvb * dxdd0b * dxdcurvb +
	      2 * ed0bphi0b * dxdd0b * dxdphi0b +
	      2 * ecurvbphi0b * dxdcurvb * dxdphi0b );

   ey = sqrt( ed0ad0a * sqr( dydd0a ) +
	      ephi0aphi0a * sqr( dydphi0a ) +
	      ecurvacurva * sqr( dydcurva ) +
	      2 * ed0acurva * dydd0a * dydcurva +
	      2 * ed0aphi0a * dydd0a * dydphi0a +
	      2 * ecurvaphi0a * dydcurva * dydphi0a +
	      ed0bd0b * sqr( dydd0b ) +
	      ephi0bphi0b * sqr( dydphi0b ) +
	      ecurvbcurvb * sqr( dydcurvb ) +
	      2 * ed0bcurvb * dydd0b * dydcurvb +
	      2 * ed0bphi0b * dydd0b * dydphi0b +
	      2 * ecurvbphi0b * dydcurvb * dydphi0b );

   return true;
}

DABoolean BigNTuple::sol2( KTHelix& a, KTHelix& b, double& x, double& y )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double sqrtarg1( 4/pow(curvb,2) - (4*pow(1 + 2*curvb*d0b,2)*
        pow(cos(phi0b),2))/pow(curvb,2) - 
     (4*(1 + 2*curvb*d0b)*cos(phi0b)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
      (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) - (2*pow(curva,2) + 2*pow(curvb,2) - 
        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
        64*pow(curva,3)*curvb*d0a*d0b - 64*curva*pow(curvb,3)*d0a*d0b - 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
        320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
        32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
        64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
        320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
        64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
        32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
        pow(1 + 2*curva*d0a,2)*
         (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*d0a*
            (1 + 4*curvb*d0b + 2*pow(curvb,2)*
               (pow(d0a,2) + 2*pow(d0b,2))) + 
           pow(curva,2)*(1 + 8*curvb*d0b + 
              64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
              8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
              16*pow(curvb,4)*
               (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))))
          *cos(2*phi0a) - 2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
         (4*pow(curva,2)*d0b + 
           curvb*(1 + 4*curva*d0a + 
              4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
         cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
        4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
        4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
        8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + 
        64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
         cos(4*phi0a - 2*phi0b) + 
        32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
         cos(4*phi0a - 2*phi0b) + 
        16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
         cos(4*phi0a - 2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
        96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
        96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) + 
        128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
        12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
        8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
        48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
        32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a - phi0b) + 
        8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
        12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
        16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
        216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
        16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
        576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a - phi0b) + 112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a - phi0b) + 384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a - phi0b) + 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a - phi0b) + 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a - phi0b) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a - phi0b) + 56*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a - phi0b) + 48*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a - phi0b) + 112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a - phi0b) + 576*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a - phi0b) + 
        1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a - phi0b) + 960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a - phi0b) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
        32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
        288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a - phi0b) + 384*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a - phi0b) + 
        960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a - phi0b) + 640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a - phi0b) + 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a - phi0b) + 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a - phi0b) + 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a - phi0b) - 
        2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
        2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
        8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
        24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
        8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
         cos(2*(phi0a - phi0b)) - 
        24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
        96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
        96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
        12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
        12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*(phi0a - phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*(phi0a - phi0b)) + 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
        12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
        8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(3*phi0a - phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(3*phi0a - phi0b) - 
        12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
        16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*phi0a - phi0b) - 
        112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(3*phi0a - phi0b) - 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
        pow(curvb,2)*cos(2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
        40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
        8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(2*phi0b) + 
        64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
        160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
        16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
        72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,2)*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
         pow(d0b,2)*cos(2*phi0b) + 
        96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
         cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,4)*cos(2*phi0b) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
        4*curva*curvb*cos(phi0a + phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
        32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a + phi0b) - 
        80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
        240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a + phi0b) - 
        256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a + phi0b) - 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a + phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a + phi0b) - 32*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a + phi0b) - 24*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a + phi0b) - 64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a + phi0b) - 240*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a + phi0b) - 384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
        256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a + phi0b) - 160*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a + phi0b) - 256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a + phi0b) - 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a + phi0b) - 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a + phi0b))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) + (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))\
      + (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) );
   double sqrtarg2( -(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
           8*pow(curvb,2)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*pow(d0a,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
           32*curva*curvb*d0a*d0b + 
           32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
           8*pow(curva,2)*pow(d0b,2) + 4*pow(curvb,2)*pow(d0b,2) + 
           32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
           32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
           16*pow(curva,2)*curvb*pow(d0b,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
           8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            (curva*d0b + curvb*
               (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
            cos(phi0a - phi0b) + 
           pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
            cos(2*(phi0a - phi0b)))*
         pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
           curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
       (pow(curva,4)*pow(curvb,4))) );

   if ( sqrtarg1 < 0.  ||  sqrtarg2 < 0. ) return false;

   x = -(curvb*sqrt(sqrtarg1) + 2*sin(phi0b) + 4*curvb*d0b*sin(phi0b))/(4.*curvb);
   y = (sqrt(2)*pow(curva,2)*pow(curvb,2)*sqrt(sqrtarg2) + 
       curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
       4*pow(curvb,2)*d0a*cos(phi0a) + 
       12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
       8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
       curva*cos(phi0a - 2*phi0b) - 
       2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
       4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
       8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
       4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
       8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
        cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
       4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
       4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
       2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
       8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
       8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
        cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
       4*pow(curva,2)*d0b*cos(phi0b) + 2*pow(curvb,2)*d0b*cos(phi0b) + 
       12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
       8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b))/
     (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
         pow(curva,2)*(1 + 4*curvb*d0b + 
            4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
         2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
       );

   return true;
}

DABoolean BigNTuple::errsol2( KTHelix& a, KTHelix& b, double& ex, double& ey )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double ed0ad0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0acurva( a.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0aphi0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvacurva( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvaphi0a( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0aphi0a( a.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double ed0bd0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0bcurvb( b.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0bphi0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvbcurvb( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvbphi0b( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0bphi0b( b.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double dxdd0a( -((-4*(1 + 2*curvb*d0b)*
           (-((1 + 2*curva*d0a)*
                (4*pow(curvb,2) + 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
             2*curva*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
           cos(phi0b))/
         (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))) + 
        (4*(1 + 2*curvb*d0b)*(4*curva*pow(curvb,2) + 
             8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
         (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)) - 
        (-64*pow(curva,2)*pow(curvb,2)*d0a - 
           192*pow(curva,3)*pow(curvb,2)*pow(d0a,2) - 
           128*pow(curva,4)*pow(curvb,2)*pow(d0a,3) - 
           64*pow(curva,3)*curvb*d0b - 64*curva*pow(curvb,3)*d0b - 
           128*pow(curva,4)*curvb*d0a*d0b - 
           640*pow(curva,2)*pow(curvb,3)*d0a*d0b - 
           1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b - 
           1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b - 
           320*pow(curva,3)*pow(curvb,2)*pow(d0b,2) - 
           64*curva*pow(curvb,4)*pow(d0b,2) - 
           640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2) - 
           640*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2) - 
           1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
           1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
           512*pow(curva,3)*pow(curvb,3)*pow(d0b,3) - 
           1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3) - 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,4) - 
           512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4) + 
           pow(1 + 2*curva*d0a,2)*
            (32*pow(curvb,4)*d0a + 64*curva*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(32*pow(curvb,2)*d0a + 
                 128*pow(curvb,3)*d0a*d0b + 
                 16*pow(curvb,4)*(4*pow(d0a,3) + 8*d0a*pow(d0b,2))))*
            cos(2*phi0a) + 4*curva*(1 + 2*curva*d0a)*
            (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*cos(2*phi0a) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(4*curva + 8*pow(curva,2)*d0a)*
            pow(1 + 2*curvb*d0b,3)*cos(phi0a - 3*phi0b) - 
           4*pow(curva,2)*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) + 
           4*pow(curva,3)*cos(2*(phi0a - 2*phi0b)) + 
           8*pow(curva,4)*d0a*cos(2*(phi0a - 2*phi0b)) + 
           32*pow(curva,3)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
           64*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
           96*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           192*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           128*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           256*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           64*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           8*curva*pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
           48*pow(curva,2)*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
           96*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
            cos(4*phi0a - 2*phi0b) + 
           64*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
            cos(4*phi0a - 2*phi0b) + 
           32*curva*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
           192*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           32*curva*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
           192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           12*pow(curva,2)*curvb*cos(phi0a - phi0b) + 
           8*pow(curvb,3)*cos(phi0a - phi0b) + 
           96*pow(curva,3)*curvb*d0a*cos(phi0a - phi0b) + 
           112*curva*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
           96*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
            cos(phi0a - phi0b) + 
           640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
            cos(phi0a - phi0b) + 
           320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a - phi0b) + 16*pow(curva,4)*d0b*cos(phi0a - phi0b) + 
           216*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
           16*pow(curvb,4)*d0b*cos(phi0a - phi0b) + 
           1152*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
           224*curva*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
           1152*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a - phi0b) + 
           864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
            cos(phi0a - phi0b) + 
           1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
            cos(phi0a - phi0b) + 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a - phi0b) + 
           112*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
           576*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           2880*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           2880*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           288*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           384*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           1920*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           1920*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a - phi0b) + 
           128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*
            cos(phi0a - phi0b) - 8*pow(curva,3)*cos(2*(phi0a - phi0b)) - 
           24*curva*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
           16*pow(curva,4)*d0a*cos(2*(phi0a - phi0b)) - 
           176*pow(curva,2)*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
            cos(2*(phi0a - phi0b)) - 
           256*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
            cos(2*(phi0a - phi0b)) - 
           96*pow(curva,3)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
           96*curva*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
           192*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           704*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(2*(phi0a - phi0b)) - 
           352*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           96*curva*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
           704*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           704*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) - 
           512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) + 
           12*pow(curva,2)*curvb*cos(3*(phi0a - phi0b)) + 
           48*pow(curva,3)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
           48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
           72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
           288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*(phi0a - phi0b)) + 
           144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) + 
           384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) + 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) - 
           12*pow(curva,2)*curvb*cos(3*phi0a - phi0b) - 
           8*pow(curvb,3)*cos(3*phi0a - phi0b) - 
           48*pow(curva,3)*curvb*d0a*cos(3*phi0a - phi0b) - 
           112*curva*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
           48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
           432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
            cos(3*phi0a - phi0b) - 
           640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
            cos(3*phi0a - phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
            cos(3*phi0a - phi0b) - 
           72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
           16*pow(curvb,4)*d0b*cos(3*phi0a - phi0b) - 
           288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
           224*curva*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*phi0a - phi0b) - 
           864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
            cos(3*phi0a - phi0b) - 
           1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
            cos(3*phi0a - phi0b) - 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(3*phi0a - phi0b) - 
           144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 
           384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*phi0a - phi0b) + 8*curva*pow(curvb,2)*cos(2*phi0b) + 
           80*pow(curva,2)*pow(curvb,2)*d0a*cos(2*phi0b) + 
           192*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
           128*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
           64*pow(curva,3)*curvb*d0b*cos(2*phi0b) + 
           32*curva*pow(curvb,3)*d0b*cos(2*phi0b) + 
           128*pow(curva,4)*curvb*d0a*d0b*cos(2*phi0b) + 
           320*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
           768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
           512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
           320*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
           32*curva*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
           640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           320*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           768*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*phi0b) + 512*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
            pow(d0b,2)*cos(2*phi0b) + 
           512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
           1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
           512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*cos(2*phi0b) - 
           48*pow(curva,3)*curvb*d0a*cos(phi0a + phi0b) - 
           64*curva*pow(curvb,3)*d0a*cos(phi0a + phi0b) - 
           48*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
           384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
            cos(phi0a + phi0b) - 
           640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
            cos(phi0a + phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a + phi0b) - 
           80*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a + phi0b) - 
           480*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
           128*curva*pow(curvb,4)*d0a*d0b*cos(phi0a + phi0b) - 
           480*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a + phi0b) - 
           768*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
            cos(phi0a + phi0b) - 
           1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
            cos(phi0a + phi0b) - 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a + phi0b) - 
           64*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
           240*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           1152*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           1152*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           256*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           160*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           768*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           768*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a + phi0b) - 
           128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(phi0a + phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (2*(4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b)))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) + 
        (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (4*pow(curvb,2) + 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
             2*curva*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
           (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                   4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
             4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) + 
        (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) + 
        (sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) + 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) + 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdphi0a( -((8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
           cos(phi0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sin(phi0a - phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
           (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b))*sin(phi0a - phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (4*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
             (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b)) - 
                2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b))))/
         (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))) - 
        (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
           pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
           (1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sin(phi0a - phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                   4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) + 
        (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
             (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b)) - 
                2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) + 
        (sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) - 
        (-2*pow(1 + 2*curva*d0a,2)*
            (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*sin(2*phi0a) + 
           2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            sin(phi0a - 3*phi0b) - 
           2*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) - 
           8*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) - 
           8*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) - 
           16*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) - 
           64*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) - 
           64*pow(curva,4)*curvb*pow(d0a,2)*d0b*
            sin(2*(phi0a - 2*phi0b)) - 
           48*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
            sin(2*(phi0a - 2*phi0b)) - 
           192*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
            sin(2*(phi0a - 2*phi0b)) - 
           192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            sin(2*(phi0a - 2*phi0b)) - 
           64*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
            sin(2*(phi0a - 2*phi0b)) - 
           256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
            sin(2*(phi0a - 2*phi0b)) - 
           256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            sin(2*(phi0a - 2*phi0b)) - 
           32*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
            sin(2*(phi0a - 2*phi0b)) - 
           128*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
            sin(2*(phi0a - 2*phi0b)) - 
           128*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            sin(2*(phi0a - 2*phi0b)) - 
           4*pow(curvb,2)*sin(4*phi0a - 2*phi0b) - 
           32*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) - 
           96*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
            sin(4*phi0a - 2*phi0b) - 
           128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
            sin(4*phi0a - 2*phi0b) - 
           64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
            sin(4*phi0a - 2*phi0b) - 
           16*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) - 
           128*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) - 
           384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
            sin(4*phi0a - 2*phi0b) - 
           512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
            sin(4*phi0a - 2*phi0b) - 
           256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
            sin(4*phi0a - 2*phi0b) - 
           16*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
           128*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
           384*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            sin(4*phi0a - 2*phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            sin(4*phi0a - 2*phi0b) - 
           256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            sin(4*phi0a - 2*phi0b) + 2*curva*curvb*sin(phi0a - phi0b) - 
           12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) - 
           8*pow(curvb,3)*d0a*sin(phi0a - phi0b) - 
           48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) - 
           56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) - 
           32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) - 
           144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
            sin(phi0a - phi0b) - 
           160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
            sin(phi0a - phi0b) - 
           64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a - phi0b) - 
           8*pow(curva,3)*d0b*sin(phi0a - phi0b) - 
           12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) - 
           16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) - 
           216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a - phi0b) - 
           16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) - 
           576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(phi0a - phi0b) - 
           112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a - phi0b) - 
           384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(phi0a - phi0b) - 
           288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
            sin(phi0a - phi0b) - 
           320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
            sin(phi0a - phi0b) - 
           128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
            sin(phi0a - phi0b) - 
           56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) - 
           48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) - 
           112*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a - phi0b) - 
           576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(phi0a - phi0b) - 
           1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(phi0a - phi0b) - 
           960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(phi0a - phi0b) - 
           144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) - 
           288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(phi0a - phi0b) - 
           160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
            sin(phi0a - phi0b) - 
           320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
            sin(phi0a - phi0b) - 
           64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a - phi0b) - 
           128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
            sin(phi0a - phi0b) + 4*pow(curva,2)*sin(2*(phi0a - phi0b)) + 
           4*pow(curvb,2)*sin(2*(phi0a - phi0b)) + 
           16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) + 
           48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) + 
           16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) + 
           176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
            sin(2*(phi0a - phi0b)) + 
           256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
            sin(2*(phi0a - phi0b)) + 
           128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
            sin(2*(phi0a - phi0b)) + 
           48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) + 
           16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) + 
           192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) + 
           192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) + 
           192*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*(phi0a - phi0b)) + 
           704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
            sin(2*(phi0a - phi0b)) + 
           176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
           704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           192*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
           704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            sin(2*(phi0a - phi0b)) + 
           256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
            sin(2*(phi0a - phi0b)) + 
           1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            sin(2*(phi0a - phi0b)) + 
           128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
            sin(2*(phi0a - phi0b)) + 
           512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            sin(2*(phi0a - phi0b)) - 6*curva*curvb*sin(3*(phi0a - phi0b)) - 
           36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) - 
           72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) - 
           48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) - 
           36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) - 
           216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*(phi0a - phi0b)) - 
           432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(3*(phi0a - phi0b)) - 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(3*(phi0a - phi0b)) - 
           72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) - 
           432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(3*(phi0a - phi0b)) - 
           864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(3*(phi0a - phi0b)) - 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(3*(phi0a - phi0b)) - 
           48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) - 
           288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(3*(phi0a - phi0b)) - 
           576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(3*(phi0a - phi0b)) - 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(3*(phi0a - phi0b)) + 6*curva*curvb*sin(3*phi0a - phi0b) + 
           36*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) + 
           24*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) + 
           72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) + 
           168*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) + 
           48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
            sin(3*phi0a - phi0b) + 
           480*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
            sin(3*phi0a - phi0b) + 
           192*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
            sin(3*phi0a - phi0b) + 
           36*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) + 
           216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*phi0a - phi0b) + 
           48*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) + 
           432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(3*phi0a - phi0b) + 
           336*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(3*phi0a - phi0b) + 
           288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(3*phi0a - phi0b) + 
           864*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
            sin(3*phi0a - phi0b) + 
           960*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
            sin(3*phi0a - phi0b) + 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
            sin(3*phi0a - phi0b) + 
           72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(3*phi0a - phi0b) + 
           864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(3*phi0a - phi0b) + 
           576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(3*phi0a - phi0b) + 
           48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) + 
           288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(3*phi0a - phi0b) + 
           576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(3*phi0a - phi0b) + 
           384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(3*phi0a - phi0b) - 4*curva*curvb*sin(phi0a + phi0b) + 
           24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
           32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
           16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
           128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
            sin(phi0a + phi0b) + 
           160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
            sin(phi0a + phi0b) + 
           64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a + phi0b) + 
           80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
           240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
            sin(phi0a + phi0b) + 
           64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
           160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
            sin(phi0a + phi0b) + 
           256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
            sin(phi0a + phi0b) + 
           320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
            sin(phi0a + phi0b) + 
           128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
            sin(phi0a + phi0b) + 
           32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
           24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
           64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
           240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
            sin(phi0a + phi0b) + 
           576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            sin(phi0a + phi0b) + 
           384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            sin(phi0a + phi0b) + 
           128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
           256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            sin(phi0a + phi0b) + 
           160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
            sin(phi0a + phi0b) + 
           320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
            sin(phi0a + phi0b) + 
           64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a + phi0b) + 
           128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
            sin(phi0a + phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) + 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) + 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdcurva( -((-4*(1 + 2*curvb*d0b)*cos(phi0b)*
           (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
                cos(phi0a)) - 2*d0a*
              (curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
                4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
                (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b))))/
         (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))) + 
        (4*(1 + 2*curvb*d0b)*(4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*(-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
         (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)) - 
        (4*curva - 64*curva*pow(curvb,2)*pow(d0a,2) - 
           192*pow(curva,2)*pow(curvb,2)*pow(d0a,3) - 
           128*pow(curva,3)*pow(curvb,2)*pow(d0a,4) - 
           192*pow(curva,2)*curvb*d0a*d0b - 64*pow(curvb,3)*d0a*d0b - 
           256*pow(curva,3)*curvb*pow(d0a,2)*d0b - 
           640*curva*pow(curvb,3)*pow(d0a,2)*d0b - 
           1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b - 
           1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b - 
           64*curva*pow(curvb,2)*pow(d0b,2) - 
           960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
           64*pow(curvb,4)*d0a*pow(d0b,2) - 
           1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
           640*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
           1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
           128*curva*pow(curvb,3)*pow(d0b,3) - 
           1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3) - 
           2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
           64*curva*pow(curvb,4)*pow(d0b,4) - 
           768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
           pow(1 + 2*curva*d0a,2)*
            (16*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              2*curva*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*cos(2*phi0a) + 
           4*d0a*(1 + 2*curva*d0a)*
            (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
              16*curva*pow(curvb,2)*d0a*
               (1 + 4*curvb*d0b + 
                 2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
              pow(curva,2)*(1 + 8*curvb*d0b + 
                 64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                 8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                 16*pow(curvb,4)*
                  (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                    2*pow(d0b,4))))*cos(2*phi0a) - 
           2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
            (8*curva*d0b + curvb*
               (4*d0a + 8*curva*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) - 
           4*curva*d0a*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) - 
           2*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
            (4*pow(curva,2)*d0b + 
              curvb*(1 + 4*curva*d0a + 
                 4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
            cos(phi0a - 3*phi0b) + 2*curva*cos(2*(phi0a - 2*phi0b)) + 
           12*pow(curva,2)*d0a*cos(2*(phi0a - 2*phi0b)) + 
           16*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
           16*curva*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
           96*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
           128*pow(curva,3)*curvb*pow(d0a,2)*d0b*
            cos(2*(phi0a - 2*phi0b)) + 
           48*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - 2*phi0b)) + 
           288*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - 2*phi0b)) + 
           64*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - 2*phi0b)) + 
           384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           512*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            cos(2*(phi0a - 2*phi0b)) + 
           32*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - 2*phi0b)) + 
           192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            cos(2*(phi0a - 2*phi0b)) + 
           8*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
           48*curva*pow(curvb,2)*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
           96*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
            cos(4*phi0a - 2*phi0b) + 
           64*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
            cos(4*phi0a - 2*phi0b) + 
           32*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
           192*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
            cos(4*phi0a - 2*phi0b) + 
           32*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
           192*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           384*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            cos(4*phi0a - 2*phi0b) - 2*curvb*cos(phi0a - phi0b) + 
           24*curva*curvb*d0a*cos(phi0a - phi0b) + 
           144*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
           56*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
           128*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
           288*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
           480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a - phi0b) + 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
            cos(phi0a - phi0b) + 24*pow(curva,2)*d0b*cos(phi0a - phi0b) + 
           12*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
           64*pow(curva,3)*d0a*d0b*cos(phi0a - phi0b) + 
           432*curva*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
           1728*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a - phi0b) + 
           112*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
           1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(phi0a - phi0b) + 
           576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a - phi0b) + 
           960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a - phi0b) + 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
            cos(phi0a - phi0b) + 
           168*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
           48*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
           448*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
           1152*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
           4320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           3840*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(phi0a - phi0b) + 
           432*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           32*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
           1152*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           768*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a - phi0b) + 
           2880*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           2560*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(phi0a - phi0b) + 
           480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a - phi0b) + 
           1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
            cos(phi0a - phi0b) + 
           192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*
            cos(phi0a - phi0b) + 
           512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
            cos(phi0a - phi0b) - 4*curva*cos(2*(phi0a - phi0b)) - 
           24*pow(curva,2)*d0a*cos(2*(phi0a - phi0b)) - 
           24*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
           32*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
           176*curva*pow(curvb,2)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
           384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
            cos(2*(phi0a - phi0b)) - 
           256*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
            cos(2*(phi0a - phi0b)) - 
           48*curva*curvb*d0b*cos(2*(phi0a - phi0b)) - 
           288*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           96*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
           384*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
           704*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
            cos(2*(phi0a - phi0b)) - 
           176*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
           1056*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           96*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
           1408*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           704*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            cos(2*(phi0a - phi0b)) - 
           256*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - phi0b)) - 
           1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            cos(2*(phi0a - phi0b)) - 
           128*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - phi0b)) - 
           768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
            cos(2*(phi0a - phi0b)) + 2*curvb*cos(3*(phi0a - phi0b)) + 
           24*curva*curvb*d0a*cos(3*(phi0a - phi0b)) + 
           72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
           64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
           12*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
           144*curva*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
           432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*(phi0a - phi0b)) + 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(3*(phi0a - phi0b)) + 
           24*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
           288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
           864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(3*(phi0a - phi0b)) + 
           16*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
           192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
           576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) + 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(3*(phi0a - phi0b)) - 2*curvb*cos(3*phi0a - phi0b) - 
           24*curva*curvb*d0a*cos(3*phi0a - phi0b) - 
           72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
           56*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
           64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
           288*curva*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
           480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
            cos(3*phi0a - phi0b) - 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
            cos(3*phi0a - phi0b) - 
           12*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
           144*curva*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
           432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(3*phi0a - phi0b) - 
           112*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
           384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(3*phi0a - phi0b) - 
           576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(3*phi0a - phi0b) - 
           960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(3*phi0a - phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
            cos(3*phi0a - phi0b) - 
           24*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
           288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*phi0a - phi0b) - 
           864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(3*phi0a - phi0b) - 
           16*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
           192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*phi0a - phi0b) - 
           576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(3*phi0a - phi0b) - 4*curva*cos(2*phi0b) + 
           8*pow(curvb,2)*d0a*cos(2*phi0b) + 
           80*curva*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
           192*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
           128*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
           16*curva*curvb*d0b*cos(2*phi0b) + 
           192*pow(curva,2)*curvb*d0a*d0b*cos(2*phi0b) + 
           32*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
           256*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
           320*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
           768*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
           512*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
           64*pow(curva,3)*pow(d0b,2)*cos(2*phi0b) + 
           144*curva*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
           960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           32*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
           1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
            cos(2*phi0b) + 320*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
            cos(2*phi0b) + 768*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
            pow(d0b,2)*cos(2*phi0b) + 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
            cos(2*phi0b) + 384*pow(curva,3)*curvb*pow(d0b,3)*
            cos(2*phi0b) + 256*curva*pow(curvb,3)*pow(d0b,3)*
            cos(2*phi0b) + 1536*pow(curva,2)*pow(curvb,3)*d0a*
            pow(d0b,3)*cos(2*phi0b) + 
           2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
            cos(2*phi0b) + 832*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
            cos(2*phi0b) + 128*curva*pow(curvb,4)*pow(d0b,4)*
            cos(2*phi0b) + 768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
            cos(2*phi0b) + 1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*
            pow(d0b,4)*cos(2*phi0b) + 
           768*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
           256*pow(curva,3)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
           4*curvb*cos(phi0a + phi0b) - 
           72*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
           32*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
           64*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
           256*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
           480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
            cos(phi0a + phi0b) - 
           256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
            cos(phi0a + phi0b) - 
           160*curva*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
           720*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(phi0a + phi0b) - 
           64*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
           640*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
            cos(phi0a + phi0b) - 
           512*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a + phi0b) - 
           960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
            cos(phi0a + phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
            cos(phi0a + phi0b) - 
           96*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
           24*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
           256*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
           480*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
           1728*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           1536*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
            cos(phi0a + phi0b) - 
           384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           16*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
           1024*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           320*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a + phi0b) - 
           1152*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
            cos(phi0a + phi0b) - 
           480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
            cos(phi0a + phi0b) - 
           1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
            cos(phi0a + phi0b) - 
           192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*
            cos(phi0a + phi0b) - 
           512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
            cos(phi0a + phi0b))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (2*(4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b)))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) - 
        (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
           (4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                   4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (8*sqrt(2)*curva*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b)) + 
        (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
                cos(phi0a)) - 2*d0a*
              (curva + 4*pow(curvb,2)*d0a + 
                4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
             (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
                4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
                (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) - 
        (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (4*pow(curvb,2)*d0a + 
             2*curva*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
             2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),3) + 
        (4*sqrt(2)*curva*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4)))))/
         pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
           pow(curva,2)*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            cos(phi0a - phi0b),2) + 
        (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b))*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))) + 
        (sqrt(2)*pow(curva,2)*pow(curvb,2)*
           (-((1 + 2*curva*d0a)*
                (curva + 4*pow(curvb,2)*d0a + 
                  4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
             (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - 2*phi0b) + 
                curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                (curvb + 4*pow(curva,2)*d0b + 
                   4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) + 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) + 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdd0b( -(4*curvb*sin(phi0b) + 
        (curvb*((-16*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/curvb - 
             (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((1 + 2*curvb*d0b)*
                   (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                     (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
                      cos(phi0b)) + 
                  2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (4*(1 + 2*curvb*d0b)*
                (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)) - 
             (8*cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (-64*pow(curva,3)*curvb*d0a - 64*curva*pow(curvb,3)*d0a - 
                64*pow(curva,4)*curvb*pow(d0a,2) - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4) - 
                64*pow(curva,2)*pow(curvb,2)*d0b - 
                640*pow(curva,3)*pow(curvb,2)*d0a*d0b - 
                128*curva*pow(curvb,4)*d0a*d0b - 
                640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b - 
                640*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b - 
                1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b - 
                192*pow(curva,2)*pow(curvb,3)*pow(d0b,2) - 
                1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2) - 
                1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                 pow(d0b,2) - 
                128*pow(curva,2)*pow(curvb,4)*pow(d0b,3) - 
                1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3) - 
                1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                 pow(d0b,3) + 
                pow(1 + 2*curva*d0a,2)*
                 (16*curva*pow(curvb,2)*d0a*
                    (4*curvb + 8*pow(curvb,2)*d0b) + 
                   pow(curva,2)*
                    (8*curvb + 80*pow(curvb,2)*d0b + 
                      128*pow(curvb,3)*pow(d0b,2) + 
                      64*pow(curvb,3)*(pow(d0a,2) + pow(d0b,2)) + 
                      16*pow(curvb,4)*(8*pow(d0a,2)*d0b + 8*pow(d0b,3)))
                   )*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
                 cos(phi0a - 3*phi0b) - 
                12*curva*curvb*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                8*pow(curva,2)*curvb*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                48*pow(curva,2)*pow(curvb,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,3)*pow(curvb,2)*d0a*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curvb,3)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                8*pow(curvb,4)*d0b*cos(4*phi0a - 2*phi0b) + 
                64*curva*pow(curvb,4)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                8*pow(curva,3)*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                112*pow(curva,3)*curvb*d0b*cos(phi0a - phi0b) + 
                96*curva*pow(curvb,3)*d0b*cos(phi0a - phi0b) + 
                224*pow(curva,4)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
                1152*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                2880*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                1920*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                432*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                96*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a - phi0b) + 
                864*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1152*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                2880*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1920*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) - 
                24*pow(curva,2)*curvb*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*pow(curvb,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                16*pow(curvb,4)*d0b*cos(2*(phi0a - phi0b)) - 
                704*pow(curva,3)*pow(curvb,2)*d0a*d0b*
                 cos(2*(phi0a - phi0b)) - 
                192*curva*pow(curvb,4)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(3*(phi0a - phi0b)) + 
                48*curva*pow(curvb,3)*d0b*cos(3*(phi0a - phi0b)) + 
                288*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) - 
                12*curva*pow(curvb,2)*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                48*curva*pow(curvb,3)*d0b*cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) + 8*pow(curva,2)*curvb*cos(2*phi0b) + 
                4*pow(curvb,3)*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(2*phi0b) + 
                32*pow(curva,4)*d0b*cos(2*phi0b) + 
                144*pow(curva,2)*pow(curvb,2)*d0b*cos(2*phi0b) + 
                8*pow(curvb,4)*d0b*cos(2*phi0b) + 
                640*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
                64*curva*pow(curvb,4)*d0a*d0b*cos(2*phi0b) + 
                640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 
                288*pow(curva,4)*curvb*pow(d0b,2)*cos(2*phi0b) + 
                384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
                1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                832*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
                256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(2*phi0b) + 
                1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
                384*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(2*phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*curvb*d0b*cos(phi0a + phi0b) - 
                48*curva*pow(curvb,3)*d0b*cos(phi0a + phi0b) - 
                128*pow(curva,4)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
                480*pow(curva,2)*pow(curvb,3)*d0a*d0b*
                 cos(phi0a + phi0b) - 
                1152*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                768*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                48*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a + phi0b) - 
                768*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                480*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                1152*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                768*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (2*(pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *(2*pow(curva,2) + 2*pow(curvb,2) - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                  64*pow(curva,3)*curvb*d0a*d0b - 
                  64*curva*pow(curvb,3)*d0a*d0b - 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                  320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) - 
                  320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,2) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                   pow(d0b,2) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
                   pow(d0b,2) - 
                  64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,3) - 
                  32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,4) + 
                  pow(1 + 2*curva*d0a,2)*
                   (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*d0a*
                      (1 + 4*curvb*d0b + 
                        2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                     pow(curva,2)*
                      (1 + 8*curvb*d0b + 
                        64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                        8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                        16*pow(curvb,4)*
                         (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                           2*pow(d0b,4))))*cos(2*phi0a) - 
                  2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                   (4*pow(curva,2)*d0b + 
                     curvb*(1 + 4*curva*d0a + 
                        4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                   cos(phi0a - 3*phi0b) + 
                  pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                  8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - 2*phi0b)) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(4*phi0a - 2*phi0b) + 
                  16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) - 
                  2*curva*curvb*cos(phi0a - phi0b) + 
                  12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                  8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                  48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                  32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a - phi0b) + 
                  8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                  12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                  16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a - phi0b) + 
                  16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a - phi0b) + 
                  56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                  48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                  112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,2)*cos(phi0a - phi0b) + 
                  960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                  288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a - phi0b) - 
                  2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                  2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                  24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*(phi0a - phi0b)) - 
                  24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) + 
                  2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                  12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                  24*pow(curva,3)*curvb*pow(d0a,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*pow(curva,4)*curvb*pow(d0a,3)*
                   cos(3*(phi0a - phi0b)) + 
                  12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  24*curva*pow(curvb,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*curva*pow(curvb,4)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) - 
                  2*curva*curvb*cos(3*phi0a - phi0b) - 
                  12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                  8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(3*phi0a - phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(3*phi0a - phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(3*phi0a - phi0b) - 
                  12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*phi0a - phi0b) - 
                  16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(3*phi0a - phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                  pow(curvb,2)*cos(2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                  40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*phi0b) + 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*phi0b) + 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*phi0b) + 8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                  64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*phi0b) + 
                  16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                  72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                   cos(2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                   cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                  32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a + phi0b) - 
                  80*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a + phi0b) - 
                  32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                  64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a + phi0b)))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) - 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
                (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                        4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (8*sqrt(2)*pow(curva,2)*pow(curvb,2)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) + 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                ((1 + 2*curvb*d0b)*
                   (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                     (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
                      cos(phi0b)) + 
                  2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
                  4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))
                 *(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*sin(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,3)) - 
                  ((4*curvb + 32*curva*curvb*d0a + 
                       32*pow(curva,2)*curvb*pow(d0a,2) + 
                       16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                       64*curva*pow(curvb,2)*d0a*d0b + 
                       64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                       48*pow(curva,2)*curvb*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                       16*curvb*(1 + 2*curva*d0a)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) + 
             (sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*sin(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,3)) - 
                  ((4*curvb + 32*curva*curvb*d0a + 
                       32*pow(curva,2)*curvb*pow(d0a,2) + 
                       16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                       64*curva*pow(curvb,2)*d0a*d0b + 
                       64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                       48*pow(curva,2)*curvb*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                       16*curvb*(1 + 2*curva*d0a)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))))/
         (2.*sqrt(4/pow(curvb,2) - 
             (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,2) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*pow(curva,2) + 2*pow(curvb,2) - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                64*pow(curva,3)*curvb*d0a*d0b - 
                64*curva*pow(curvb,3)*d0a*d0b - 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
                32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (1 + 8*curvb*d0b + 
                      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      16*pow(curvb,4)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 
                2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 
                2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 
                2*curva*curvb*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                pow(curvb,2)*cos(2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 
                96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*curvb*cos(phi0a + phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) + 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2))))/(4.*curvb) );
   double dxdphi0b( -(2*cos(phi0b) + 4*curvb*d0b*cos(phi0b) + 
        (curvb*((-8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sin(phi0a - phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                (2*pow(curva,2) + 2*pow(curvb,2) - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                  64*pow(curva,3)*curvb*d0a*d0b - 
                  64*curva*pow(curvb,3)*d0a*d0b - 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                  320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) - 
                  320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,2) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                   pow(d0b,2) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
                   pow(d0b,2) - 
                  64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,3) - 
                  32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,4) + 
                  pow(1 + 2*curva*d0a,2)*
                   (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*d0a*
                      (1 + 4*curvb*d0b + 
                        2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                     pow(curva,2)*
                      (1 + 8*curvb*d0b + 
                        64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                        8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                        16*pow(curvb,4)*
                         (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                           2*pow(d0b,4))))*cos(2*phi0a) - 
                  2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                   (4*pow(curva,2)*d0b + 
                     curvb*(1 + 4*curva*d0a + 
                        4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                   cos(phi0a - 3*phi0b) + 
                  pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                  8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - 2*phi0b)) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(4*phi0a - 2*phi0b) + 
                  16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) - 
                  2*curva*curvb*cos(phi0a - phi0b) + 
                  12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                  8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                  48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                  32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a - phi0b) + 
                  8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                  12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                  16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a - phi0b) + 
                  16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a - phi0b) + 
                  56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                  48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                  112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,2)*cos(phi0a - phi0b) + 
                  960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                  288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a - phi0b) - 
                  2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                  2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                  24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*(phi0a - phi0b)) - 
                  24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) + 
                  2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                  12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                  24*pow(curva,3)*curvb*pow(d0a,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*pow(curva,4)*curvb*pow(d0a,3)*
                   cos(3*(phi0a - phi0b)) + 
                  12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  24*curva*pow(curvb,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*curva*pow(curvb,4)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) - 
                  2*curva*curvb*cos(3*phi0a - phi0b) - 
                  12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                  8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(3*phi0a - phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(3*phi0a - phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(3*phi0a - phi0b) - 
                  12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*phi0a - phi0b) - 
                  16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(3*phi0a - phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                  pow(curvb,2)*cos(2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                  40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*phi0b) + 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*phi0b) + 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*phi0b) + 8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                  64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*phi0b) + 
                  16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                  72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                   cos(2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                   cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                  32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a + phi0b) - 
                  80*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a + phi0b) - 
                  32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                  64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a + phi0b))*sin(phi0a - phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (8*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0b))/
              pow(curvb,2) + (4*(1 + 2*curvb*d0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sin(phi0b))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
                pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
                (1 + 2*curvb*d0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sin(phi0a - phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) - 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*sin(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) - 
             (4*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*
                (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*(1 + 2*curvb*d0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))*
                (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   sin(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((2*(1 + 2*curvb*d0b)*
                     (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*cos(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,4)) - 
                  ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        sin(phi0a - phi0b) + 
                       2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        sin(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) + 
             (sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                ((2*(1 + 2*curvb*d0b)*
                     (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*cos(phi0b)*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,3)*pow(curvb,4)) - 
                  ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        sin(phi0a - phi0b) + 
                       2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        sin(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4))))/
              (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) - 
             (-6*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 sin(phi0a - 3*phi0b) + 
                4*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 sin(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 sin(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 sin(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 sin(2*(phi0a - 2*phi0b)) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 sin(2*(phi0a - 2*phi0b)) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 sin(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 sin(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 sin(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 sin(2*(phi0a - 2*phi0b)) + 
                2*pow(curvb,2)*sin(4*phi0a - 2*phi0b) + 
                16*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) + 
                48*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 sin(4*phi0a - 2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 sin(4*phi0a - 2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 sin(4*phi0a - 2*phi0b) + 
                8*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) + 
                64*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) + 
                192*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 sin(4*phi0a - 2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 sin(4*phi0a - 2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 sin(4*phi0a - 2*phi0b) + 
                8*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) + 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) + 
                192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 sin(4*phi0a - 2*phi0b) - 2*curva*curvb*sin(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*sin(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 sin(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 sin(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 sin(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*sin(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 sin(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 sin(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 sin(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 sin(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 sin(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 sin(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 sin(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 sin(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 sin(phi0a - phi0b) - 
                4*pow(curva,2)*sin(2*(phi0a - phi0b)) - 
                4*pow(curvb,2)*sin(2*(phi0a - phi0b)) - 
                16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) - 
                48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) - 
                16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 sin(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 sin(2*(phi0a - phi0b)) - 
                128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 sin(2*(phi0a - phi0b)) - 
                48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) - 
                16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) - 
                192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) - 
                192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) - 
                192*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 sin(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) - 
                704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                192*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 sin(2*(phi0a - phi0b)) - 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 sin(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 sin(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 sin(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 sin(2*(phi0a - phi0b)) + 
                6*curva*curvb*sin(3*(phi0a - phi0b)) + 
                36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) + 
                72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) + 
                48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) + 
                36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 sin(3*(phi0a - phi0b)) + 
                432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(3*(phi0a - phi0b)) + 
                288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(3*(phi0a - phi0b)) + 
                72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) + 
                432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(3*(phi0a - phi0b)) + 
                864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(3*(phi0a - phi0b)) + 
                576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(3*(phi0a - phi0b)) + 
                48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) + 
                288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(3*(phi0a - phi0b)) + 
                576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(3*(phi0a - phi0b)) + 
                384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(3*(phi0a - phi0b)) - 
                2*curva*curvb*sin(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 sin(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 sin(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 sin(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 sin(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 sin(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 sin(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 sin(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 sin(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(3*phi0a - phi0b) + 4*pow(curva,2)*sin(2*phi0b) - 
                2*pow(curvb,2)*sin(2*phi0b) - 
                16*curva*pow(curvb,2)*d0a*sin(2*phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*sin(2*phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*sin(2*phi0b) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*sin(2*phi0b) - 
                16*pow(curva,2)*curvb*d0b*sin(2*phi0b) - 
                8*pow(curvb,3)*d0b*sin(2*phi0b) - 
                128*pow(curva,3)*curvb*d0a*d0b*sin(2*phi0b) - 
                64*curva*pow(curvb,3)*d0a*d0b*sin(2*phi0b) - 
                128*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*phi0b) - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 sin(2*phi0b) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 sin(2*phi0b) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 sin(2*phi0b) - 32*pow(curva,4)*pow(d0b,2)*sin(2*phi0b) - 
                144*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*sin(2*phi0b) - 
                8*pow(curvb,4)*pow(d0b,2)*sin(2*phi0b) - 
                640*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 sin(2*phi0b) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(2*phi0b) - 
                640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*phi0b) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 sin(2*phi0b) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 sin(2*phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 sin(2*phi0b) - 
                192*pow(curva,4)*curvb*pow(d0b,3)*sin(2*phi0b) - 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*sin(2*phi0b) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 sin(2*phi0b) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 sin(2*phi0b) - 
                416*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*sin(2*phi0b) - 
                128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*sin(2*phi0b) - 
                512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 sin(2*phi0b) - 
                512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 sin(2*phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*sin(2*phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*sin(2*phi0b) - 
                4*curva*curvb*sin(phi0a + phi0b) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
                32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 sin(phi0a + phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 sin(phi0a + phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 sin(phi0a + phi0b) + 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 sin(phi0a + phi0b) + 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 sin(phi0a + phi0b) + 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 sin(phi0a + phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 sin(phi0a + phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 sin(phi0a + phi0b) + 
                32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 sin(phi0a + phi0b) + 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 sin(phi0a + phi0b) + 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 sin(phi0a + phi0b) + 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 sin(phi0a + phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 sin(phi0a + phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 sin(phi0a + phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 sin(phi0a + phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 sin(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2)))/
         (2.*sqrt(4/pow(curvb,2) - 
             (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,2) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*pow(curva,2) + 2*pow(curvb,2) - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                64*pow(curva,3)*curvb*d0a*d0b - 
                64*curva*pow(curvb,3)*d0a*d0b - 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
                32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (1 + 8*curvb*d0b + 
                      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      16*pow(curvb,4)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 
                2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 
                2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 
                2*curva*curvb*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                pow(curvb,2)*cos(2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 
                96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*curvb*cos(phi0a + phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) + 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2))))/(4.*curvb) );
   double dxdcurvb( (2*sin(phi0b) + 4*curvb*d0b*sin(phi0b) + 
        curvb*sqrt(4/pow(curvb,2) - 
           (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
           (4*(1 + 2*curvb*d0b)*cos(phi0b)*
              (-((1 + 2*curva*d0a)*
                   (curva + 4*pow(curvb,2)*d0a + 
                     4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                (1 + 2*curvb*d0b)*
                 (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    cos(phi0a - 2*phi0b) + 
                   curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                   (curvb + 4*pow(curva,2)*d0b + 
                      4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
            (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b))) - 
           (2*pow(curva,2) + 2*pow(curvb,2) - 
              32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
              64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
              32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
              64*pow(curva,3)*curvb*d0a*d0b - 
              64*curva*pow(curvb,3)*d0a*d0b - 
              64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
              320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
              512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
              256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
              32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
              320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
              64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
              320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
              320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
              512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
              64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
              512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
              512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
              32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
              256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
              pow(1 + 2*curva*d0a,2)*
               (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*d0a*
                  (1 + 4*curvb*d0b + 
                    2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                 pow(curva,2)*
                  (1 + 8*curvb*d0b + 
                    64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                    8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                    16*pow(curvb,4)*
                     (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                       2*pow(d0b,4))))*cos(2*phi0a) - 
              2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
               (4*pow(curva,2)*d0b + 
                 curvb*(1 + 4*curva*d0a + 
                    4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
               cos(phi0a - 3*phi0b) + 
              pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
              4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
              4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
              8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
              32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
              32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
               cos(2*(phi0a - 2*phi0b)) + 
              24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
               cos(2*(phi0a - 2*phi0b)) + 
              96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
               cos(2*(phi0a - 2*phi0b)) + 
              96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
               cos(2*(phi0a - 2*phi0b)) + 
              32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
               cos(2*(phi0a - 2*phi0b)) + 
              128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
               cos(2*(phi0a - 2*phi0b)) + 
              128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
               cos(2*(phi0a - 2*phi0b)) + 
              16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
               cos(2*(phi0a - 2*phi0b)) + 
              64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
               cos(2*(phi0a - 2*phi0b)) + 
              64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
               cos(2*(phi0a - 2*phi0b)) + 
              pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
              8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
              24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
               cos(4*phi0a - 2*phi0b) + 
              32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
               cos(4*phi0a - 2*phi0b) + 
              16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
               cos(4*phi0a - 2*phi0b) + 
              4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
              32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
              96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
               cos(4*phi0a - 2*phi0b) + 
              128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
               cos(4*phi0a - 2*phi0b) + 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
               cos(4*phi0a - 2*phi0b) + 
              4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
              32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) + 
              96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) + 
              128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) + 
              64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
               cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
              12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
              8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
              48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
              56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
              32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
              144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
               cos(phi0a - phi0b) + 
              160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
               cos(phi0a - phi0b) + 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
               cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
              12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
              16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
              216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
              16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
              576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(phi0a - phi0b) + 
              112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
              384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(phi0a - phi0b) + 
              288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
               cos(phi0a - phi0b) + 
              320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
               cos(phi0a - phi0b) + 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
               cos(phi0a - phi0b) + 
              56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
              48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
              112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
              576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(phi0a - phi0b) + 
              1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(phi0a - phi0b) + 
              960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(phi0a - phi0b) + 
              144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
              288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(phi0a - phi0b) + 
              160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
               cos(phi0a - phi0b) + 
              320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
               cos(phi0a - phi0b) + 
              64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
               cos(phi0a - phi0b) + 
              128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
               cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
              2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
              8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
              24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
              8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
              88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
               cos(2*(phi0a - phi0b)) - 
              128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
               cos(2*(phi0a - phi0b)) - 
              64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
               cos(2*(phi0a - phi0b)) - 
              24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
              8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
              96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
              96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
              96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
               cos(2*(phi0a - phi0b)) - 
              352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
               cos(2*(phi0a - phi0b)) - 
              88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
              352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
               cos(2*(phi0a - phi0b)) - 
              128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
               cos(2*(phi0a - phi0b)) - 
              512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
               cos(2*(phi0a - phi0b)) - 
              64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
               cos(2*(phi0a - phi0b)) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
               cos(2*(phi0a - phi0b)) + 
              2*curva*curvb*cos(3*(phi0a - phi0b)) + 
              12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
              24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
              16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
              12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
              72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
               cos(3*(phi0a - phi0b)) + 
              144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(3*(phi0a - phi0b)) + 
              96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(3*(phi0a - phi0b)) + 
              24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
              144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(3*(phi0a - phi0b)) + 
              288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(3*(phi0a - phi0b)) + 
              192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(3*(phi0a - phi0b)) + 
              16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
              96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(3*(phi0a - phi0b)) + 
              192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(3*(phi0a - phi0b)) + 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
              12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
              8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
              24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
              56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
              16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
              144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
               cos(3*phi0a - phi0b) - 
              160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
               cos(3*phi0a - phi0b) - 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
               cos(3*phi0a - phi0b) - 
              12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
              72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
              16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
              144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(3*phi0a - phi0b) - 
              112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
               cos(3*phi0a - phi0b) - 
              96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(3*phi0a - phi0b) - 
              288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
               cos(3*phi0a - phi0b) - 
              320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
               cos(3*phi0a - phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
               cos(3*phi0a - phi0b) - 
              24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
              144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(3*phi0a - phi0b) - 
              288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(3*phi0a - phi0b) - 
              192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(3*phi0a - phi0b) - 
              16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
              96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(3*phi0a - phi0b) - 
              192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(3*phi0a - phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
              pow(curvb,2)*cos(2*phi0b) + 
              8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
              40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
              64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
              32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
              8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
              4*pow(curvb,3)*d0b*cos(2*phi0b) + 
              64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
              32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
              64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
              160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
               cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
               d0b*cos(2*phi0b) + 
              128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
               cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
              72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
              4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
              320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
               cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
               cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
               pow(d0b,2)*cos(2*phi0b) + 
              160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
               cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
               pow(d0b,2)*cos(2*phi0b) + 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
               cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
               cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
               cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
               pow(d0b,3)*cos(2*phi0b) + 
              512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
               cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
               cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
               cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
               pow(d0b,4)*cos(2*phi0b) + 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
               cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
               cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
               cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
              24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
              32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
              16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
              128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
               cos(phi0a + phi0b) - 
              160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
               cos(phi0a + phi0b) - 
              64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
               cos(phi0a + phi0b) - 
              80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
              240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
               cos(phi0a + phi0b) - 
              64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
              160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
               cos(phi0a + phi0b) - 
              256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
               cos(phi0a + phi0b) - 
              320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
               cos(phi0a + phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
               cos(phi0a + phi0b) - 
              32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
              24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
              64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
              240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
               cos(phi0a + phi0b) - 
              576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
               cos(phi0a + phi0b) - 
              384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
               cos(phi0a + phi0b) - 
              128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
              256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
               cos(phi0a + phi0b) - 
              160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
               cos(phi0a + phi0b) - 
              320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
               cos(phi0a + phi0b) - 
              64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
               cos(phi0a + phi0b) - 
              128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
               cos(phi0a + phi0b))/
            pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b),2) + 
           (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
              sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                      8*pow(curvb,2)*pow(d0a,2) + 
                      16*curva*pow(curvb,2)*pow(d0a,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                      4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                      32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                      8*pow(curva,2)*pow(d0b,2) + 
                      4*pow(curvb,2)*pow(d0b,2) + 
                      32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                      32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                       pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                      8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                       (curva*d0b + 
                         curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2))
                         )*cos(phi0a - phi0b) + 
                      pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                       cos(2*(phi0a - phi0b)))*
                    pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                      curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                  (pow(curva,4)*pow(curvb,4)))))/
            (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b)) + 
           (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
              (-((1 + 2*curva*d0a)*
                   (curva + 4*pow(curvb,2)*d0a + 
                     4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                (1 + 2*curvb*d0b)*
                 (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    cos(phi0a - 2*phi0b) + 
                   curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                   (curvb + 4*pow(curva,2)*d0b + 
                      4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
              sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                      8*pow(curvb,2)*pow(d0a,2) + 
                      16*curva*pow(curvb,2)*pow(d0a,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                      4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                      32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                      8*pow(curva,2)*pow(d0b,2) + 
                      4*pow(curvb,2)*pow(d0b,2) + 
                      32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                      32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                       pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                      8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                      8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                       (curva*d0b + 
                         curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2))
                         )*cos(phi0a - phi0b) + 
                      pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                       cos(2*(phi0a - phi0b)))*
                    pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                      curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                  (pow(curva,4)*pow(curvb,4)))))/
            pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b),2)))/(4.*pow(curvb,2)) - 
     (4*d0b*sin(phi0b) + sqrt(4/pow(curvb,2) - 
          (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
          (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) - 
          (2*pow(curva,2) + 2*pow(curvb,2) - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
             64*pow(curva,3)*curvb*d0a*d0b - 
             64*curva*pow(curvb,3)*d0a*d0b - 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
             32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
             320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
             32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(1 + 8*curvb*d0b + 
                   64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   16*pow(curvb,4)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
             24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
             2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
             24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
             8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
             pow(curvb,2)*cos(2*phi0b) + 
             8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
             40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
             4*pow(curvb,3)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
             72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
             4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
             320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
              cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*cos(2*phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
             32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) + 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2)) + 
        (curvb*(-8/pow(curvb,3) - 
             (16*d0b*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/pow(curvb,2) + 
             (8*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,3) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                     pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
                  2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (4*(1 + 2*curvb*d0b)*
                (2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)) - 
             (8*d0b*cos(phi0b)*(-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) + 
             (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (pow(curvb,2)*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (4*curvb - 64*pow(curva,2)*curvb*pow(d0a,2) - 
                128*pow(curva,3)*curvb*pow(d0a,3) - 
                64*pow(curva,4)*curvb*pow(d0a,4) - 
                64*pow(curva,3)*d0a*d0b - 
                192*curva*pow(curvb,2)*d0a*d0b - 
                64*pow(curva,4)*pow(d0a,2)*d0b - 
                960*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b - 
                1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b - 
                768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b - 
                64*pow(curva,2)*curvb*pow(d0b,2) - 
                640*pow(curva,3)*curvb*d0a*pow(d0b,2) - 
                256*curva*pow(curvb,3)*d0a*pow(d0b,2) - 
                640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2) - 
                1280*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
                 pow(d0b,2) - 
                2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                 pow(d0b,2) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
                 pow(d0b,2) - 
                192*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3) - 
                1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                 pow(d0b,3) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,4) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                 pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-4*curvb + 64*pow(curvb,3)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (4*d0b + 4*curvb*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   32*curva*curvb*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (8*d0b + 192*pow(curvb,2)*d0b*
                       (pow(d0a,2) + pow(d0b,2)) + 
                      16*curvb*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      64*pow(curvb,3)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2)))*
                 cos(phi0a - 3*phi0b) - 
                12*curva*(1 + 2*curva*d0a)*d0b*pow(1 + 2*curvb*d0b,2)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                8*pow(curva,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
                48*pow(curva,2)*curvb*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,3)*curvb*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                192*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 2*curvb*cos(4*phi0a - 2*phi0b) + 
                16*curva*curvb*d0a*cos(4*phi0a - 2*phi0b) + 
                48*pow(curva,2)*curvb*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,3)*curvb*pow(d0a,3)*cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,4)*cos(4*phi0a - 2*phi0b) + 
                12*pow(curvb,2)*d0b*cos(4*phi0a - 2*phi0b) + 
                96*curva*pow(curvb,2)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                288*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curvb,3)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                128*curva*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*cos(phi0a - phi0b) + 
                12*pow(curva,2)*d0a*cos(phi0a - phi0b) + 
                24*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                168*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*pow(d0a,3)*cos(phi0a - phi0b) + 
                432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 24*curva*curvb*d0b*cos(phi0a - phi0b) + 
                432*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
                64*pow(curvb,3)*d0a*d0b*cos(phi0a - phi0b) + 
                1152*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                448*curva*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                768*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                144*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
                1728*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                4320*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                2880*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                288*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a - phi0b) + 
                128*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a - phi0b) + 
                576*pow(curva,4)*curvb*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                3840*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                2560*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 4*curvb*cos(2*(phi0a - phi0b)) - 
                48*curva*curvb*d0a*cos(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*curvb*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*curvb*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,4)*curvb*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*d0b*cos(2*(phi0a - phi0b)) - 
                24*pow(curvb,2)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                288*curva*pow(curvb,2)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
                1056*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                176*pow(curva,2)*curvb*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                32*pow(curvb,3)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                704*pow(curva,3)*curvb*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                384*curva*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                704*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1408*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 2*curva*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                24*curva*curvb*d0b*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*curvb*d0a*d0b*cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 2*curva*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                168*curva*pow(curvb,2)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                24*curva*curvb*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*curvb*d0a*d0b*cos(3*phi0a - phi0b) - 
                64*pow(curvb,3)*d0a*d0b*cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                448*curva*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) + 2*curvb*cos(2*phi0b) + 
                16*curva*curvb*d0a*cos(2*phi0b) + 
                80*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0b) + 
                128*pow(curva,3)*curvb*pow(d0a,3)*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*d0b*cos(2*phi0b) + 
                12*pow(curvb,2)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*d0a*d0b*cos(2*phi0b) + 
                96*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*pow(d0a,2)*d0b*cos(2*phi0b) + 
                480*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                768*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 
                144*pow(curva,2)*curvb*pow(d0b,2)*cos(2*phi0b) + 
                16*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
                640*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(2*phi0b) + 
                128*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                640*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 96*pow(curva,4)*pow(d0b,3)*cos(2*phi0b) + 
                384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
                1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                416*pow(curva,4)*curvb*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
                1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                576*pow(curva,4)*pow(curvb,2)*pow(d0b,5)*cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,3)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*cos(phi0a + phi0b) - 
                24*pow(curva,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                96*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*pow(d0a,3)*cos(phi0a + phi0b) - 
                384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
                480*pow(curva,3)*curvb*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                256*curva*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*curvb*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                1024*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                72*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                720*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                1728*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                1152*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a + phi0b) - 
                64*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a + phi0b) - 
                512*pow(curva,4)*curvb*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                640*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (2*(2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                (2*pow(curva,2) + 2*pow(curvb,2) - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                  64*pow(curva,3)*curvb*d0a*d0b - 
                  64*curva*pow(curvb,3)*d0a*d0b - 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                  320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) - 
                  320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,2) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                   pow(d0b,2) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
                   pow(d0b,2) - 
                  64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,3) - 
                  32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
                   pow(d0b,4) + 
                  pow(1 + 2*curva*d0a,2)*
                   (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*d0a*
                      (1 + 4*curvb*d0b + 
                        2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                     pow(curva,2)*
                      (1 + 8*curvb*d0b + 
                        64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                        8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                        16*pow(curvb,4)*
                         (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                           2*pow(d0b,4))))*cos(2*phi0a) - 
                  2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                   (4*pow(curva,2)*d0b + 
                     curvb*(1 + 4*curva*d0a + 
                        4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                   cos(phi0a - 3*phi0b) + 
                  pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                  4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                  8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - 2*phi0b)) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - 2*phi0b)) + 
                  pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                  24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(4*phi0a - 2*phi0b) + 
                  16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(4*phi0a - 2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(4*phi0a - 2*phi0b) - 
                  2*curva*curvb*cos(phi0a - phi0b) + 
                  12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                  8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                  48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                  32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a - phi0b) + 
                  8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                  12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                  16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a - phi0b) + 
                  16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                  576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a - phi0b) + 
                  56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                  48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                  112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
                   pow(d0b,2)*cos(phi0a - phi0b) + 
                  960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a - phi0b) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                  288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a - phi0b) + 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a - phi0b) + 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a - phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a - phi0b) - 
                  2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                  2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                  24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                  8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*(phi0a - phi0b)) - 
                  24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                  96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*(phi0a - phi0b)) - 
                  88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*(phi0a - phi0b)) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*(phi0a - phi0b)) - 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*(phi0a - phi0b)) + 
                  2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                  12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                  24*pow(curva,3)*curvb*pow(d0a,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*pow(curva,4)*curvb*pow(d0a,3)*
                   cos(3*(phi0a - phi0b)) + 
                  12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*(phi0a - phi0b)) + 
                  24*curva*pow(curvb,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*(phi0a - phi0b)) + 
                  16*curva*pow(curvb,4)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*(phi0a - phi0b)) - 
                  2*curva*curvb*cos(3*phi0a - phi0b) - 
                  12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                  8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(3*phi0a - phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(3*phi0a - phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(3*phi0a - phi0b) - 
                  12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                  72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(3*phi0a - phi0b) - 
                  16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                  144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(3*phi0a - phi0b) - 
                  96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(3*phi0a - phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(3*phi0a - phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                  144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(3*phi0a - phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                  96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                  pow(curvb,2)*cos(2*phi0b) + 
                  8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                  40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   cos(2*phi0b) + 
                  64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                   cos(2*phi0b) + 
                  32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                   cos(2*phi0b) + 8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                  4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                  64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                  32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                  64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                   cos(2*phi0b) + 
                  16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                  72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                   cos(2*phi0b) + 
                  32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                  320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                   cos(2*phi0b) + 
                  96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                   cos(2*phi0b) + 
                  512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                   cos(2*phi0b) + 
                  208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                   cos(2*phi0b) + 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                   cos(2*phi0b) + 
                  192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                   cos(2*phi0b) + 
                  64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                   cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
                  24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                  32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                  16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                  128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                   cos(phi0a + phi0b) - 
                  80*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                   cos(phi0a + phi0b) - 
                  32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                  24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                  64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                   cos(phi0a + phi0b) - 
                  160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                   cos(phi0a + phi0b) - 
                  64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                   cos(phi0a + phi0b) - 
                  128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                   cos(phi0a + phi0b)))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) - 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
                (2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (8*sqrt(2)*pow(curva,2)*curvb*d0b*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) + 
             (4*sqrt(2)*pow(curva,2)*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) + 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                     pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
                  2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) - 
             (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (2*curvb + 8*curva*curvb*d0a + 
                  pow(curva,2)*
                   (4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
                  4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
                  2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),3) + 
             (4*sqrt(2)*pow(curva,2)*curvb*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,4)*pow(curvb,4)) - 
                  ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                       16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                       32*curva*d0a*d0b + 
                       32*pow(curva,2)*pow(d0a,2)*d0b + 
                       8*curvb*pow(d0b,2) + 
                       64*curva*curvb*d0a*pow(d0b,2) + 
                       64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                       16*pow(curva,2)*pow(d0b,3) + 
                       16*pow(curva,2)*curvb*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                        cos(phi0a - phi0b) - 
                       16*(1 + 2*curva*d0a)*d0b*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)) + 
                  (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,5))))/
              ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4))))) + 
             (sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                     (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                   (pow(curva,4)*pow(curvb,4)) - 
                  ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                       16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                       32*curva*d0a*d0b + 
                       32*pow(curva,2)*pow(d0a,2)*d0b + 
                       8*curvb*pow(d0b,2) + 
                       64*curva*curvb*d0a*pow(d0b,2) + 
                       64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                       16*pow(curva,2)*pow(d0b,3) + 
                       16*pow(curva,2)*curvb*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                        cos(phi0a - phi0b) - 
                       16*(1 + 2*curva*d0a)*d0b*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)) + 
                  (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,5))))/
              (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b),2)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))))/
         (2.*sqrt(4/pow(curvb,2) - 
             (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
              pow(curvb,2) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
              (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                  pow(curva,2)*
                   (1 + 4*curvb*d0b + 
                     4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                  2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b))) - 
             (2*pow(curva,2) + 2*pow(curvb,2) - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
                64*pow(curva,3)*curvb*d0a*d0b - 
                64*curva*pow(curvb,3)*d0a*d0b - 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
                320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
                32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
                64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
                320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
                64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
                32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
                pow(1 + 2*curva*d0a,2)*
                 (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*d0a*
                    (1 + 4*curvb*d0b + 
                      2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                   pow(curva,2)*
                    (1 + 8*curvb*d0b + 
                      64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                      8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                      16*pow(curvb,4)*
                       (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                         2*pow(d0b,4))))*cos(2*phi0a) - 
                2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                 (4*pow(curva,2)*d0b + 
                   curvb*(1 + 4*curva*d0a + 
                      4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                 cos(phi0a - 3*phi0b) + 
                pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
                4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
                8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - 2*phi0b)) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - 2*phi0b)) + 
                32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - 2*phi0b)) + 
                16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - 2*phi0b)) + 
                pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
                24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(4*phi0a - 2*phi0b) + 
                32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(4*phi0a - 2*phi0b) + 
                16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(4*phi0a - 2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
                12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
                8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
                48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
                32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a - phi0b) + 
                8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
                12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
                16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
                216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(phi0a - phi0b) + 
                16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
                576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(phi0a - phi0b) + 
                384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a - phi0b) + 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a - phi0b) + 
                56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
                48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
                112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a - phi0b) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
                288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a - phi0b) + 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a - phi0b) + 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a - phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a - phi0b) - 
                2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
                2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
                24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
                8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                 cos(2*(phi0a - phi0b)) - 
                24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
                96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*(phi0a - phi0b)) - 
                88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
                352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*(phi0a - phi0b)) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*(phi0a - phi0b)) - 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*(phi0a - phi0b)) + 
                2*curva*curvb*cos(3*(phi0a - phi0b)) + 
                12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
                12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*(phi0a - phi0b)) + 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*(phi0a - phi0b)) + 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*(phi0a - phi0b)) + 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*(phi0a - phi0b)) - 
                2*curva*curvb*cos(3*phi0a - phi0b) - 
                12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
                8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(3*phi0a - phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(3*phi0a - phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(3*phi0a - phi0b) - 
                12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
                72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                 cos(3*phi0a - phi0b) - 
                16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
                144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                 cos(3*phi0a - phi0b) - 
                96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(3*phi0a - phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(3*phi0a - phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
                144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(3*phi0a - phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
                96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
                pow(curvb,2)*cos(2*phi0b) + 
                8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
                40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
                64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
                32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
                8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
                4*pow(curvb,3)*d0b*cos(2*phi0b) + 
                64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
                32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
                64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                 cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
                72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
                4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                 cos(2*phi0b) + 
                32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
                320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                 cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                 cos(2*phi0b) + 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                 cos(2*phi0b) + 
                96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
                128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
                512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                 cos(2*phi0b) + 
                512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                 cos(2*phi0b) + 
                208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
                64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
                256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                 cos(2*phi0b) + 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                 cos(2*phi0b) + 
                192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
                64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
                4*curva*curvb*cos(phi0a + phi0b) - 
                24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
                32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
                16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
                128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                 cos(phi0a + phi0b) - 
                80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
                240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                 cos(phi0a + phi0b) - 
                64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
                160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                 cos(phi0a + phi0b) - 
                320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                 cos(phi0a + phi0b) - 
                32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
                24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
                64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
                240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                 cos(phi0a + phi0b) - 
                160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                 cos(phi0a + phi0b) - 
                64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                 cos(phi0a + phi0b) - 
                128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                 cos(phi0a + phi0b))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2) + 
             (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b)) + 
             (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
                (-((1 + 2*curva*d0a)*
                     (curva + 4*pow(curvb,2)*d0a + 
                       4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                  (1 + 2*curvb*d0b)*
                   (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      cos(phi0a - 2*phi0b) + 
                     curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                     (curvb + 4*pow(curva,2)*d0b + 
                        4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
                sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                        8*pow(curvb,2)*pow(d0a,2) + 
                        16*curva*pow(curvb,2)*pow(d0a,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                        4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                        32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                        8*pow(curva,2)*pow(d0b,2) + 
                        4*pow(curvb,2)*pow(d0b,2) + 
                        32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                         pow(d0b,2) + 
                        16*pow(curva,2)*curvb*pow(d0b,3) + 
                        8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                        8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                         (curva*d0b + 
                           curvb*
                            (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                         cos(phi0a - phi0b) + 
                        pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                         cos(2*(phi0a - phi0b)))*
                      pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                        curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                    (pow(curva,4)*pow(curvb,4)))))/
              pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                pow(curva,2)*(1 + 4*curvb*d0b + 
                   4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 cos(phi0a - phi0b),2))))/(4.*curvb) );

   double dydd0a( -((4*curva*pow(curvb,2) + 
           8*pow(curva,2)*pow(curvb,2)*d0a - 
           4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (2*pow(curva,2)*cos(phi0a) + 4*pow(curvb,2)*cos(phi0a) + 
        24*curva*pow(curvb,2)*d0a*cos(phi0a) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
        2*pow(curva,2)*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*curvb*d0b*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        4*curva*curvb*cos(2*phi0a - phi0b) - 
        8*pow(curva,2)*curvb*d0a*cos(2*phi0a - phi0b) - 
        8*curva*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydphi0a( -(curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
         sin(phi0a - phi0b)*(curva*cos(phi0a) + 
           2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (-(curva*sin(phi0a)) - 2*pow(curva,2)*d0a*sin(phi0a) - 
        4*pow(curvb,2)*d0a*sin(phi0a) - 
        12*curva*pow(curvb,2)*pow(d0a,2)*sin(phi0a) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*sin(phi0a) + 
        curva*sin(phi0a - 2*phi0b) + 
        2*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) + 
        4*curva*curvb*d0b*sin(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) + 
        4*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) + 2*curvb*sin(2*phi0a - phi0b) + 
        8*curva*curvb*d0a*sin(2*phi0a - phi0b) + 
        8*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) + 
        4*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) + 
        16*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurva( -((4*pow(curvb,2)*d0a + 
           2*curva*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
           2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (cos(phi0a) + 4*curva*d0a*cos(phi0a) + 
        12*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
        16*curva*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
        cos(phi0a - 2*phi0b) - 4*curva*d0a*cos(phi0a - 2*phi0b) - 
        4*curvb*d0b*cos(phi0a - 2*phi0b) - 
        16*curva*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
        4*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        16*curva*pow(curvb,2)*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        4*curvb*d0a*cos(2*phi0a - phi0b) - 
        8*curva*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
        8*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
        16*curva*pow(curvb,2)*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) + 
        8*curva*d0b*cos(phi0b) + 24*curva*curvb*pow(d0b,2)*cos(phi0b) + 
        16*curva*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*curva*pow(curvb,2)*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydd0b( -((pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
           4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (-4*curva*curvb*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*curvb*d0a*cos(phi0a - 2*phi0b) - 
        8*curva*pow(curvb,2)*d0b*cos(phi0a - 2*phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - 2*phi0b) - 
        2*pow(curvb,2)*cos(2*phi0a - phi0b) - 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0a - phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        4*pow(curva,2)*cos(phi0b) + 2*pow(curvb,2)*cos(phi0b) + 
        24*pow(curva,2)*curvb*d0b*cos(phi0b) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curvb + 32*curva*curvb*d0a + 
                  32*pow(curva,2)*curvb*pow(d0a,2) + 
                  16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                  64*curva*pow(curvb,2)*d0a*d0b + 
                  64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                  48*pow(curva,2)*curvb*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                  16*curvb*(1 + 2*curva*d0a)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
	 )) );
   double dydphi0b( (curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
        sin(phi0a - phi0b)*(curva*cos(phi0a) + 
          2*pow(curva,2)*d0a*cos(phi0a) + 4*pow(curvb,2)*d0a*cos(phi0a) + 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
          curva*cos(phi0a - 2*phi0b) - 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
          4*pow(curva,2)*d0b*cos(phi0b) + 2*pow(curvb,2)*d0b*cos(phi0b) + 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (-2*curva*sin(phi0a - 2*phi0b) - 
        4*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) - 
        8*curva*curvb*d0b*sin(phi0a - 2*phi0b) - 
        16*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) - 
        8*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) - curvb*sin(2*phi0a - phi0b) - 
        4*curva*curvb*d0a*sin(2*phi0a - phi0b) - 
        4*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) - 
        2*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) - 
        8*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) - curvb*sin(phi0b) - 
        4*pow(curva,2)*d0b*sin(phi0b) - 2*pow(curvb,2)*d0b*sin(phi0b) - 
        12*pow(curva,2)*curvb*pow(d0b,2)*sin(phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*sin(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((2*(1 + 2*curvb*d0b)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*cos(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,4)) - 
             ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) + 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurvb( -((2*curvb + 8*curva*curvb*d0a + 
           pow(curva,2)*(4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
           4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
           2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (8*curvb*d0a*cos(phi0a) + 
        24*curva*curvb*pow(d0a,2)*cos(phi0a) + 
        16*pow(curva,2)*curvb*pow(d0a,3)*cos(phi0a) - 
        4*curva*d0b*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*d0a*d0b*cos(phi0a - 2*phi0b) - 
        8*curva*curvb*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        16*pow(curva,2)*curvb*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        cos(2*phi0a - phi0b) - 4*curva*d0a*cos(2*phi0a - phi0b) - 
        4*pow(curva,2)*pow(d0a,2)*cos(2*phi0a - phi0b) - 
        4*curvb*d0b*cos(2*phi0a - phi0b) - 
        16*curva*curvb*d0a*d0b*cos(2*phi0a - phi0b) - 
        16*pow(curva,2)*curvb*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) + 
        cos(phi0b) + 4*curvb*d0b*cos(phi0b) + 
        12*pow(curva,2)*pow(d0b,2)*cos(phi0b) + 
        16*pow(curva,2)*curvb*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*pow(curva,2)*curvb*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                  16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                  32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                  8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                  64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                  16*pow(curva,2)*pow(d0b,3) + 
                  16*pow(curva,2)*curvb*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                   cos(phi0a - phi0b) - 
                  16*(1 + 2*curva*d0a)*d0b*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,5))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );

   ex = sqrt( ed0ad0a * sqr( dxdd0a ) +
	      ephi0aphi0a * sqr( dxdphi0a ) +
	      ecurvacurva * sqr( dxdcurva ) +
	      2 * ed0acurva * dxdd0a * dxdcurva +
	      2 * ed0aphi0a * dxdd0a * dxdphi0a +
	      2 * ecurvaphi0a * dxdcurva * dxdphi0a +
	      ed0bd0b * sqr( dxdd0b ) +
	      ephi0bphi0b * sqr( dxdphi0b ) +
	      ecurvbcurvb * sqr( dxdcurvb ) +
	      2 * ed0bcurvb * dxdd0b * dxdcurvb +
	      2 * ed0bphi0b * dxdd0b * dxdphi0b +
	      2 * ecurvbphi0b * dxdcurvb * dxdphi0b );

   ey = sqrt( ed0ad0a * sqr( dydd0a ) +
	      ephi0aphi0a * sqr( dydphi0a ) +
	      ecurvacurva * sqr( dydcurva ) +
	      2 * ed0acurva * dydd0a * dydcurva +
	      2 * ed0aphi0a * dydd0a * dydphi0a +
	      2 * ecurvaphi0a * dydcurva * dydphi0a +
	      ed0bd0b * sqr( dydd0b ) +
	      ephi0bphi0b * sqr( dydphi0b ) +
	      ecurvbcurvb * sqr( dydcurvb ) +
	      2 * ed0bcurvb * dydd0b * dydcurvb +
	      2 * ed0bphi0b * dydd0b * dydphi0b +
	      2 * ecurvbphi0b * dydcurvb * dydphi0b );

   return true;
}

DABoolean BigNTuple::sol3( KTHelix& a, KTHelix& b, double& x, double& y )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double sqrtarg1( 4/pow(curvb,2) - (4*pow(1 + 2*curvb*d0b,2)*
        pow(cos(phi0b),2))/pow(curvb,2) - 
     (4*(1 + 2*curvb*d0b)*cos(phi0b)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
      (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) - (2*pow(curva,2) + 2*pow(curvb,2) - 
        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
        64*pow(curva,3)*curvb*d0a*d0b - 64*curva*pow(curvb,3)*d0a*d0b - 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
        320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
        32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
        64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
        320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
        64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
        32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
        pow(1 + 2*curva*d0a,2)*
         (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*d0a*
            (1 + 4*curvb*d0b + 2*pow(curvb,2)*
               (pow(d0a,2) + 2*pow(d0b,2))) + 
           pow(curva,2)*(1 + 8*curvb*d0b + 
              64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
              8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
              16*pow(curvb,4)*
               (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))))
          *cos(2*phi0a) - 2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
         (4*pow(curva,2)*d0b + 
           curvb*(1 + 4*curva*d0a + 
              4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
         cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
        4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
        4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
        8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + 
        64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
         cos(4*phi0a - 2*phi0b) + 
        32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
         cos(4*phi0a - 2*phi0b) + 
        16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
         cos(4*phi0a - 2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
        96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
        96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) + 
        128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
        12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
        8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
        48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
        32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a - phi0b) + 
        8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
        12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
        16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
        216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
        16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
        576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a - phi0b) + 112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a - phi0b) + 384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a - phi0b) + 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a - phi0b) + 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a - phi0b) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a - phi0b) + 56*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a - phi0b) + 48*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a - phi0b) + 112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a - phi0b) + 576*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a - phi0b) + 
        1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a - phi0b) + 960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a - phi0b) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
        32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
        288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a - phi0b) + 384*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a - phi0b) + 
        960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a - phi0b) + 640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a - phi0b) + 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a - phi0b) + 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a - phi0b) + 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a - phi0b) - 
        2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
        2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
        8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
        24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
        8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
         cos(2*(phi0a - phi0b)) - 
        24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
        96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
        96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
        12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
        12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*(phi0a - phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*(phi0a - phi0b)) + 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
        12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
        8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(3*phi0a - phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(3*phi0a - phi0b) - 
        12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
        16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*phi0a - phi0b) - 
        112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(3*phi0a - phi0b) - 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
        pow(curvb,2)*cos(2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
        40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
        8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(2*phi0b) + 
        64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
        160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
        16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
        72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,2)*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
         pow(d0b,2)*cos(2*phi0b) + 
        96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
         cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,4)*cos(2*phi0b) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
        4*curva*curvb*cos(phi0a + phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
        32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a + phi0b) - 
        80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
        240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a + phi0b) - 
        256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a + phi0b) - 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a + phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a + phi0b) - 32*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a + phi0b) - 24*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a + phi0b) - 64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a + phi0b) - 240*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a + phi0b) - 384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
        256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a + phi0b) - 160*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a + phi0b) - 256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a + phi0b) - 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a + phi0b) - 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a + phi0b))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) - (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))\
      - (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) );
   double sqrtarg2( -(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
           8*pow(curvb,2)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*pow(d0a,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
           32*curva*curvb*d0a*d0b + 
           32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
           8*pow(curva,2)*pow(d0b,2) + 4*pow(curvb,2)*pow(d0b,2) + 
           32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
           32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
           16*pow(curva,2)*curvb*pow(d0b,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
           8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            (curva*d0b + curvb*
               (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
            cos(phi0a - phi0b) + 
           pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
            cos(2*(phi0a - phi0b)))*
         pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
           curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
       (pow(curva,4)*pow(curvb,4))) );

   if ( sqrtarg1 < 0.  ||  sqrtarg2 < 0. ) return false;

   x = (sqrt(sqrtarg1) - (2*sin(phi0b))/curvb - 4*d0b*sin(phi0b))/4.;
   y = -(sqrt(2)*pow(curva,2)*pow(curvb,2)*sqrt(sqrtarg2) - 
        curva*cos(phi0a) - 2*pow(curva,2)*d0a*cos(phi0a) - 
        4*pow(curvb,2)*d0a*cos(phi0a) - 
        12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
        curva*cos(phi0a - 2*phi0b) + 
        2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
        4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
        4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
        4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
        4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
        4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
        12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b))/
     (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
         pow(curva,2)*(1 + 4*curvb*d0b + 
            4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
         2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
       );

   return true;
}

DABoolean BigNTuple::errsol3( KTHelix& a, KTHelix& b, double& ex, double& ey )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double ed0ad0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0acurva( a.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0aphi0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvacurva( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvaphi0a( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0aphi0a( a.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double ed0bd0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0bcurvb( b.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0bphi0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvbcurvb( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvbphi0b( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0bphi0b( b.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double dxdd0a( ((-4*(1 + 2*curvb*d0b)*
          (-((1 + 2*curva*d0a)*(4*pow(curvb,2) + 
                 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
            2*curva*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
          cos(phi0b))/
        (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))) + 
       (4*(1 + 2*curvb*d0b)*(4*curva*pow(curvb,2) + 
            8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
        (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)) - 
       (-64*pow(curva,2)*pow(curvb,2)*d0a - 
          192*pow(curva,3)*pow(curvb,2)*pow(d0a,2) - 
          128*pow(curva,4)*pow(curvb,2)*pow(d0a,3) - 
          64*pow(curva,3)*curvb*d0b - 64*curva*pow(curvb,3)*d0b - 
          128*pow(curva,4)*curvb*d0a*d0b - 
          640*pow(curva,2)*pow(curvb,3)*d0a*d0b - 
          1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b - 
          1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b - 
          320*pow(curva,3)*pow(curvb,2)*pow(d0b,2) - 
          64*curva*pow(curvb,4)*pow(d0b,2) - 
          640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2) - 
          640*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2) - 
          1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
          1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
          512*pow(curva,3)*pow(curvb,3)*pow(d0b,3) - 
          1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3) - 
          256*pow(curva,3)*pow(curvb,4)*pow(d0b,4) - 
          512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4) + 
          pow(1 + 2*curva*d0a,2)*
           (32*pow(curvb,4)*d0a + 64*curva*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(32*pow(curvb,2)*d0a + 
                128*pow(curvb,3)*d0a*d0b + 
                16*pow(curvb,4)*(4*pow(d0a,3) + 8*d0a*pow(d0b,2))))*
           cos(2*phi0a) + 4*curva*(1 + 2*curva*d0a)*
           (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*cos(2*phi0a) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(4*curva + 8*pow(curva,2)*d0a)*
           pow(1 + 2*curvb*d0b,3)*cos(phi0a - 3*phi0b) - 
          4*pow(curva,2)*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) + 4*pow(curva,3)*cos(2*(phi0a - 2*phi0b)) + 
          8*pow(curva,4)*d0a*cos(2*(phi0a - 2*phi0b)) + 
          32*pow(curva,3)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
          64*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
          96*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          192*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          128*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          256*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          64*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          8*curva*pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
          48*pow(curva,2)*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
          96*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
           cos(4*phi0a - 2*phi0b) + 
          64*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
           cos(4*phi0a - 2*phi0b) + 
          32*curva*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
          192*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          32*curva*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
          192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          12*pow(curva,2)*curvb*cos(phi0a - phi0b) + 
          8*pow(curvb,3)*cos(phi0a - phi0b) + 
          96*pow(curva,3)*curvb*d0a*cos(phi0a - phi0b) + 
          112*curva*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
          96*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
          640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
          320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
          16*pow(curva,4)*d0b*cos(phi0a - phi0b) + 
          216*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
          16*pow(curvb,4)*d0b*cos(phi0a - phi0b) + 
          1152*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
          224*curva*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
          1152*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a - phi0b) + 
          864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
           cos(phi0a - phi0b) + 
          1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
           cos(phi0a - phi0b) + 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a - phi0b) + 
          112*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
          576*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
          2880*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          2880*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          288*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
          384*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
          1920*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          1920*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
          128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(phi0a - phi0b) - 
          8*pow(curva,3)*cos(2*(phi0a - phi0b)) - 
          24*curva*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
          16*pow(curva,4)*d0a*cos(2*(phi0a - phi0b)) - 
          176*pow(curva,2)*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
           cos(2*(phi0a - phi0b)) - 
          256*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
           cos(2*(phi0a - phi0b)) - 
          96*pow(curva,3)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
          96*curva*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
          192*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          704*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(2*(phi0a - phi0b)) - 
          352*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          96*curva*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
          704*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          704*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) - 
          512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) + 
          12*pow(curva,2)*curvb*cos(3*(phi0a - phi0b)) + 
          48*pow(curva,3)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
          48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
          72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
          288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*(phi0a - phi0b)) + 
          144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) + 
          384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) + 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) - 
          12*pow(curva,2)*curvb*cos(3*phi0a - phi0b) - 
          8*pow(curvb,3)*cos(3*phi0a - phi0b) - 
          48*pow(curva,3)*curvb*d0a*cos(3*phi0a - phi0b) - 
          112*curva*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
          48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
          432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
           cos(3*phi0a - phi0b) - 
          640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
           cos(3*phi0a - phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
           cos(3*phi0a - phi0b) - 
          72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
          16*pow(curvb,4)*d0b*cos(3*phi0a - phi0b) - 
          288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
          224*curva*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*phi0a - phi0b) - 
          864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
           cos(3*phi0a - phi0b) - 
          1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
           cos(3*phi0a - phi0b) - 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(3*phi0a - phi0b) - 
          144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 
          384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*phi0a - phi0b) + 8*curva*pow(curvb,2)*cos(2*phi0b) + 
          80*pow(curva,2)*pow(curvb,2)*d0a*cos(2*phi0b) + 
          192*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
          128*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
          64*pow(curva,3)*curvb*d0b*cos(2*phi0b) + 
          32*curva*pow(curvb,3)*d0b*cos(2*phi0b) + 
          128*pow(curva,4)*curvb*d0a*d0b*cos(2*phi0b) + 
          320*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
          768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
          512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
          320*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
          32*curva*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
          640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          320*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          768*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*phi0b) + 512*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
           pow(d0b,2)*cos(2*phi0b) + 
          512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
          1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
          256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
          512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*cos(2*phi0b) - 
          48*pow(curva,3)*curvb*d0a*cos(phi0a + phi0b) - 
          64*curva*pow(curvb,3)*d0a*cos(phi0a + phi0b) - 
          48*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
          384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
          640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
          80*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a + phi0b) - 
          480*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
          128*curva*pow(curvb,4)*d0a*d0b*cos(phi0a + phi0b) - 
          480*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a + phi0b) - 
          768*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
           cos(phi0a + phi0b) - 
          1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
           cos(phi0a + phi0b) - 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a + phi0b) - 
          64*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
          240*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
          1152*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          1152*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          256*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
          160*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
          768*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          768*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
          128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(phi0a + phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (2*(4*curva*pow(curvb,2) + 
            8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b)))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(4*pow(curvb,2) + 
                 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
            2*curva*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
          (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                  4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*sin(phi0a)*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,3)*pow(curvb,3)) - 
            ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                 48*curva*pow(curvb,2)*pow(d0a,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                 32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                 32*curva*pow(curvb,2)*pow(d0b,2) + 
                 64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                 8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b) - 
                 16*curva*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) - 
       (sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*sin(phi0a)*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,3)*pow(curvb,3)) - 
            ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                 48*curva*pow(curvb,2)*pow(d0a,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                 32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                 32*curva*pow(curvb,2)*pow(d0b,2) + 
                 64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                 8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b) - 
                 16*curva*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) - 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) - 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdphi0a( ((8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
          cos(phi0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sin(phi0a - phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
          (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))*sin(phi0a - phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
            (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  sin(phi0a - 2*phi0b)) - 
               2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b))))/
        (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))) + 
       (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
          pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
          (1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sin(phi0a - phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                  4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
            (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  sin(phi0a - 2*phi0b)) - 
               2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
               (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,3)) - 
            ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  sin(phi0a - phi0b) - 
                 2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  sin(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) - 
       (sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
               (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,3)) - 
            ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  sin(phi0a - phi0b) - 
                 2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  sin(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) - 
       (-2*pow(1 + 2*curva*d0a,2)*
           (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*sin(2*phi0a) + 
          2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           sin(phi0a - 3*phi0b) - 2*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) - 
          8*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) - 
          8*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) - 
          16*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) - 
          64*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) - 
          64*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*(phi0a - 2*phi0b)) - 
          48*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
           sin(2*(phi0a - 2*phi0b)) - 
          192*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
           sin(2*(phi0a - 2*phi0b)) - 
          192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           sin(2*(phi0a - 2*phi0b)) - 
          64*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
           sin(2*(phi0a - 2*phi0b)) - 
          256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
           sin(2*(phi0a - 2*phi0b)) - 
          256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           sin(2*(phi0a - 2*phi0b)) - 
          32*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
           sin(2*(phi0a - 2*phi0b)) - 
          128*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
           sin(2*(phi0a - 2*phi0b)) - 
          128*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           sin(2*(phi0a - 2*phi0b)) - 
          4*pow(curvb,2)*sin(4*phi0a - 2*phi0b) - 
          32*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) - 
          96*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
           sin(4*phi0a - 2*phi0b) - 
          128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
           sin(4*phi0a - 2*phi0b) - 
          64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
           sin(4*phi0a - 2*phi0b) - 
          16*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) - 
          128*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) - 
          384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
           sin(4*phi0a - 2*phi0b) - 
          512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
           sin(4*phi0a - 2*phi0b) - 
          256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
           sin(4*phi0a - 2*phi0b) - 
          16*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
          128*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
          384*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           sin(4*phi0a - 2*phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           sin(4*phi0a - 2*phi0b) - 
          256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           sin(4*phi0a - 2*phi0b) + 2*curva*curvb*sin(phi0a - phi0b) - 
          12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) - 
          8*pow(curvb,3)*d0a*sin(phi0a - phi0b) - 
          48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) - 
          56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) - 
          32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) - 
          144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*sin(phi0a - phi0b) - 
          160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*sin(phi0a - phi0b) - 
          64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a - phi0b) - 
          8*pow(curva,3)*d0b*sin(phi0a - phi0b) - 
          12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) - 
          16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) - 
          216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a - phi0b) - 
          16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) - 
          576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(phi0a - phi0b) - 
          112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a - phi0b) - 
          384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(phi0a - phi0b) - 
          288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
           sin(phi0a - phi0b) - 
          320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
           sin(phi0a - phi0b) - 
          128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
           sin(phi0a - phi0b) - 
          56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) - 
          48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) - 
          112*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a - phi0b) - 
          576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(phi0a - phi0b) - 
          1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(phi0a - phi0b) - 
          960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(phi0a - phi0b) - 
          144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*sin(phi0a - phi0b) - 
          32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) - 
          288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*sin(phi0a - phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
           sin(phi0a - phi0b) - 
          64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a - phi0b) - 
          128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
           sin(phi0a - phi0b) + 4*pow(curva,2)*sin(2*(phi0a - phi0b)) + 
          4*pow(curvb,2)*sin(2*(phi0a - phi0b)) + 
          16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) + 
          48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) + 
          16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) + 
          176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
           sin(2*(phi0a - phi0b)) + 
          256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
           sin(2*(phi0a - phi0b)) + 
          128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
           sin(2*(phi0a - phi0b)) + 
          48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) + 
          16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) + 
          192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) + 
          192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) + 
          192*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*(phi0a - phi0b)) + 
          704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
           sin(2*(phi0a - phi0b)) + 
          176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
          704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          192*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
          704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           sin(2*(phi0a - phi0b)) + 
          128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           sin(2*(phi0a - phi0b)) - 6*curva*curvb*sin(3*(phi0a - phi0b)) - 
          36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) - 
          72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) - 
          48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) - 
          36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) - 
          216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*(phi0a - phi0b)) - 
          432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(3*(phi0a - phi0b)) - 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(3*(phi0a - phi0b)) - 
          72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) - 
          432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(3*(phi0a - phi0b)) - 
          864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(3*(phi0a - phi0b)) - 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(3*(phi0a - phi0b)) - 
          48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) - 
          288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(3*(phi0a - phi0b)) - 
          576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(3*(phi0a - phi0b)) - 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(3*(phi0a - phi0b)) + 6*curva*curvb*sin(3*phi0a - phi0b) + 
          36*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) + 
          24*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) + 
          72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) + 
          168*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) + 
          48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
           sin(3*phi0a - phi0b) + 
          480*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
           sin(3*phi0a - phi0b) + 
          192*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
           sin(3*phi0a - phi0b) + 
          36*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) + 
          216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*phi0a - phi0b) + 
          48*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) + 
          432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(3*phi0a - phi0b) + 
          336*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(3*phi0a - phi0b) + 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(3*phi0a - phi0b) + 
          864*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
           sin(3*phi0a - phi0b) + 
          960*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
           sin(3*phi0a - phi0b) + 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
           sin(3*phi0a - phi0b) + 
          72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(3*phi0a - phi0b) + 
          864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(3*phi0a - phi0b) + 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(3*phi0a - phi0b) + 
          48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) + 
          288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(3*phi0a - phi0b) + 
          576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(3*phi0a - phi0b) + 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(3*phi0a - phi0b) - 4*curva*curvb*sin(phi0a + phi0b) + 
          24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
          32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
          16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
          128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*sin(phi0a + phi0b) + 
          160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*sin(phi0a + phi0b) + 
          64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a + phi0b) + 
          80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
          240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(phi0a + phi0b) + 
          64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
          160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(phi0a + phi0b) + 
          256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
           sin(phi0a + phi0b) + 
          320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
           sin(phi0a + phi0b) + 
          128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
           sin(phi0a + phi0b) + 
          32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
          24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
          64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
          240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(phi0a + phi0b) + 
          576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(phi0a + phi0b) + 
          384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(phi0a + phi0b) + 
          128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*sin(phi0a + phi0b) + 
          16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
          256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*sin(phi0a + phi0b) + 
          320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
           sin(phi0a + phi0b) + 
          64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a + phi0b) + 
          128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
           sin(phi0a + phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2))/(8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) - 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) - 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdcurva( ((-4*(1 + 2*curvb*d0b)*cos(phi0b)*
          (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
               cos(phi0a)) - 2*d0a*
             (curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
               4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
               (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b))))/
        (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))) + 
       (4*(1 + 2*curvb*d0b)*(4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
        (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)) - 
       (4*curva - 64*curva*pow(curvb,2)*pow(d0a,2) - 
          192*pow(curva,2)*pow(curvb,2)*pow(d0a,3) - 
          128*pow(curva,3)*pow(curvb,2)*pow(d0a,4) - 
          192*pow(curva,2)*curvb*d0a*d0b - 64*pow(curvb,3)*d0a*d0b - 
          256*pow(curva,3)*curvb*pow(d0a,2)*d0b - 
          640*curva*pow(curvb,3)*pow(d0a,2)*d0b - 
          1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b - 
          1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b - 
          64*curva*pow(curvb,2)*pow(d0b,2) - 
          960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
          64*pow(curvb,4)*d0a*pow(d0b,2) - 
          1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
          640*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
          1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
          128*curva*pow(curvb,3)*pow(d0b,3) - 
          1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3) - 
          2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
          64*curva*pow(curvb,4)*pow(d0b,4) - 
          768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
          pow(1 + 2*curva*d0a,2)*
           (16*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             2*curva*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*cos(2*phi0a) + 
          4*d0a*(1 + 2*curva*d0a)*
           (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*cos(2*phi0a) - 
          2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
           (8*curva*d0b + curvb*
              (4*d0a + 8*curva*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) - 
          4*curva*d0a*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) - 
          2*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) + 2*curva*cos(2*(phi0a - 2*phi0b)) + 
          12*pow(curva,2)*d0a*cos(2*(phi0a - 2*phi0b)) + 
          16*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
          16*curva*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
          96*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
          128*pow(curva,3)*curvb*pow(d0a,2)*d0b*
           cos(2*(phi0a - 2*phi0b)) + 
          48*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - 2*phi0b)) + 
          288*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          64*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - 2*phi0b)) + 
          384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          512*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          32*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - 2*phi0b)) + 
          192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          256*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          8*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
          48*curva*pow(curvb,2)*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
          96*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
           cos(4*phi0a - 2*phi0b) + 
          64*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
           cos(4*phi0a - 2*phi0b) + 
          32*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
          192*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          32*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
          192*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) - 2*curvb*cos(phi0a - phi0b) + 
          24*curva*curvb*d0a*cos(phi0a - phi0b) + 
          144*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
          56*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
          128*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
          288*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
          480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*cos(phi0a - phi0b) + 
          24*pow(curva,2)*d0b*cos(phi0a - phi0b) + 
          12*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
          64*pow(curva,3)*d0a*d0b*cos(phi0a - phi0b) + 
          432*curva*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
          1728*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a - phi0b) + 
          112*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
          1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(phi0a - phi0b) + 
          576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a - phi0b) + 
          960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a - phi0b) + 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
           cos(phi0a - phi0b) + 
          168*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
          48*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
          448*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
          1152*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
          4320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          3840*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
          32*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
          1152*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          768*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a - phi0b) + 
          2880*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          2560*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
          1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
           cos(phi0a - phi0b) + 
          192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*cos(phi0a - phi0b) + 
          512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
           cos(phi0a - phi0b) - 4*curva*cos(2*(phi0a - phi0b)) - 
          24*pow(curva,2)*d0a*cos(2*(phi0a - phi0b)) - 
          24*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
          32*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
          176*curva*pow(curvb,2)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
          384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
           cos(2*(phi0a - phi0b)) - 
          256*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
           cos(2*(phi0a - phi0b)) - 
          48*curva*curvb*d0b*cos(2*(phi0a - phi0b)) - 
          288*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          96*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          384*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
          704*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
           cos(2*(phi0a - phi0b)) - 
          176*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
          1056*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          96*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
          1408*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          704*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          256*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          128*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - phi0b)) - 
          768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) + 2*curvb*cos(3*(phi0a - phi0b)) + 
          24*curva*curvb*d0a*cos(3*(phi0a - phi0b)) + 
          72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
          64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
          12*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
          144*curva*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
          432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*(phi0a - phi0b)) + 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(3*(phi0a - phi0b)) + 
          24*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
          288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
          864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          16*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
          192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
          576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) + 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) - 2*curvb*cos(3*phi0a - phi0b) - 
          24*curva*curvb*d0a*cos(3*phi0a - phi0b) - 
          72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
          56*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
          64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
          288*curva*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
          480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
           cos(3*phi0a - phi0b) - 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
           cos(3*phi0a - phi0b) - 
          12*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
          144*curva*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
          432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*phi0a - phi0b) - 
          112*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(3*phi0a - phi0b) - 
          576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(3*phi0a - phi0b) - 
          960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(3*phi0a - phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
           cos(3*phi0a - phi0b) - 
          24*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
          288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*phi0a - phi0b) - 
          864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          16*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
          192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*phi0a - phi0b) - 
          576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 4*curva*cos(2*phi0b) + 
          8*pow(curvb,2)*d0a*cos(2*phi0b) + 
          80*curva*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
          192*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
          128*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
          16*curva*curvb*d0b*cos(2*phi0b) + 
          192*pow(curva,2)*curvb*d0a*d0b*cos(2*phi0b) + 
          32*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
          256*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
          320*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
          768*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
          512*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
          64*pow(curva,3)*pow(d0b,2)*cos(2*phi0b) + 
          144*curva*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
          960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          32*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           cos(2*phi0b) + 320*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*phi0b) + 768*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
           pow(d0b,2)*cos(2*phi0b) + 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           cos(2*phi0b) + 384*pow(curva,3)*curvb*pow(d0b,3)*
           cos(2*phi0b) + 256*curva*pow(curvb,3)*pow(d0b,3)*
           cos(2*phi0b) + 1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*phi0b) + 2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
           pow(d0b,3)*cos(2*phi0b) + 
          832*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
          128*curva*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
          768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*cos(2*phi0b) + 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           cos(2*phi0b) + 768*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
           cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0b,6)*
           cos(2*phi0b) + 4*curvb*cos(phi0a + phi0b) - 
          72*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
          32*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
          64*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
          256*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
          480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*cos(phi0a + phi0b) - 
          160*curva*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
          720*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a + phi0b) - 
          64*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
          640*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(phi0a + phi0b) - 
          512*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a + phi0b) - 
          960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a + phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
           cos(phi0a + phi0b) - 
          96*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
          24*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
          256*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
          480*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
          1728*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          1536*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
          16*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
          1024*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          320*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a + phi0b) - 
          1152*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
          1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
           cos(phi0a + phi0b) - 
          192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*cos(phi0a + phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
           cos(phi0a + phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (2*(4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b)))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) + (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
          (4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                  4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (8*sqrt(2)*curva*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ) - (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
               cos(phi0a)) - 2*d0a*
             (curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
               4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
               (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (4*sqrt(2)*curva*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,4)) - 
            ((4*d0a + 8*curva*pow(d0a,2) + 16*pow(curvb,2)*pow(d0a,3) + 
                 16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                 64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                 32*pow(curvb,2)*d0a*pow(d0b,2) + 
                 64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 32*curva*curvb*pow(d0b,3) + 
                 16*curva*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                  cos(phi0a - phi0b) - 
                 16*d0a*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)) + 
            (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,5)*pow(curvb,4))))/
        ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) - 
       (sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,4)) - 
            ((4*d0a + 8*curva*pow(d0a,2) + 16*pow(curvb,2)*pow(d0a,3) + 
                 16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                 64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                 32*pow(curvb,2)*d0a*pow(d0b,2) + 
                 64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 32*curva*curvb*pow(d0b,3) + 
                 16*curva*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                  cos(phi0a - phi0b) - 
                 16*d0a*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)) + 
            (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,5)*pow(curvb,4))))/
        (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) - 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) - 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdd0b( (-4*sin(phi0b) + 
       ((-16*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/curvb - 
          (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((1 + 2*curvb*d0b)*
                (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                  (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*cos(phi0b))\
                + 2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (4*(1 + 2*curvb*d0b)*(pow(curva,2)*
                (4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)) - 
          (8*cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (-64*pow(curva,3)*curvb*d0a - 64*curva*pow(curvb,3)*d0a - 
             64*pow(curva,4)*curvb*pow(d0a,2) - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4) - 
             64*pow(curva,2)*pow(curvb,2)*d0b - 
             640*pow(curva,3)*pow(curvb,2)*d0a*d0b - 
             128*curva*pow(curvb,4)*d0a*d0b - 
             640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b - 
             640*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b - 
             1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b - 
             192*pow(curva,2)*pow(curvb,3)*pow(d0b,2) - 
             1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2) - 
             1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2) - 
             128*pow(curva,2)*pow(curvb,4)*pow(d0b,3) - 
             1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3) - 
             1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3) + 
             pow(1 + 2*curva*d0a,2)*
              (16*curva*pow(curvb,2)*d0a*(4*curvb + 8*pow(curvb,2)*d0b) + 
                pow(curva,2)*(8*curvb + 80*pow(curvb,2)*d0b + 
                   128*pow(curvb,3)*pow(d0b,2) + 
                   64*pow(curvb,3)*(pow(d0a,2) + pow(d0b,2)) + 
                   16*pow(curvb,4)*(8*pow(d0a,2)*d0b + 8*pow(d0b,3))))*
              cos(2*phi0a) - 2*curva*(1 + 2*curva*d0a)*
              pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
              cos(phi0a - 3*phi0b) - 
             12*curva*curvb*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             8*pow(curva,2)*curvb*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             48*pow(curva,2)*pow(curvb,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,3)*pow(curvb,2)*d0a*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curvb,3)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             8*pow(curvb,4)*d0b*cos(4*phi0a - 2*phi0b) + 
             64*curva*pow(curvb,4)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 8*pow(curva,3)*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
              cos(phi0a - phi0b) + 
             112*pow(curva,3)*curvb*d0b*cos(phi0a - phi0b) + 
             96*curva*pow(curvb,3)*d0b*cos(phi0a - phi0b) + 
             224*pow(curva,4)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
             1152*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(phi0a - phi0b) + 
             2880*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             1920*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             432*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             96*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a - phi0b) + 
             864*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1152*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             2880*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1920*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) - 
             24*pow(curva,2)*curvb*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*pow(curvb,2)*d0b*cos(2*(phi0a - phi0b)) - 
             16*pow(curvb,4)*d0b*cos(2*(phi0a - phi0b)) - 
             704*pow(curva,3)*pow(curvb,2)*d0a*d0b*
              cos(2*(phi0a - phi0b)) - 
             192*curva*pow(curvb,4)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(3*(phi0a - phi0b)) + 
             48*curva*pow(curvb,3)*d0b*cos(3*(phi0a - phi0b)) + 
             288*pow(curva,2)*pow(curvb,3)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) - 
             12*curva*pow(curvb,2)*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             48*curva*pow(curvb,3)*d0b*cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(3*phi0a - phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) + 8*pow(curva,2)*curvb*cos(2*phi0b) + 
             4*pow(curvb,3)*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(2*phi0b) + 
             256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(2*phi0b) + 
             32*pow(curva,4)*d0b*cos(2*phi0b) + 
             144*pow(curva,2)*pow(curvb,2)*d0b*cos(2*phi0b) + 
             8*pow(curvb,4)*d0b*cos(2*phi0b) + 
             640*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
             64*curva*pow(curvb,4)*d0a*d0b*cos(2*phi0b) + 
             640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
              d0b*cos(2*phi0b) + 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(2*phi0b) + 256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
              d0b*cos(2*phi0b) + 
             288*pow(curva,4)*curvb*pow(d0b,2)*cos(2*phi0b) + 
             384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
             1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             832*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
             256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(2*phi0b) + 
             1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(2*phi0b) + 1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
              pow(d0b,3)*cos(2*phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
             384*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(2*phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*curvb*d0b*cos(phi0a + phi0b) - 
             48*curva*pow(curvb,3)*d0b*cos(phi0a + phi0b) - 
             128*pow(curva,4)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
             480*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(phi0a + phi0b) - 
             1152*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             768*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             48*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a + phi0b) - 
             768*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             480*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             1152*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             768*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (2*(pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b)))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
             (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                     4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (8*sqrt(2)*pow(curva,2)*pow(curvb,2)*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             ((1 + 2*curvb*d0b)*
                (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                  (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*cos(phi0b))\
                + 2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) - 
          (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*sin(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,3)) - 
               ((4*curvb + 32*curva*curvb*d0a + 
                    32*pow(curva,2)*curvb*pow(d0a,2) + 
                    16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                    64*curva*pow(curvb,2)*d0a*d0b + 
                    64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                    48*pow(curva,2)*curvb*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                    16*curvb*(1 + 2*curva*d0a)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) - 
          (sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*sin(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,3)) - 
               ((4*curvb + 32*curva*curvb*d0a + 
                    32*pow(curva,2)*curvb*pow(d0a,2) + 
                    16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                    64*curva*pow(curvb,2)*d0a*d0b + 
                    64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                    48*pow(curva,2)*curvb*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                    16*curvb*(1 + 2*curva*d0a)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))))/
        (2.*sqrt(4/pow(curvb,2) - 
            (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
            (4*(1 + 2*curvb*d0b)*cos(phi0b)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
             (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                 pow(curva,2)*
                  (1 + 4*curvb*d0b + 
                    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                 2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b))) - 
            (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2) - 
            (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b)) - 
            (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2))))/4. );
   double dxdphi0b( ((-2*cos(phi0b))/curvb - 4*d0b*cos(phi0b) + 
       ((-8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sin(phi0a - phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))*sin(phi0a - phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (8*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0b))/pow(curvb,2) + 
          (4*(1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sin(phi0b))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) - 
          (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
             pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
             (1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sin(phi0a - phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*sin(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (4*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*
             (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                sin(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) - 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*(1 + 2*curvb*d0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))*
             (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                sin(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((2*(1 + 2*curvb*d0b)*
                  (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*cos(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,4)) - 
               ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     sin(phi0a - phi0b) + 
                    2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     sin(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) - 
          (sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             ((2*(1 + 2*curvb*d0b)*
                  (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*cos(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,4)) - 
               ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     sin(phi0a - phi0b) + 
                    2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     sin(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) - 
          (-6*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              sin(phi0a - 3*phi0b) + 
             4*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              sin(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              sin(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              sin(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              sin(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              sin(2*(phi0a - 2*phi0b)) + 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              sin(2*(phi0a - 2*phi0b)) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              sin(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              sin(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              sin(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              sin(2*(phi0a - 2*phi0b)) + 
             2*pow(curvb,2)*sin(4*phi0a - 2*phi0b) + 
             16*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) + 
             48*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              sin(4*phi0a - 2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              sin(4*phi0a - 2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              sin(4*phi0a - 2*phi0b) + 
             8*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) + 
             64*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) + 
             192*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              sin(4*phi0a - 2*phi0b) + 
             256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              sin(4*phi0a - 2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              sin(4*phi0a - 2*phi0b) + 
             8*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) + 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) + 
             192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) + 
             256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) - 2*curva*curvb*sin(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*sin(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              sin(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              sin(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              sin(phi0a - phi0b) + 8*pow(curva,3)*d0b*sin(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              sin(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              sin(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              sin(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              sin(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              sin(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              sin(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              sin(phi0a - phi0b) - 4*pow(curva,2)*sin(2*(phi0a - phi0b)) - 
             4*pow(curvb,2)*sin(2*(phi0a - phi0b)) - 
             16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) - 
             48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) - 
             16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              sin(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              sin(2*(phi0a - phi0b)) - 
             128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              sin(2*(phi0a - phi0b)) - 
             48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) - 
             16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) - 
             192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) - 
             192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) - 
             192*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              sin(2*(phi0a - phi0b)) - 
             704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              sin(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) - 
             704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             192*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              sin(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              sin(2*(phi0a - phi0b)) + 6*curva*curvb*sin(3*(phi0a - phi0b)) + 
             36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) + 
             72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) + 
             48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) + 
             36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              sin(3*(phi0a - phi0b)) + 
             432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(3*(phi0a - phi0b)) + 
             288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(3*(phi0a - phi0b)) + 
             72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) + 
             432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(3*(phi0a - phi0b)) + 
             864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(3*(phi0a - phi0b)) + 
             576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(3*(phi0a - phi0b)) + 
             48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) + 
             288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(3*(phi0a - phi0b)) + 
             576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(3*(phi0a - phi0b)) + 
             384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(3*(phi0a - phi0b)) - 2*curva*curvb*sin(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              sin(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              sin(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              sin(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              sin(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              sin(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              sin(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(3*phi0a - phi0b) + 4*pow(curva,2)*sin(2*phi0b) - 
             2*pow(curvb,2)*sin(2*phi0b) - 
             16*curva*pow(curvb,2)*d0a*sin(2*phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*sin(2*phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*sin(2*phi0b) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*sin(2*phi0b) - 
             16*pow(curva,2)*curvb*d0b*sin(2*phi0b) - 
             8*pow(curvb,3)*d0b*sin(2*phi0b) - 
             128*pow(curva,3)*curvb*d0a*d0b*sin(2*phi0b) - 
             64*curva*pow(curvb,3)*d0a*d0b*sin(2*phi0b) - 
             128*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*phi0b) - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              sin(2*phi0b) - 512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*sin(2*phi0b) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              sin(2*phi0b) - 32*pow(curva,4)*pow(d0b,2)*sin(2*phi0b) - 
             144*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*sin(2*phi0b) - 
             8*pow(curvb,4)*pow(d0b,2)*sin(2*phi0b) - 
             640*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              sin(2*phi0b) - 64*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              sin(2*phi0b) - 640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*sin(2*phi0b) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              sin(2*phi0b) - 512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*sin(2*phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              sin(2*phi0b) - 192*pow(curva,4)*curvb*pow(d0b,3)*
              sin(2*phi0b) - 256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              sin(2*phi0b) - 1024*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*sin(2*phi0b) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              sin(2*phi0b) - 416*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              sin(2*phi0b) - 128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              sin(2*phi0b) - 512*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*sin(2*phi0b) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              sin(2*phi0b) - 384*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              sin(2*phi0b) - 128*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              sin(2*phi0b) - 4*curva*curvb*sin(phi0a + phi0b) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
             32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              sin(phi0a + phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              sin(phi0a + phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              sin(phi0a + phi0b) + 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(phi0a + phi0b) + 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(phi0a + phi0b) + 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              sin(phi0a + phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              sin(phi0a + phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              sin(phi0a + phi0b) + 
             32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(phi0a + phi0b) + 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(phi0a + phi0b) + 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(phi0a + phi0b) + 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              sin(phi0a + phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              sin(phi0a + phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              sin(phi0a + phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              sin(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2))/
        (2.*sqrt(4/pow(curvb,2) - 
            (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
            (4*(1 + 2*curvb*d0b)*cos(phi0b)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
             (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                 pow(curva,2)*
                  (1 + 4*curvb*d0b + 
                    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                 2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b))) - 
            (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2) - 
            (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b)) - 
            (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2))))/4. );
   double dxdcurvb( ((2*sin(phi0b))/pow(curvb,2) + 
       (-8/pow(curvb,3) - (16*d0b*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/
           pow(curvb,2) + (8*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
           pow(curvb,3) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*(8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*
                  cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                  pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
               2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (4*(1 + 2*curvb*d0b)*(2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)) - 
          (8*d0b*cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (pow(curvb,2)*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) - 
          (4*curvb - 64*pow(curva,2)*curvb*pow(d0a,2) - 
             128*pow(curva,3)*curvb*pow(d0a,3) - 
             64*pow(curva,4)*curvb*pow(d0a,4) - 
             64*pow(curva,3)*d0a*d0b - 192*curva*pow(curvb,2)*d0a*d0b - 
             64*pow(curva,4)*pow(d0a,2)*d0b - 
             960*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b - 
             1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b - 
             768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b - 
             64*pow(curva,2)*curvb*pow(d0b,2) - 
             640*pow(curva,3)*curvb*d0a*pow(d0b,2) - 
             256*curva*pow(curvb,3)*d0a*pow(d0b,2) - 
             640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2) - 
             1280*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2) - 
             2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2) - 
             192*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
             1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3) - 
             1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,4) - 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-4*curvb + 64*pow(curvb,3)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (4*d0b + 4*curvb*(pow(d0a,2) + 2*pow(d0b,2))) + 
                32*curva*curvb*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(8*d0b + 
                   192*pow(curvb,2)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   16*curvb*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   64*pow(curvb,3)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2)))*
              cos(phi0a - 3*phi0b) - 
             12*curva*(1 + 2*curva*d0a)*d0b*pow(1 + 2*curvb*d0b,2)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             8*pow(curva,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
             48*pow(curva,2)*curvb*pow(d0b,2)*cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,3)*curvb*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 2*curvb*cos(4*phi0a - 2*phi0b) + 
             16*curva*curvb*d0a*cos(4*phi0a - 2*phi0b) + 
             48*pow(curva,2)*curvb*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,3)*curvb*pow(d0a,3)*cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,4)*cos(4*phi0a - 2*phi0b) + 
             12*pow(curvb,2)*d0b*cos(4*phi0a - 2*phi0b) + 
             96*curva*pow(curvb,2)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             288*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curvb,3)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             128*curva*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*cos(phi0a - phi0b) + 
             12*pow(curva,2)*d0a*cos(phi0a - phi0b) + 
             24*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             168*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*pow(d0a,3)*cos(phi0a - phi0b) + 
             432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
              cos(phi0a - phi0b) + 24*curva*curvb*d0b*cos(phi0a - phi0b) + 
             432*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
             64*pow(curvb,3)*d0a*d0b*cos(phi0a - phi0b) + 
             1152*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             448*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             768*pow(curva,4)*curvb*pow(d0a,3)*d0b*cos(phi0a - phi0b) + 
             1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             144*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             1728*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             4320*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             2880*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             288*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a - phi0b) + 
             128*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a - phi0b) + 
             576*pow(curva,4)*curvb*d0a*pow(d0b,3)*cos(phi0a - phi0b) + 
             1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             3840*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             2560*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 4*curvb*cos(2*(phi0a - phi0b)) - 
             48*curva*curvb*d0a*cos(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*curvb*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*curvb*pow(d0a,3)*cos(2*(phi0a - phi0b)) - 
             128*pow(curva,4)*curvb*pow(d0a,4)*cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*d0b*cos(2*(phi0a - phi0b)) - 
             24*pow(curvb,2)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             288*curva*pow(curvb,2)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
             1056*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*curvb*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             32*pow(curvb,3)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             704*pow(curva,3)*curvb*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             384*curva*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             704*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1408*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             24*curva*curvb*d0b*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*curvb*d0a*d0b*cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*curvb*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*curvb*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             168*curva*pow(curvb,2)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             24*curva*curvb*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*curvb*d0a*d0b*cos(3*phi0a - phi0b) - 
             64*pow(curvb,3)*d0a*d0b*cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             448*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*curvb*pow(d0a,3)*d0b*cos(3*phi0a - phi0b) - 
             1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) + 2*curvb*cos(2*phi0b) + 
             16*curva*curvb*d0a*cos(2*phi0b) + 
             80*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0b) + 
             128*pow(curva,3)*curvb*pow(d0a,3)*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*d0b*cos(2*phi0b) + 
             12*pow(curvb,2)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*d0a*d0b*cos(2*phi0b) + 
             96*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*pow(d0a,2)*d0b*cos(2*phi0b) + 
             480*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 768*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 144*pow(curva,2)*curvb*pow(d0b,2)*
              cos(2*phi0b) + 16*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
             640*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(2*phi0b) + 
             128*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(2*phi0b) + 
             640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 640*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(2*phi0b) + 512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
              pow(d0b,2)*cos(2*phi0b) + 
             96*pow(curva,4)*pow(d0b,3)*cos(2*phi0b) + 
             384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
             1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(2*phi0b) + 1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,3)*cos(2*phi0b) + 
             416*pow(curva,4)*curvb*pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(2*phi0b) + 1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
              pow(d0b,4)*cos(2*phi0b) + 
             576*pow(curva,4)*pow(curvb,2)*pow(d0b,5)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,3)*pow(d0b,6)*cos(2*phi0b) + 
             4*curva*cos(phi0a + phi0b) - 
             24*pow(curva,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             96*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*pow(d0a,3)*cos(phi0a + phi0b) - 
             384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
             480*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             256*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             320*pow(curva,4)*curvb*pow(d0a,3)*d0b*cos(phi0a + phi0b) - 
             1024*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             72*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             720*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             1728*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             1152*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             256*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a + phi0b) - 
             64*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a + phi0b) - 
             512*pow(curva,4)*curvb*d0a*pow(d0b,3)*cos(phi0a + phi0b) - 
             640*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (2*(2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *(2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b)))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
             (2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                     4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (8*sqrt(2)*pow(curva,2)*curvb*d0b*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (4*sqrt(2)*pow(curva,2)*(1 + 2*curvb*d0b)*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*(8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*
                  cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                  pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
               2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) - 
          (4*sqrt(2)*pow(curva,2)*curvb*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,4)*pow(curvb,4)) - 
               ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                    16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                    32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                    8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                    64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                    16*pow(curva,2)*pow(d0b,3) + 
                    16*pow(curva,2)*curvb*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                     cos(phi0a - phi0b) - 
                    16*(1 + 2*curva*d0a)*d0b*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)) + 
               (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,5))))/
           ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) - 
          (sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,4)*pow(curvb,4)) - 
               ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                    16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                    32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                    8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                    64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                    16*pow(curva,2)*pow(d0b,3) + 
                    16*pow(curva,2)*curvb*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                     cos(phi0a - phi0b) - 
                    16*(1 + 2*curva*d0a)*d0b*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)) + 
               (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,5))))/
           (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))))/
        (2.*sqrt(4/pow(curvb,2) - 
            (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
            (4*(1 + 2*curvb*d0b)*cos(phi0b)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
             (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                 pow(curva,2)*
                  (1 + 4*curvb*d0b + 
                    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                 2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b))) - 
            (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2) - 
            (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b)) - 
            (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2))))/4. );

   double dydd0a( ((4*curva*pow(curvb,2) + 
          8*pow(curva,2)*pow(curvb,2)*d0a - 
          4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (-2*pow(curva,2)*cos(phi0a) - 
        4*pow(curvb,2)*cos(phi0a) - 
        24*curva*pow(curvb,2)*d0a*cos(phi0a) - 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
        2*pow(curva,2)*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0b*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        4*curva*curvb*cos(2*phi0a - phi0b) + 
        8*pow(curva,2)*curvb*d0a*cos(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydphi0a( (curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
        sin(phi0a - phi0b)*(-(curva*cos(phi0a)) - 
          2*pow(curva,2)*d0a*cos(phi0a) - 4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (curva*sin(phi0a) + 2*pow(curva,2)*d0a*sin(phi0a) + 
        4*pow(curvb,2)*d0a*sin(phi0a) + 
        12*curva*pow(curvb,2)*pow(d0a,2)*sin(phi0a) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*sin(phi0a) - 
        curva*sin(phi0a - 2*phi0b) - 
        2*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) - 
        4*curva*curvb*d0b*sin(phi0a - 2*phi0b) - 
        8*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) - 
        4*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) - 2*curvb*sin(2*phi0a - phi0b) - 
        8*curva*curvb*d0a*sin(2*phi0a - phi0b) - 
        8*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) - 
        4*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) - 
        16*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurva( ((4*pow(curvb,2)*d0a + 
          2*curva*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
          2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (-cos(phi0a) - 4*curva*d0a*cos(phi0a) - 
        12*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
        16*curva*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
        cos(phi0a - 2*phi0b) + 4*curva*d0a*cos(phi0a - 2*phi0b) + 
        4*curvb*d0b*cos(phi0a - 2*phi0b) + 
        16*curva*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
        4*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        16*curva*pow(curvb,2)*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        4*curvb*d0a*cos(2*phi0a - phi0b) + 
        8*curva*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        8*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        16*curva*pow(curvb,2)*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) - 
        8*curva*d0b*cos(phi0b) - 24*curva*curvb*pow(d0b,2)*cos(phi0b) - 
        16*curva*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*curva*pow(curvb,2)*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydd0b( ((pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
          4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (4*curva*curvb*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0a*cos(phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*d0b*cos(phi0a - 2*phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - 2*phi0b) + 
        2*pow(curvb,2)*cos(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0a - phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0a - phi0b) - 
        4*pow(curva,2)*cos(phi0b) - 2*pow(curvb,2)*cos(phi0b) - 
        24*pow(curva,2)*curvb*d0b*cos(phi0b) - 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curvb + 32*curva*curvb*d0a + 
                  32*pow(curva,2)*curvb*pow(d0a,2) + 
                  16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                  64*curva*pow(curvb,2)*d0a*d0b + 
                  64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                  48*pow(curva,2)*curvb*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                  16*curvb*(1 + 2*curva*d0a)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
	 )) );
   double dydphi0b( -(curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
         sin(phi0a - phi0b)*(-(curva*cos(phi0a)) - 
           2*pow(curva,2)*d0a*cos(phi0a) - 
           4*pow(curvb,2)*d0a*cos(phi0a) - 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
           curva*cos(phi0a - 2*phi0b) + 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
           4*pow(curva,2)*d0b*cos(phi0b) - 
           2*pow(curvb,2)*d0b*cos(phi0b) - 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (2*curva*sin(phi0a - 2*phi0b) + 
        4*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) + 
        8*curva*curvb*d0b*sin(phi0a - 2*phi0b) + 
        16*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) + curvb*sin(2*phi0a - phi0b) + 
        4*curva*curvb*d0a*sin(2*phi0a - phi0b) + 
        4*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) + 
        2*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) + 
        8*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) + curvb*sin(phi0b) + 
        4*pow(curva,2)*d0b*sin(phi0b) + 2*pow(curvb,2)*d0b*sin(phi0b) + 
        12*pow(curva,2)*curvb*pow(d0b,2)*sin(phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*sin(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((2*(1 + 2*curvb*d0b)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*cos(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,4)) - 
             ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) + 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurvb( ((2*curvb + 8*curva*curvb*d0a + 
          pow(curva,2)*(4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
          4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
          2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
        (-(curva*cos(phi0a)) - 2*pow(curva,2)*d0a*cos(phi0a) - 
          4*pow(curvb,2)*d0a*cos(phi0a) - 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) + 
          curva*cos(phi0a - 2*phi0b) + 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) + 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) + 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) + curvb*cos(2*phi0a - phi0b) + 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) + 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) + 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) + 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) - curvb*cos(phi0b) - 
          4*pow(curva,2)*d0b*cos(phi0b) - 2*pow(curvb,2)*d0b*cos(phi0b) - 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) - (-8*curvb*d0a*cos(phi0a) - 
        24*curva*curvb*pow(d0a,2)*cos(phi0a) - 
        16*pow(curva,2)*curvb*pow(d0a,3)*cos(phi0a) + 
        4*curva*d0b*cos(phi0a - 2*phi0b) + 
        8*pow(curva,2)*d0a*d0b*cos(phi0a - 2*phi0b) + 
        8*curva*curvb*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        16*pow(curva,2)*curvb*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) + 
        cos(2*phi0a - phi0b) + 4*curva*d0a*cos(2*phi0a - phi0b) + 
        4*pow(curva,2)*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        4*curvb*d0b*cos(2*phi0a - phi0b) + 
        16*curva*curvb*d0a*d0b*cos(2*phi0a - phi0b) + 
        16*pow(curva,2)*curvb*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) - 
        cos(phi0b) - 4*curvb*d0b*cos(phi0b) - 
        12*pow(curva,2)*pow(d0b,2)*cos(phi0b) - 
        16*pow(curva,2)*curvb*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*pow(curva,2)*curvb*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                  16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                  32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                  8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                  64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                  16*pow(curva,2)*pow(d0b,3) + 
                  16*pow(curva,2)*curvb*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                   cos(phi0a - phi0b) - 
                  16*(1 + 2*curva*d0a)*d0b*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,5))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );

   ex = sqrt( ed0ad0a * sqr( dxdd0a ) +
	      ephi0aphi0a * sqr( dxdphi0a ) +
	      ecurvacurva * sqr( dxdcurva ) +
	      2 * ed0acurva * dxdd0a * dxdcurva +
	      2 * ed0aphi0a * dxdd0a * dxdphi0a +
	      2 * ecurvaphi0a * dxdcurva * dxdphi0a +
	      ed0bd0b * sqr( dxdd0b ) +
	      ephi0bphi0b * sqr( dxdphi0b ) +
	      ecurvbcurvb * sqr( dxdcurvb ) +
	      2 * ed0bcurvb * dxdd0b * dxdcurvb +
	      2 * ed0bphi0b * dxdd0b * dxdphi0b +
	      2 * ecurvbphi0b * dxdcurvb * dxdphi0b );

   ey = sqrt( ed0ad0a * sqr( dydd0a ) +
	      ephi0aphi0a * sqr( dydphi0a ) +
	      ecurvacurva * sqr( dydcurva ) +
	      2 * ed0acurva * dydd0a * dydcurva +
	      2 * ed0aphi0a * dydd0a * dydphi0a +
	      2 * ecurvaphi0a * dydcurva * dydphi0a +
	      ed0bd0b * sqr( dydd0b ) +
	      ephi0bphi0b * sqr( dydphi0b ) +
	      ecurvbcurvb * sqr( dydcurvb ) +
	      2 * ed0bcurvb * dydd0b * dydcurvb +
	      2 * ed0bphi0b * dydd0b * dydphi0b +
	      2 * ecurvbphi0b * dydcurvb * dydphi0b );

   return true;
}

DABoolean BigNTuple::sol4( KTHelix& a, KTHelix& b, double& x, double& y )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double sqrtarg1( 4/pow(curvb,2) - (4*pow(1 + 2*curvb*d0b,2)*
        pow(cos(phi0b),2))/pow(curvb,2) - 
     (4*(1 + 2*curvb*d0b)*cos(phi0b)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
      (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) - (2*pow(curva,2) + 2*pow(curvb,2) - 
        32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
        64*pow(curva,3)*curvb*d0a*d0b - 64*curva*pow(curvb,3)*d0a*d0b - 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
        320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
        32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
        64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
        320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
        64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
        32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
        pow(1 + 2*curva*d0a,2)*
         (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*d0a*
            (1 + 4*curvb*d0b + 2*pow(curvb,2)*
               (pow(d0a,2) + 2*pow(d0b,2))) + 
           pow(curva,2)*(1 + 8*curvb*d0b + 
              64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
              8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
              16*pow(curvb,4)*
               (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))))
          *cos(2*phi0a) - 2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
         (4*pow(curva,2)*d0b + 
           curvb*(1 + 4*curva*d0a + 
              4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
         cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
        4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
        4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
        8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - 2*phi0b)) + 
        32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - 2*phi0b)) + 
        16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + 
        64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - 2*phi0b)) + pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
         cos(4*phi0a - 2*phi0b) + 
        32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
         cos(4*phi0a - 2*phi0b) + 
        16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
         cos(4*phi0a - 2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
        96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(4*phi0a - 2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
        96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) + 
        128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
        12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
        8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
        48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
        32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a - phi0b) + 
        8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
        12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
        16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
        216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
        16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
        576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a - phi0b) + 112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a - phi0b) + 384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a - phi0b) + 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a - phi0b) + 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a - phi0b) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a - phi0b) + 56*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a - phi0b) + 48*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a - phi0b) + 112*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a - phi0b) + 576*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a - phi0b) + 
        1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a - phi0b) + 960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a - phi0b) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
        32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
        288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a - phi0b) + 384*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a - phi0b) + 
        960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a - phi0b) + 640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a - phi0b) + 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a - phi0b) + 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a - phi0b) + 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a - phi0b) - 
        2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
        2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
        8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
        24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
        8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
         cos(2*(phi0a - phi0b)) - 
        24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
        96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
        96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
         cos(2*(phi0a - phi0b)) - 
        88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
        352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
         cos(2*(phi0a - phi0b)) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*(phi0a - phi0b)) - 
        64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) - 
        256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
         cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
        12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
        12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*(phi0a - phi0b)) + 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*(phi0a - phi0b)) + 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*(phi0a - phi0b)) + 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) + 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
        12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
        8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(3*phi0a - phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(3*phi0a - phi0b) - 
        12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
        72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
        16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
        144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(3*phi0a - phi0b) - 
        112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
        96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(3*phi0a - phi0b) - 
        320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(3*phi0a - phi0b) - 
        24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
        144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
         cos(3*phi0a - phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
        96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
         cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
        pow(curvb,2)*cos(2*phi0b) + 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
        40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
        64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
        32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
        8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
        4*pow(curvb,3)*d0b*cos(2*phi0b) + 
        64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
        32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
        64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
        160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
        128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
        16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
        72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
        4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
        320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
         cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,2)*cos(2*phi0b) + 
        256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
         cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
         pow(d0b,2)*cos(2*phi0b) + 
        96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
        128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
        512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
         cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
         cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
         cos(2*phi0b) + 256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
         pow(d0b,4)*cos(2*phi0b) + 
        192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*cos(2*phi0b) + 
        64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*cos(2*phi0b) + 
        4*curva*curvb*cos(phi0a + phi0b) - 
        24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
        32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
        16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
        128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
        64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*cos(phi0a + phi0b) - 
        80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
        240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 64*curva*pow(curvb,4)*pow(d0a,2)*d0b*
         cos(phi0a + phi0b) - 160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
         d0b*cos(phi0a + phi0b) - 
        256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
         cos(phi0a + phi0b) - 320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
         d0b*cos(phi0a + phi0b) - 
        128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
         cos(phi0a + phi0b) - 32*pow(curva,3)*curvb*pow(d0b,2)*
         cos(phi0a + phi0b) - 24*curva*pow(curvb,3)*pow(d0b,2)*
         cos(phi0a + phi0b) - 64*pow(curva,4)*curvb*d0a*pow(d0b,2)*
         cos(phi0a + phi0b) - 240*pow(curva,2)*pow(curvb,3)*d0a*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
         cos(phi0a + phi0b) - 384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*
         pow(d0b,2)*cos(phi0a + phi0b) - 
        128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
        16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
        256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
         cos(phi0a + phi0b) - 160*pow(curva,2)*pow(curvb,4)*d0a*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
         cos(phi0a + phi0b) - 256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
         pow(d0b,3)*cos(phi0a + phi0b) - 
        160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
        320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
         cos(phi0a + phi0b) - 64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
         cos(phi0a + phi0b) - 128*pow(curva,4)*pow(curvb,4)*d0a*
         pow(d0b,5)*cos(phi0a + phi0b))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) + (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))\
      + (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
        (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
          (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - 2*phi0b) + 
             curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
             (curvb + 4*pow(curva,2)*d0b + 
                4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
        sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                8*pow(curvb,2)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*pow(d0a,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                32*curva*curvb*d0a*d0b + 
                32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                8*pow(curva,2)*pow(d0b,2) + 
                4*pow(curvb,2)*pow(d0b,2) + 
                32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                16*pow(curva,2)*curvb*pow(d0b,3) + 
                8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                 (curva*d0b + curvb*
                    (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                 cos(phi0a - phi0b) + 
                pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                 cos(2*(phi0a - phi0b)))*
              pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
            (pow(curva,4)*pow(curvb,4)))))/
      pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
        pow(curva,2)*(1 + 4*curvb*d0b + 
           4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
        2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b),
       2) );
   double sqrtarg2( -(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
           8*pow(curvb,2)*pow(d0a,2) + 
           16*curva*pow(curvb,2)*pow(d0a,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
           32*curva*curvb*d0a*d0b + 
           32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
           8*pow(curva,2)*pow(d0b,2) + 4*pow(curvb,2)*pow(d0b,2) + 
           32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
           32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
           16*pow(curva,2)*curvb*pow(d0b,3) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
           8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
            (curva*d0b + curvb*
               (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
            cos(phi0a - phi0b) + 
           pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
            cos(2*(phi0a - phi0b)))*
         pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
           curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
       (pow(curva,4)*pow(curvb,4))) );

   if ( sqrtarg1 < 0.  ||  sqrtarg2 < 0. ) return false;

   x = (sqrt(sqrtarg1) - (2*sin(phi0b))/curvb - 4*d0b*sin(phi0b))/4.;
   y = (sqrt(2)*pow(curva,2)*pow(curvb,2)*sqrt(sqrtarg2) + 
       curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
       4*pow(curvb,2)*d0a*cos(phi0a) + 
       12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
       8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
       curva*cos(phi0a - 2*phi0b) - 
       2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
       4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
       8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
       4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
       8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
        cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
       4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
       4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
       2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
       8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
       8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
        cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
       4*pow(curva,2)*d0b*cos(phi0b) + 2*pow(curvb,2)*d0b*cos(phi0b) + 
       12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
       8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b))/
     (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
         pow(curva,2)*(1 + 4*curvb*d0b + 
            4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
         2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
       );

   return true;
}

DABoolean BigNTuple::errsol4( KTHelix& a, KTHelix& b, double& ex, double& ey )
{
   double d0a( a.d0() );
   double curva( a.curvature() );
   double phi0a( a.phi0() );
   double d0b( b.d0() );
   double curvb( b.curvature() );
   double phi0b( b.phi0() );

   double ed0ad0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0acurva( a.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0aphi0a( a.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvacurva( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvaphi0a( a.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0aphi0a( a.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double ed0bd0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kD0 ) );
   double ed0bcurvb( b.errorMatrix()( KTHelix::kD0, KTHelix::kCurvature ) );
   double ed0bphi0b( b.errorMatrix()( KTHelix::kD0, KTHelix::kPhi0 ) );
   double ecurvbcurvb( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kCurvature ) );
   double ecurvbphi0b( b.errorMatrix()( KTHelix::kCurvature, KTHelix::kPhi0 ) );
   double ephi0bphi0b( b.errorMatrix()( KTHelix::kPhi0, KTHelix::kPhi0 ) );

   double dxdd0a( ((-4*(1 + 2*curvb*d0b)*
          (-((1 + 2*curva*d0a)*(4*pow(curvb,2) + 
                 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
            2*curva*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
          cos(phi0b))/
        (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))) + 
       (4*(1 + 2*curvb*d0b)*(4*curva*pow(curvb,2) + 
            8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
        (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)) - 
       (-64*pow(curva,2)*pow(curvb,2)*d0a - 
          192*pow(curva,3)*pow(curvb,2)*pow(d0a,2) - 
          128*pow(curva,4)*pow(curvb,2)*pow(d0a,3) - 
          64*pow(curva,3)*curvb*d0b - 64*curva*pow(curvb,3)*d0b - 
          128*pow(curva,4)*curvb*d0a*d0b - 
          640*pow(curva,2)*pow(curvb,3)*d0a*d0b - 
          1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b - 
          1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b - 
          320*pow(curva,3)*pow(curvb,2)*pow(d0b,2) - 
          64*curva*pow(curvb,4)*pow(d0b,2) - 
          640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2) - 
          640*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2) - 
          1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
          1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
          512*pow(curva,3)*pow(curvb,3)*pow(d0b,3) - 
          1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3) - 
          256*pow(curva,3)*pow(curvb,4)*pow(d0b,4) - 
          512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4) + 
          pow(1 + 2*curva*d0a,2)*
           (32*pow(curvb,4)*d0a + 64*curva*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(32*pow(curvb,2)*d0a + 
                128*pow(curvb,3)*d0a*d0b + 
                16*pow(curvb,4)*(4*pow(d0a,3) + 8*d0a*pow(d0b,2))))*
           cos(2*phi0a) + 4*curva*(1 + 2*curva*d0a)*
           (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*cos(2*phi0a) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(4*curva + 8*pow(curva,2)*d0a)*
           pow(1 + 2*curvb*d0b,3)*cos(phi0a - 3*phi0b) - 
          4*pow(curva,2)*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) + 4*pow(curva,3)*cos(2*(phi0a - 2*phi0b)) + 
          8*pow(curva,4)*d0a*cos(2*(phi0a - 2*phi0b)) + 
          32*pow(curva,3)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
          64*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
          96*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          192*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          128*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          256*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          64*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          8*curva*pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
          48*pow(curva,2)*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
          96*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
           cos(4*phi0a - 2*phi0b) + 
          64*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
           cos(4*phi0a - 2*phi0b) + 
          32*curva*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
          192*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          32*curva*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
          192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          12*pow(curva,2)*curvb*cos(phi0a - phi0b) + 
          8*pow(curvb,3)*cos(phi0a - phi0b) + 
          96*pow(curva,3)*curvb*d0a*cos(phi0a - phi0b) + 
          112*curva*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
          96*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
          640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
          320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
          16*pow(curva,4)*d0b*cos(phi0a - phi0b) + 
          216*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
          16*pow(curvb,4)*d0b*cos(phi0a - phi0b) + 
          1152*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
          224*curva*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
          1152*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a - phi0b) + 
          864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
           cos(phi0a - phi0b) + 
          1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
           cos(phi0a - phi0b) + 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a - phi0b) + 
          112*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
          576*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
          2880*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          2880*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          288*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
          384*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
          1920*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          1920*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
          128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(phi0a - phi0b) - 
          8*pow(curva,3)*cos(2*(phi0a - phi0b)) - 
          24*curva*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
          16*pow(curva,4)*d0a*cos(2*(phi0a - phi0b)) - 
          176*pow(curva,2)*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
           cos(2*(phi0a - phi0b)) - 
          256*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
           cos(2*(phi0a - phi0b)) - 
          96*pow(curva,3)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
          96*curva*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
          192*pow(curva,4)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          704*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(2*(phi0a - phi0b)) - 
          352*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          96*curva*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
          704*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          704*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) - 
          512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) + 
          12*pow(curva,2)*curvb*cos(3*(phi0a - phi0b)) + 
          48*pow(curva,3)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
          48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
          72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
          288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*(phi0a - phi0b)) + 
          144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) + 
          384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) + 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) - 
          12*pow(curva,2)*curvb*cos(3*phi0a - phi0b) - 
          8*pow(curvb,3)*cos(3*phi0a - phi0b) - 
          48*pow(curva,3)*curvb*d0a*cos(3*phi0a - phi0b) - 
          112*curva*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
          48*pow(curva,4)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
          432*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
           cos(3*phi0a - phi0b) - 
          640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
           cos(3*phi0a - phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
           cos(3*phi0a - phi0b) - 
          72*pow(curva,2)*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
          16*pow(curvb,4)*d0b*cos(3*phi0a - phi0b) - 
          288*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
          224*curva*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*phi0a - phi0b) - 
          864*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
           cos(3*phi0a - phi0b) - 
          1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
           cos(3*phi0a - phi0b) - 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(3*phi0a - phi0b) - 
          144*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          576*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          96*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 
          384*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*phi0a - phi0b) + 8*curva*pow(curvb,2)*cos(2*phi0b) + 
          80*pow(curva,2)*pow(curvb,2)*d0a*cos(2*phi0b) + 
          192*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
          128*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
          64*pow(curva,3)*curvb*d0b*cos(2*phi0b) + 
          32*curva*pow(curvb,3)*d0b*cos(2*phi0b) + 
          128*pow(curva,4)*curvb*d0a*d0b*cos(2*phi0b) + 
          320*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
          768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
          512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
          320*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
          32*curva*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
          640*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          320*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          768*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*phi0b) + 512*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*
           pow(d0b,2)*cos(2*phi0b) + 
          512*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
          1024*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
          256*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
          512*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*cos(2*phi0b) - 
          48*pow(curva,3)*curvb*d0a*cos(phi0a + phi0b) - 
          64*curva*pow(curvb,3)*d0a*cos(phi0a + phi0b) - 
          48*pow(curva,4)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
          384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
          640*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
          80*pow(curva,2)*pow(curvb,2)*d0b*cos(phi0a + phi0b) - 
          480*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
          128*curva*pow(curvb,4)*d0a*d0b*cos(phi0a + phi0b) - 
          480*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a + phi0b) - 
          768*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
           cos(phi0a + phi0b) - 
          1280*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
           cos(phi0a + phi0b) - 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a + phi0b) - 
          64*pow(curva,4)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
          240*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
          1152*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          1152*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          256*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
          160*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
          768*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          768*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
          128*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(phi0a + phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (2*(4*curva*pow(curvb,2) + 
            8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b)))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) + (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(4*pow(curvb,2) + 
                 8*curva*pow(curvb,2)*d0a)*cos(phi0a)) - 
            2*curva*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*pow(curva,2)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               4*curva*curvb*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
          (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                  4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (4*curva*pow(curvb,2) + 8*pow(curva,2)*pow(curvb,2)*d0a - 
            4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) + (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*sin(phi0a)*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,3)*pow(curvb,3)) - 
            ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                 48*curva*pow(curvb,2)*pow(d0a,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                 32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                 32*curva*pow(curvb,2)*pow(d0b,2) + 
                 64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                 8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b) - 
                 16*curva*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) + 
       (sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*sin(phi0a)*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,3)*pow(curvb,3)) - 
            ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                 48*curva*pow(curvb,2)*pow(d0a,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                 32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                 32*curva*pow(curvb,2)*pow(d0b,2) + 
                 64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                 8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b) - 
                 16*curva*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) + 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) + 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdphi0a( ((8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
          cos(phi0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sin(phi0a - phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
          (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))*sin(phi0a - phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
            (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  sin(phi0a - 2*phi0b)) - 
               2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b))))/
        (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))) - 
       (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
          pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
          (1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sin(phi0a - phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                  4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) + (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          ((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*sin(phi0a) + 
            (1 + 2*curvb*d0b)*(-(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  sin(phi0a - 2*phi0b)) - 
               2*curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
               (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,3)) - 
            ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  sin(phi0a - phi0b) - 
                 2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  sin(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) + 
       (sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
               (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,3)) - 
            ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  sin(phi0a - phi0b) - 
                 2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  sin(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4))))/
        (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) - 
       (-2*pow(1 + 2*curva*d0a,2)*
           (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*sin(2*phi0a) + 
          2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           sin(phi0a - 3*phi0b) - 2*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) - 
          8*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) - 
          8*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) - 
          16*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) - 
          64*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) - 
          64*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*(phi0a - 2*phi0b)) - 
          48*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
           sin(2*(phi0a - 2*phi0b)) - 
          192*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
           sin(2*(phi0a - 2*phi0b)) - 
          192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           sin(2*(phi0a - 2*phi0b)) - 
          64*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
           sin(2*(phi0a - 2*phi0b)) - 
          256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
           sin(2*(phi0a - 2*phi0b)) - 
          256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           sin(2*(phi0a - 2*phi0b)) - 
          32*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
           sin(2*(phi0a - 2*phi0b)) - 
          128*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
           sin(2*(phi0a - 2*phi0b)) - 
          128*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           sin(2*(phi0a - 2*phi0b)) - 
          4*pow(curvb,2)*sin(4*phi0a - 2*phi0b) - 
          32*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) - 
          96*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
           sin(4*phi0a - 2*phi0b) - 
          128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
           sin(4*phi0a - 2*phi0b) - 
          64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
           sin(4*phi0a - 2*phi0b) - 
          16*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) - 
          128*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) - 
          384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
           sin(4*phi0a - 2*phi0b) - 
          512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
           sin(4*phi0a - 2*phi0b) - 
          256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
           sin(4*phi0a - 2*phi0b) - 
          16*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
          128*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(4*phi0a - 2*phi0b) - 
          384*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           sin(4*phi0a - 2*phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           sin(4*phi0a - 2*phi0b) - 
          256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           sin(4*phi0a - 2*phi0b) + 2*curva*curvb*sin(phi0a - phi0b) - 
          12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) - 
          8*pow(curvb,3)*d0a*sin(phi0a - phi0b) - 
          48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) - 
          56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) - 
          32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) - 
          144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*sin(phi0a - phi0b) - 
          160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*sin(phi0a - phi0b) - 
          64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a - phi0b) - 
          8*pow(curva,3)*d0b*sin(phi0a - phi0b) - 
          12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) - 
          16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) - 
          216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a - phi0b) - 
          16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) - 
          576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(phi0a - phi0b) - 
          112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a - phi0b) - 
          384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(phi0a - phi0b) - 
          288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
           sin(phi0a - phi0b) - 
          320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
           sin(phi0a - phi0b) - 
          128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
           sin(phi0a - phi0b) - 
          56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) - 
          48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) - 
          112*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a - phi0b) - 
          576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(phi0a - phi0b) - 
          1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(phi0a - phi0b) - 
          960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(phi0a - phi0b) - 
          144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*sin(phi0a - phi0b) - 
          32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) - 
          288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(phi0a - phi0b) - 
          160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*sin(phi0a - phi0b) - 
          320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
           sin(phi0a - phi0b) - 
          64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a - phi0b) - 
          128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
           sin(phi0a - phi0b) + 4*pow(curva,2)*sin(2*(phi0a - phi0b)) + 
          4*pow(curvb,2)*sin(2*(phi0a - phi0b)) + 
          16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) + 
          48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) + 
          16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) + 
          176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
           sin(2*(phi0a - phi0b)) + 
          256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
           sin(2*(phi0a - phi0b)) + 
          128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
           sin(2*(phi0a - phi0b)) + 
          48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) + 
          16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) + 
          192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) + 
          192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) + 
          192*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*(phi0a - phi0b)) + 
          704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
           sin(2*(phi0a - phi0b)) + 
          176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
          704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          192*curva*pow(curvb,4)*d0a*pow(d0b,2)*sin(2*(phi0a - phi0b)) + 
          704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           sin(2*(phi0a - phi0b)) + 
          256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
           sin(2*(phi0a - phi0b)) + 
          1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           sin(2*(phi0a - phi0b)) + 
          128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
           sin(2*(phi0a - phi0b)) + 
          512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           sin(2*(phi0a - phi0b)) - 6*curva*curvb*sin(3*(phi0a - phi0b)) - 
          36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) - 
          72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) - 
          48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) - 
          36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) - 
          216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*(phi0a - phi0b)) - 
          432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(3*(phi0a - phi0b)) - 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(3*(phi0a - phi0b)) - 
          72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) - 
          432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(3*(phi0a - phi0b)) - 
          864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(3*(phi0a - phi0b)) - 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(3*(phi0a - phi0b)) - 
          48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) - 
          288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(3*(phi0a - phi0b)) - 
          576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(3*(phi0a - phi0b)) - 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(3*(phi0a - phi0b)) + 6*curva*curvb*sin(3*phi0a - phi0b) + 
          36*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) + 
          24*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) + 
          72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) + 
          168*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) + 
          48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
           sin(3*phi0a - phi0b) + 
          480*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
           sin(3*phi0a - phi0b) + 
          192*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
           sin(3*phi0a - phi0b) + 
          36*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) + 
          216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*phi0a - phi0b) + 
          48*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) + 
          432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(3*phi0a - phi0b) + 
          336*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(3*phi0a - phi0b) + 
          288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(3*phi0a - phi0b) + 
          864*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
           sin(3*phi0a - phi0b) + 
          960*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
           sin(3*phi0a - phi0b) + 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
           sin(3*phi0a - phi0b) + 
          72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(3*phi0a - phi0b) + 
          864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(3*phi0a - phi0b) + 
          576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(3*phi0a - phi0b) + 
          48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) + 
          288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(3*phi0a - phi0b) + 
          576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(3*phi0a - phi0b) + 
          384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(3*phi0a - phi0b) - 4*curva*curvb*sin(phi0a + phi0b) + 
          24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
          32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
          16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
          128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*sin(phi0a + phi0b) + 
          160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*sin(phi0a + phi0b) + 
          64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*sin(phi0a + phi0b) + 
          80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
          240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
           sin(phi0a + phi0b) + 
          64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
          160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
           sin(phi0a + phi0b) + 
          256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
           sin(phi0a + phi0b) + 
          320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
           sin(phi0a + phi0b) + 
          128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
           sin(phi0a + phi0b) + 
          32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
          24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
          64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
          240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
           sin(phi0a + phi0b) + 
          576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           sin(phi0a + phi0b) + 
          384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           sin(phi0a + phi0b) + 
          128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*sin(phi0a + phi0b) + 
          16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
          256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           sin(phi0a + phi0b) + 
          160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*sin(phi0a + phi0b) + 
          320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
           sin(phi0a + phi0b) + 
          64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*sin(phi0a + phi0b) + 
          128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
           sin(phi0a + phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2))/(8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) + 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) + 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdcurva( ((-4*(1 + 2*curvb*d0b)*cos(phi0b)*
          (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
               cos(phi0a)) - 2*d0a*
             (curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
               4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
               (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b))))/
        (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))) + 
       (4*(1 + 2*curvb*d0b)*(4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*(-((1 + 2*curva*d0a)*
               (curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
        (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)) - 
       (4*curva - 64*curva*pow(curvb,2)*pow(d0a,2) - 
          192*pow(curva,2)*pow(curvb,2)*pow(d0a,3) - 
          128*pow(curva,3)*pow(curvb,2)*pow(d0a,4) - 
          192*pow(curva,2)*curvb*d0a*d0b - 64*pow(curvb,3)*d0a*d0b - 
          256*pow(curva,3)*curvb*pow(d0a,2)*d0b - 
          640*curva*pow(curvb,3)*pow(d0a,2)*d0b - 
          1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b - 
          1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b - 
          64*curva*pow(curvb,2)*pow(d0b,2) - 
          960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
          64*pow(curvb,4)*d0a*pow(d0b,2) - 
          1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
          640*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
          1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
          128*curva*pow(curvb,3)*pow(d0b,3) - 
          1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3) - 
          2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
          64*curva*pow(curvb,4)*pow(d0b,4) - 
          768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
          pow(1 + 2*curva*d0a,2)*
           (16*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             2*curva*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*cos(2*phi0a) + 
          4*d0a*(1 + 2*curva*d0a)*
           (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
             16*curva*pow(curvb,2)*d0a*
              (1 + 4*curvb*d0b + 
                2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
             pow(curva,2)*(1 + 8*curvb*d0b + 
                64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                16*pow(curvb,4)*
                 (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 2*pow(d0b,4))
                ))*cos(2*phi0a) - 
          2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
           (8*curva*d0b + curvb*
              (4*d0a + 8*curva*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) - 
          4*curva*d0a*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) - 
          2*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
           (4*pow(curva,2)*d0b + 
             curvb*(1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
           cos(phi0a - 3*phi0b) + 2*curva*cos(2*(phi0a - 2*phi0b)) + 
          12*pow(curva,2)*d0a*cos(2*(phi0a - 2*phi0b)) + 
          16*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
          16*curva*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
          96*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
          128*pow(curva,3)*curvb*pow(d0a,2)*d0b*
           cos(2*(phi0a - 2*phi0b)) + 
          48*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - 2*phi0b)) + 
          288*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - 2*phi0b)) + 
          64*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - 2*phi0b)) + 
          384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          512*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           cos(2*(phi0a - 2*phi0b)) + 
          32*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - 2*phi0b)) + 
          192*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          256*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           cos(2*(phi0a - 2*phi0b)) + 
          8*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
          48*curva*pow(curvb,2)*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
          96*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
           cos(4*phi0a - 2*phi0b) + 
          64*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
           cos(4*phi0a - 2*phi0b) + 
          32*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
          192*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
           cos(4*phi0a - 2*phi0b) + 
          32*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
          192*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          384*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) + 
          256*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           cos(4*phi0a - 2*phi0b) - 2*curvb*cos(phi0a - phi0b) + 
          24*curva*curvb*d0a*cos(phi0a - phi0b) + 
          144*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
          56*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
          128*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
          288*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a - phi0b) + 
          480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*cos(phi0a - phi0b) + 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*cos(phi0a - phi0b) + 
          24*pow(curva,2)*d0b*cos(phi0a - phi0b) + 
          12*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
          64*pow(curva,3)*d0a*d0b*cos(phi0a - phi0b) + 
          432*curva*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
          1728*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a - phi0b) + 
          112*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
          1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(phi0a - phi0b) + 
          576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a - phi0b) + 
          960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a - phi0b) + 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
           cos(phi0a - phi0b) + 
          168*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
          48*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
          448*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
          1152*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
          4320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          3840*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(phi0a - phi0b) + 
          432*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0a - phi0b) + 
          32*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
          1152*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          768*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a - phi0b) + 
          2880*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          2560*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(phi0a - phi0b) + 
          480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(phi0a - phi0b) + 
          1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
           cos(phi0a - phi0b) + 
          192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*cos(phi0a - phi0b) + 
          512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
           cos(phi0a - phi0b) - 4*curva*cos(2*(phi0a - phi0b)) - 
          24*pow(curva,2)*d0a*cos(2*(phi0a - phi0b)) - 
          24*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
          32*pow(curva,3)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
          176*curva*pow(curvb,2)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
          384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
           cos(2*(phi0a - phi0b)) - 
          256*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
           cos(2*(phi0a - phi0b)) - 
          48*curva*curvb*d0b*cos(2*(phi0a - phi0b)) - 
          288*pow(curva,2)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          96*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
          384*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
          704*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
           cos(2*(phi0a - phi0b)) - 
          176*curva*pow(curvb,2)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
          1056*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          96*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
          1408*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          704*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           cos(2*(phi0a - phi0b)) - 
          256*curva*pow(curvb,3)*pow(d0b,3)*cos(2*(phi0a - phi0b)) - 
          1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
           cos(2*(phi0a - phi0b)) - 
          128*curva*pow(curvb,4)*pow(d0b,4)*cos(2*(phi0a - phi0b)) - 
          768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           cos(2*(phi0a - phi0b)) + 2*curvb*cos(3*(phi0a - phi0b)) + 
          24*curva*curvb*d0a*cos(3*(phi0a - phi0b)) + 
          72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
          64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
          12*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
          144*curva*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
          432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*(phi0a - phi0b)) + 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(3*(phi0a - phi0b)) + 
          24*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
          288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
          864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(3*(phi0a - phi0b)) + 
          16*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
          192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
          576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) + 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(3*(phi0a - phi0b)) - 2*curvb*cos(3*phi0a - phi0b) - 
          24*curva*curvb*d0a*cos(3*phi0a - phi0b) - 
          72*pow(curva,2)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
          56*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
          64*pow(curva,3)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
          288*curva*pow(curvb,3)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
          480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*
           cos(3*phi0a - phi0b) - 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*
           cos(3*phi0a - phi0b) - 
          12*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
          144*curva*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
          432*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(3*phi0a - phi0b) - 
          112*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
          384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(3*phi0a - phi0b) - 
          576*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(3*phi0a - phi0b) - 
          960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(3*phi0a - phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
           cos(3*phi0a - phi0b) - 
          24*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
          288*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(3*phi0a - phi0b) - 
          864*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          768*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(3*phi0a - phi0b) - 
          16*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
          192*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(3*phi0a - phi0b) - 
          576*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(3*phi0a - phi0b) - 4*curva*cos(2*phi0b) + 
          8*pow(curvb,2)*d0a*cos(2*phi0b) + 
          80*curva*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
          192*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
          128*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
          16*curva*curvb*d0b*cos(2*phi0b) + 
          192*pow(curva,2)*curvb*d0a*d0b*cos(2*phi0b) + 
          32*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
          256*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
          320*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
          768*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
          512*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
          64*pow(curva,3)*pow(d0b,2)*cos(2*phi0b) + 
          144*curva*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
          960*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          32*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
          1280*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
           cos(2*phi0b) + 320*curva*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
           cos(2*phi0b) + 768*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
           pow(d0b,2)*cos(2*phi0b) + 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
           cos(2*phi0b) + 384*pow(curva,3)*curvb*pow(d0b,3)*
           cos(2*phi0b) + 256*curva*pow(curvb,3)*pow(d0b,3)*
           cos(2*phi0b) + 1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
           cos(2*phi0b) + 2048*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*
           pow(d0b,3)*cos(2*phi0b) + 
          832*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*cos(2*phi0b) + 
          128*curva*pow(curvb,4)*pow(d0b,4)*cos(2*phi0b) + 
          768*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,4)*cos(2*phi0b) + 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
           cos(2*phi0b) + 768*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
           cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0b,6)*
           cos(2*phi0b) + 4*curvb*cos(phi0a + phi0b) - 
          72*pow(curva,2)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
          32*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
          64*pow(curva,3)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
          256*curva*pow(curvb,3)*pow(d0a,3)*cos(phi0a + phi0b) - 
          480*pow(curva,2)*pow(curvb,3)*pow(d0a,4)*cos(phi0a + phi0b) - 
          256*pow(curva,3)*pow(curvb,3)*pow(d0a,5)*cos(phi0a + phi0b) - 
          160*curva*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
          720*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(phi0a + phi0b) - 
          64*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
          640*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
           cos(phi0a + phi0b) - 
          512*curva*pow(curvb,4)*pow(d0a,3)*d0b*cos(phi0a + phi0b) - 
          960*pow(curva,2)*pow(curvb,4)*pow(d0a,4)*d0b*
           cos(phi0a + phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*pow(d0a,5)*d0b*
           cos(phi0a + phi0b) - 
          96*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
          24*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
          256*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
          480*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
          1728*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          1536*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
           cos(phi0a + phi0b) - 
          384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0a + phi0b) - 
          16*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
          1024*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          320*curva*pow(curvb,4)*d0a*pow(d0b,3)*cos(phi0a + phi0b) - 
          1152*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
           cos(phi0a + phi0b) - 
          480*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(phi0a + phi0b) - 
          1280*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
           cos(phi0a + phi0b) - 
          192*pow(curva,2)*pow(curvb,4)*pow(d0b,5)*cos(phi0a + phi0b) - 
          512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,5)*
           cos(phi0a + phi0b))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (2*(4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b)))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) - (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
          (4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                  4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (8*sqrt(2)*curva*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ) + (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(1 + 4*pow(curvb,2)*pow(d0a,2))*
               cos(phi0a)) - 2*d0a*
             (curva + 4*pow(curvb,2)*d0a + 
               4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a) + 
            (1 + 2*curvb*d0b)*(2*curva*d0a*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               (1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - 2*phi0b) + 
               4*curvb*d0a*(1 + 2*curva*d0a)*cos(2*phi0a - phi0b) - 
               (8*curva*d0b + 8*curva*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) - (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (4*pow(curvb,2)*d0a + 
            2*curva*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
            2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,3) + (4*sqrt(2)*curva*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)))))/
        pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2) + (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
          ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,4)) - 
            ((4*d0a + 8*curva*pow(d0a,2) + 16*pow(curvb,2)*pow(d0a,3) + 
                 16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                 64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                 32*pow(curvb,2)*d0a*pow(d0b,2) + 
                 64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 32*curva*curvb*pow(d0b,3) + 
                 16*curva*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                  cos(phi0a - phi0b) - 
                 16*d0a*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)) + 
            (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,5)*pow(curvb,4))))/
        ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b))*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))) + 
       (sqrt(2)*pow(curva,2)*pow(curvb,2)*
          (-((1 + 2*curva*d0a)*(curva + 4*pow(curvb,2)*d0a + 
                 4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
            (1 + 2*curvb*d0b)*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
          ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
               (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
             (pow(curva,4)*pow(curvb,4)) - 
            ((4*d0a + 8*curva*pow(d0a,2) + 16*pow(curvb,2)*pow(d0a,3) + 
                 16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                 64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                 32*pow(curvb,2)*d0a*pow(d0b,2) + 
                 64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 32*curva*curvb*pow(d0b,3) + 
                 16*curva*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                  cos(phi0a - phi0b) - 
                 16*d0a*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)) + 
            (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,5)*pow(curvb,4))))/
        (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2)*
          sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))))/
     (8.*sqrt(4/pow(curvb,2) - 
         (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
         (4*(1 + 2*curvb*d0b)*cos(phi0b)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
          (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
              pow(curva,2)*(1 + 4*curvb*d0b + 
                 4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
              2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
               cos(phi0a - phi0b))) - 
         (2*pow(curva,2) + 2*pow(curvb,2) - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
            64*pow(curva,3)*curvb*d0a*d0b - 
            64*curva*pow(curvb,3)*d0a*d0b - 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
            320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
            32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
            64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
            320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
            64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
            32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
            pow(1 + 2*curva*d0a,2)*
             (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
               16*curva*pow(curvb,2)*d0a*
                (1 + 4*curvb*d0b + 
                  2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
               pow(curva,2)*(1 + 8*curvb*d0b + 
                  64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                  8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                  16*pow(curvb,4)*
                   (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                     2*pow(d0b,4))))*cos(2*phi0a) - 
            2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
             (4*pow(curva,2)*d0b + 
               curvb*(1 + 4*curva*d0a + 
                  4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
             cos(phi0a - 3*phi0b) + pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
            4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
            8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
             cos(2*(phi0a - 2*phi0b)) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - 2*phi0b)) + 
            32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - 2*phi0b)) + 
            16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - 2*phi0b)) + 
            pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
            24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(4*phi0a - 2*phi0b) + 
            32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(4*phi0a - 2*phi0b) + 
            16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(4*phi0a - 2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
            96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) + 
            64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
            12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
            8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
            48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
            32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a - phi0b) + 8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
            12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
            16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
            216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
            16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
            576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a - phi0b) + 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
            384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a - phi0b) + 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a - phi0b) + 
            56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
            48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
            112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
            576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a - phi0b) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
            288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a - phi0b) + 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a - phi0b) + 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a - phi0b) + 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a - phi0b) - 2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
            2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
            24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
            8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
             cos(2*(phi0a - phi0b)) - 
            24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
            96*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
             cos(2*(phi0a - phi0b)) - 
            88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            96*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
            352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
             cos(2*(phi0a - phi0b)) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*(phi0a - phi0b)) - 
            64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*(phi0a - phi0b)) + 2*curva*curvb*cos(3*(phi0a - phi0b)) + 
            12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
            12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*(phi0a - phi0b)) + 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*(phi0a - phi0b)) + 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*(phi0a - phi0b)) + 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) + 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
            12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
            8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(3*phi0a - phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(3*phi0a - phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(3*phi0a - phi0b) - 
            12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
            72*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(3*phi0a - phi0b) - 
            16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
            144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(3*phi0a - phi0b) - 
            112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
            96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(3*phi0a - phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(3*phi0a - phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
            144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(3*phi0a - phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
            96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
            pow(curvb,2)*cos(2*phi0b) + 
            8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
            40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
            64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
            32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
            8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
            4*pow(curvb,3)*d0b*cos(2*phi0b) + 
            64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
            32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
            64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
            160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*cos(2*phi0b) + 
            128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*cos(2*phi0b) + 
            16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
            72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
            4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            32*curva*pow(curvb,4)*d0a*pow(d0b,2)*cos(2*phi0b) + 
            320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
             cos(2*phi0b) + 160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
             pow(d0b,2)*cos(2*phi0b) + 
            256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
             cos(2*phi0b) + 128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
             pow(d0b,2)*cos(2*phi0b) + 
            96*pow(curva,4)*curvb*pow(d0b,3)*cos(2*phi0b) + 
            128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*cos(2*phi0b) + 
            512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
             cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
             cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
             cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
             pow(d0b,4)*cos(2*phi0b) + 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
             cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
             cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
             cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
            24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
            32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
            16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
            128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
             cos(phi0a + phi0b) - 
            80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
            240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
             cos(phi0a + phi0b) - 
            64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
            160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
             cos(phi0a + phi0b) - 
            320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
             cos(phi0a + phi0b) - 
            32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
            24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
            64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
            240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
             cos(phi0a + phi0b) - 
            128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
             cos(phi0a + phi0b) - 
            160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
             cos(phi0a + phi0b) - 
            64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
             cos(phi0a + phi0b) - 
            128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
             cos(phi0a + phi0b))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2) + 
         (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b)) + 
         (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
            (-((1 + 2*curva*d0a)*
                 (curva + 4*pow(curvb,2)*d0a + 
                   4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
              (1 + 2*curvb*d0b)*
               (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - 2*phi0b) + 
                 curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                 (curvb + 4*pow(curva,2)*d0b + 
                    4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)))))/
          pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
            pow(curva,2)*(1 + 4*curvb*d0b + 
               4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
            2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             cos(phi0a - phi0b),2))) );
   double dxdd0b( (-4*sin(phi0b) + 
       ((-16*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/curvb - 
          (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((1 + 2*curvb*d0b)*
                (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                  (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*cos(phi0b))\
                + 2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (4*(1 + 2*curvb*d0b)*(pow(curva,2)*
                (4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)) - 
          (8*cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (-64*pow(curva,3)*curvb*d0a - 64*curva*pow(curvb,3)*d0a - 
             64*pow(curva,4)*curvb*pow(d0a,2) - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4) - 
             64*pow(curva,2)*pow(curvb,2)*d0b - 
             640*pow(curva,3)*pow(curvb,2)*d0a*d0b - 
             128*curva*pow(curvb,4)*d0a*d0b - 
             640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b - 
             640*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b - 
             1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b - 
             192*pow(curva,2)*pow(curvb,3)*pow(d0b,2) - 
             1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2) - 
             1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2) - 
             128*pow(curva,2)*pow(curvb,4)*pow(d0b,3) - 
             1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3) - 
             1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3) + 
             pow(1 + 2*curva*d0a,2)*
              (16*curva*pow(curvb,2)*d0a*(4*curvb + 8*pow(curvb,2)*d0b) + 
                pow(curva,2)*(8*curvb + 80*pow(curvb,2)*d0b + 
                   128*pow(curvb,3)*pow(d0b,2) + 
                   64*pow(curvb,3)*(pow(d0a,2) + pow(d0b,2)) + 
                   16*pow(curvb,4)*(8*pow(d0a,2)*d0b + 8*pow(d0b,3))))*
              cos(2*phi0a) - 2*curva*(1 + 2*curva*d0a)*
              pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*
              cos(phi0a - 3*phi0b) - 
             12*curva*curvb*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             8*pow(curva,2)*curvb*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*curvb*d0a*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*curvb*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
             48*pow(curva,2)*pow(curvb,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,3)*pow(curvb,2)*d0a*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             4*pow(curvb,3)*cos(4*phi0a - 2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*cos(4*phi0a - 2*phi0b) + 
             96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
              cos(4*phi0a - 2*phi0b) + 
             8*pow(curvb,4)*d0b*cos(4*phi0a - 2*phi0b) + 
             64*curva*pow(curvb,4)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 8*pow(curva,3)*cos(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*cos(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*cos(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*cos(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
              cos(phi0a - phi0b) + 
             112*pow(curva,3)*curvb*d0b*cos(phi0a - phi0b) + 
             96*curva*pow(curvb,3)*d0b*cos(phi0a - phi0b) + 
             224*pow(curva,4)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
             1152*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(phi0a - phi0b) + 
             2880*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(phi0a - phi0b) + 
             1920*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             432*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             96*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a - phi0b) + 
             864*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1152*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             2880*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             1920*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) - 
             24*pow(curva,2)*curvb*cos(2*(phi0a - phi0b)) - 
             8*pow(curvb,3)*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*curvb*d0a*cos(2*(phi0a - phi0b)) - 
             96*curva*pow(curvb,3)*d0a*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*curvb*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
              cos(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*pow(curvb,2)*d0b*cos(2*(phi0a - phi0b)) - 
             16*pow(curvb,4)*d0b*cos(2*(phi0a - phi0b)) - 
             704*pow(curva,3)*pow(curvb,2)*d0a*d0b*
              cos(2*(phi0a - phi0b)) - 
             192*curva*pow(curvb,4)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) + 
             12*curva*pow(curvb,2)*cos(3*(phi0a - phi0b)) + 
             72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(3*(phi0a - phi0b)) + 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(3*(phi0a - phi0b)) + 
             48*curva*pow(curvb,3)*d0b*cos(3*(phi0a - phi0b)) + 
             288*pow(curva,2)*pow(curvb,3)*d0a*d0b*
              cos(3*(phi0a - phi0b)) + 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) - 
             12*curva*pow(curvb,2)*cos(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*cos(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             48*curva*pow(curvb,3)*d0b*cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(3*phi0a - phi0b) - 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(3*phi0a - phi0b) - 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             48*curva*pow(curvb,4)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) + 8*pow(curva,2)*curvb*cos(2*phi0b) + 
             4*pow(curvb,3)*cos(2*phi0b) + 
             64*pow(curva,3)*curvb*d0a*cos(2*phi0b) + 
             32*curva*pow(curvb,3)*d0a*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,2)*cos(2*phi0b) + 
             160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*cos(2*phi0b) + 
             256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*cos(2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*cos(2*phi0b) + 
             32*pow(curva,4)*d0b*cos(2*phi0b) + 
             144*pow(curva,2)*pow(curvb,2)*d0b*cos(2*phi0b) + 
             8*pow(curvb,4)*d0b*cos(2*phi0b) + 
             640*pow(curva,3)*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
             64*curva*pow(curvb,4)*d0a*d0b*cos(2*phi0b) + 
             640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*
              d0b*cos(2*phi0b) + 
             512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*d0b*
              cos(2*phi0b) + 256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*
              d0b*cos(2*phi0b) + 
             288*pow(curva,4)*curvb*pow(d0b,2)*cos(2*phi0b) + 
             384*pow(curva,2)*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
             1536*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*phi0b) + 1536*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             832*pow(curva,4)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
             256*pow(curva,2)*pow(curvb,4)*pow(d0b,3)*cos(2*phi0b) + 
             1024*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,3)*
              cos(2*phi0b) + 1024*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*
              pow(d0b,3)*cos(2*phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
             384*pow(curva,4)*pow(curvb,4)*pow(d0b,5)*cos(2*phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*d0a*cos(phi0a + phi0b) - 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*
              cos(phi0a + phi0b) - 
             64*curva*pow(curvb,4)*pow(d0a,2)*cos(phi0a + phi0b) - 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             64*pow(curva,3)*curvb*d0b*cos(phi0a + phi0b) - 
             48*curva*pow(curvb,3)*d0b*cos(phi0a + phi0b) - 
             128*pow(curva,4)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
             480*pow(curva,2)*pow(curvb,3)*d0a*d0b*cos(phi0a + phi0b) - 
             1152*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*d0b*
              cos(phi0a + phi0b) - 
             768*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             384*pow(curva,3)*pow(curvb,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             48*curva*pow(curvb,4)*pow(d0b,2)*cos(phi0a + phi0b) - 
             768*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             480*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             1152*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             768*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             640*pow(curva,3)*pow(curvb,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             1280*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             640*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (2*(pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b)))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) - 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
             (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                     4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (8*sqrt(2)*pow(curva,2)*pow(curvb,2)*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) + 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             ((1 + 2*curvb*d0b)*
                (2*curva*curvb*(1 + 2*curva*d0a)*cos(phi0a - 2*phi0b) - 
                  (4*pow(curva,2) + 8*pow(curva,2)*curvb*d0b)*cos(phi0b))\
                + 2*curvb*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
               4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*sin(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,3)) - 
               ((4*curvb + 32*curva*curvb*d0a + 
                    32*pow(curva,2)*curvb*pow(d0a,2) + 
                    16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                    64*curva*pow(curvb,2)*d0a*d0b + 
                    64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                    48*pow(curva,2)*curvb*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                    16*curvb*(1 + 2*curva*d0a)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) + 
          (sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*sin(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,3)) - 
               ((4*curvb + 32*curva*curvb*d0a + 
                    32*pow(curva,2)*curvb*pow(d0a,2) + 
                    16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                    64*curva*pow(curvb,2)*d0a*d0b + 
                    64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                    48*pow(curva,2)*curvb*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                    16*curvb*(1 + 2*curva*d0a)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))))/
        (2.*sqrt(4/pow(curvb,2) - 
            (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
            (4*(1 + 2*curvb*d0b)*cos(phi0b)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
             (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                 pow(curva,2)*
                  (1 + 4*curvb*d0b + 
                    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                 2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b))) - 
            (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2) + 
            (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b)) + 
            (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2))))/4. );
   double dxdphi0b( ((-2*cos(phi0b))/curvb - 4*d0b*cos(phi0b) + 
       ((-8*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sin(phi0a - phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (4*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
             (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))*sin(phi0a - phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (8*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0b))/pow(curvb,2) + 
          (4*(1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sin(phi0b))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (8*sqrt(2)*pow(curva,3)*pow(curvb,2)*(1 + 2*curva*d0a)*
             pow(1 + 2*curvb*d0b,2)*cos(phi0b)*sin(phi0a - phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (8*sqrt(2)*pow(curva,3)*pow(curvb,3)*(1 + 2*curva*d0a)*
             (1 + 2*curvb*d0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sin(phi0a - phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) - 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*sin(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) - 
          (4*pow(1 + 2*curvb*d0b,2)*cos(phi0b)*
             (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                sin(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*(1 + 2*curvb*d0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))*
             (2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                sin(phi0a - 2*phi0b) + 
               curvb*pow(1 + 2*curva*d0a,2)*sin(2*phi0a - phi0b) + 
               (curvb + 4*pow(curva,2)*d0b + 
                  4*pow(curva,2)*curvb*pow(d0b,2))*sin(phi0b)))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((2*(1 + 2*curvb*d0b)*
                  (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*cos(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,4)) - 
               ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     sin(phi0a - phi0b) + 
                    2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     sin(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) + 
          (sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             ((2*(1 + 2*curvb*d0b)*
                  (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*cos(phi0b)*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,3)*pow(curvb,4)) - 
               ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     sin(phi0a - phi0b) + 
                    2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     sin(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))/
           (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) - 
          (-6*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              sin(phi0a - 3*phi0b) + 
             4*pow(curva,2)*sin(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,3)*d0a*sin(2*(phi0a - 2*phi0b)) + 
             16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,2)*curvb*d0b*sin(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              sin(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              sin(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              sin(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              sin(2*(phi0a - 2*phi0b)) + 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              sin(2*(phi0a - 2*phi0b)) + 
             512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              sin(2*(phi0a - 2*phi0b)) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              sin(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              sin(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              sin(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              sin(2*(phi0a - 2*phi0b)) + 
             2*pow(curvb,2)*sin(4*phi0a - 2*phi0b) + 
             16*curva*pow(curvb,2)*d0a*sin(4*phi0a - 2*phi0b) + 
             48*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              sin(4*phi0a - 2*phi0b) + 
             64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              sin(4*phi0a - 2*phi0b) + 
             32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              sin(4*phi0a - 2*phi0b) + 
             8*pow(curvb,3)*d0b*sin(4*phi0a - 2*phi0b) + 
             64*curva*pow(curvb,3)*d0a*d0b*sin(4*phi0a - 2*phi0b) + 
             192*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              sin(4*phi0a - 2*phi0b) + 
             256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              sin(4*phi0a - 2*phi0b) + 
             128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              sin(4*phi0a - 2*phi0b) + 
             8*pow(curvb,4)*pow(d0b,2)*sin(4*phi0a - 2*phi0b) + 
             64*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) + 
             192*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) + 
             256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              sin(4*phi0a - 2*phi0b) - 2*curva*curvb*sin(phi0a - phi0b) + 
             12*pow(curva,2)*curvb*d0a*sin(phi0a - phi0b) + 
             8*pow(curvb,3)*d0a*sin(phi0a - phi0b) + 
             48*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a - phi0b) + 
             56*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a - phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a - phi0b) + 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              sin(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              sin(phi0a - phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              sin(phi0a - phi0b) + 8*pow(curva,3)*d0b*sin(phi0a - phi0b) + 
             12*curva*pow(curvb,2)*d0b*sin(phi0a - phi0b) + 
             16*pow(curva,4)*d0a*d0b*sin(phi0a - phi0b) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a - phi0b) + 
             16*pow(curvb,4)*d0a*d0b*sin(phi0a - phi0b) + 
             576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(phi0a - phi0b) + 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a - phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(phi0a - phi0b) + 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              sin(phi0a - phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              sin(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              sin(phi0a - phi0b) + 
             56*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a - phi0b) + 
             48*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a - phi0b) + 
             112*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a - phi0b) + 
             576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(phi0a - phi0b) + 
             1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(phi0a - phi0b) + 
             144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             32*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a - phi0b) + 
             288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(phi0a - phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              sin(phi0a - phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              sin(phi0a - phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              sin(phi0a - phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              sin(phi0a - phi0b) - 4*pow(curva,2)*sin(2*(phi0a - phi0b)) - 
             4*pow(curvb,2)*sin(2*(phi0a - phi0b)) - 
             16*pow(curva,3)*d0a*sin(2*(phi0a - phi0b)) - 
             48*curva*pow(curvb,2)*d0a*sin(2*(phi0a - phi0b)) - 
             16*pow(curva,4)*pow(d0a,2)*sin(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
              sin(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              sin(2*(phi0a - phi0b)) - 
             128*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
              sin(2*(phi0a - phi0b)) - 
             48*pow(curva,2)*curvb*d0b*sin(2*(phi0a - phi0b)) - 
             16*pow(curvb,3)*d0b*sin(2*(phi0a - phi0b)) - 
             192*pow(curva,3)*curvb*d0a*d0b*sin(2*(phi0a - phi0b)) - 
             192*curva*pow(curvb,3)*d0a*d0b*sin(2*(phi0a - phi0b)) - 
             192*pow(curva,4)*curvb*pow(d0a,2)*d0b*
              sin(2*(phi0a - phi0b)) - 
             704*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              sin(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             16*pow(curvb,4)*pow(d0b,2)*sin(2*(phi0a - phi0b)) - 
             704*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             192*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             704*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             704*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              sin(2*(phi0a - phi0b)) - 
             256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
              sin(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              sin(2*(phi0a - phi0b)) - 
             128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
              sin(2*(phi0a - phi0b)) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              sin(2*(phi0a - phi0b)) + 6*curva*curvb*sin(3*(phi0a - phi0b)) + 
             36*pow(curva,2)*curvb*d0a*sin(3*(phi0a - phi0b)) + 
             72*pow(curva,3)*curvb*pow(d0a,2)*sin(3*(phi0a - phi0b)) + 
             48*pow(curva,4)*curvb*pow(d0a,3)*sin(3*(phi0a - phi0b)) + 
             36*curva*pow(curvb,2)*d0b*sin(3*(phi0a - phi0b)) + 
             216*pow(curva,2)*pow(curvb,2)*d0a*d0b*
              sin(3*(phi0a - phi0b)) + 
             432*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(3*(phi0a - phi0b)) + 
             288*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(3*(phi0a - phi0b)) + 
             72*curva*pow(curvb,3)*pow(d0b,2)*sin(3*(phi0a - phi0b)) + 
             432*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(3*(phi0a - phi0b)) + 
             864*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(3*(phi0a - phi0b)) + 
             576*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(3*(phi0a - phi0b)) + 
             48*curva*pow(curvb,4)*pow(d0b,3)*sin(3*(phi0a - phi0b)) + 
             288*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(3*(phi0a - phi0b)) + 
             576*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(3*(phi0a - phi0b)) + 
             384*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(3*(phi0a - phi0b)) - 2*curva*curvb*sin(3*phi0a - phi0b) - 
             12*pow(curva,2)*curvb*d0a*sin(3*phi0a - phi0b) - 
             8*pow(curvb,3)*d0a*sin(3*phi0a - phi0b) - 
             24*pow(curva,3)*curvb*pow(d0a,2)*sin(3*phi0a - phi0b) - 
             56*curva*pow(curvb,3)*pow(d0a,2)*sin(3*phi0a - phi0b) - 
             16*pow(curva,4)*curvb*pow(d0a,3)*sin(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              sin(3*phi0a - phi0b) - 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              sin(3*phi0a - phi0b) - 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              sin(3*phi0a - phi0b) - 
             12*curva*pow(curvb,2)*d0b*sin(3*phi0a - phi0b) - 
             72*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(3*phi0a - phi0b) - 
             16*pow(curvb,4)*d0a*d0b*sin(3*phi0a - phi0b) - 
             144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(3*phi0a - phi0b) - 
             112*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(3*phi0a - phi0b) - 
             96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(3*phi0a - phi0b) - 
             288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              sin(3*phi0a - phi0b) - 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              sin(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              sin(3*phi0a - phi0b) - 
             24*curva*pow(curvb,3)*pow(d0b,2)*sin(3*phi0a - phi0b) - 
             144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(3*phi0a - phi0b) - 
             288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(3*phi0a - phi0b) - 
             16*curva*pow(curvb,4)*pow(d0b,3)*sin(3*phi0a - phi0b) - 
             96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(3*phi0a - phi0b) - 
             192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(3*phi0a - phi0b) - 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(3*phi0a - phi0b) + 4*pow(curva,2)*sin(2*phi0b) - 
             2*pow(curvb,2)*sin(2*phi0b) - 
             16*curva*pow(curvb,2)*d0a*sin(2*phi0b) - 
             80*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*sin(2*phi0b) - 
             128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*sin(2*phi0b) - 
             64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*sin(2*phi0b) - 
             16*pow(curva,2)*curvb*d0b*sin(2*phi0b) - 
             8*pow(curvb,3)*d0b*sin(2*phi0b) - 
             128*pow(curva,3)*curvb*d0a*d0b*sin(2*phi0b) - 
             64*curva*pow(curvb,3)*d0a*d0b*sin(2*phi0b) - 
             128*pow(curva,4)*curvb*pow(d0a,2)*d0b*sin(2*phi0b) - 
             320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
              sin(2*phi0b) - 512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
              d0b*sin(2*phi0b) - 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
              sin(2*phi0b) - 32*pow(curva,4)*pow(d0b,2)*sin(2*phi0b) - 
             144*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*sin(2*phi0b) - 
             8*pow(curvb,4)*pow(d0b,2)*sin(2*phi0b) - 
             640*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
              sin(2*phi0b) - 64*curva*pow(curvb,4)*d0a*pow(d0b,2)*
              sin(2*phi0b) - 640*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,2)*sin(2*phi0b) - 
             320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
              sin(2*phi0b) - 512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
              pow(d0b,2)*sin(2*phi0b) - 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
              sin(2*phi0b) - 192*pow(curva,4)*curvb*pow(d0b,3)*
              sin(2*phi0b) - 256*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
              sin(2*phi0b) - 1024*pow(curva,3)*pow(curvb,3)*d0a*
              pow(d0b,3)*sin(2*phi0b) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              sin(2*phi0b) - 416*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
              sin(2*phi0b) - 128*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
              sin(2*phi0b) - 512*pow(curva,3)*pow(curvb,4)*d0a*
              pow(d0b,4)*sin(2*phi0b) - 
             512*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
              sin(2*phi0b) - 384*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
              sin(2*phi0b) - 128*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
              sin(2*phi0b) - 4*curva*curvb*sin(phi0a + phi0b) + 
             24*pow(curva,3)*curvb*pow(d0a,2)*sin(phi0a + phi0b) + 
             32*curva*pow(curvb,3)*pow(d0a,2)*sin(phi0a + phi0b) + 
             16*pow(curva,4)*curvb*pow(d0a,3)*sin(phi0a + phi0b) + 
             128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
              sin(phi0a + phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
              sin(phi0a + phi0b) + 
             64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
              sin(phi0a + phi0b) + 
             80*pow(curva,2)*pow(curvb,2)*d0a*d0b*sin(phi0a + phi0b) + 
             240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
              sin(phi0a + phi0b) + 
             64*curva*pow(curvb,4)*pow(d0a,2)*d0b*sin(phi0a + phi0b) + 
             160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
              sin(phi0a + phi0b) + 
             256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
              sin(phi0a + phi0b) + 
             320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
              sin(phi0a + phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
              sin(phi0a + phi0b) + 
             32*pow(curva,3)*curvb*pow(d0b,2)*sin(phi0a + phi0b) + 
             24*curva*pow(curvb,3)*pow(d0b,2)*sin(phi0a + phi0b) + 
             64*pow(curva,4)*curvb*d0a*pow(d0b,2)*sin(phi0a + phi0b) + 
             240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
              sin(phi0a + phi0b) + 
             576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              sin(phi0a + phi0b) + 
             384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              sin(phi0a + phi0b) + 
             128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             16*curva*pow(curvb,4)*pow(d0b,3)*sin(phi0a + phi0b) + 
             256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
              sin(phi0a + phi0b) + 
             160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
              sin(phi0a + phi0b) + 
             320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
              sin(phi0a + phi0b) + 
             64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
              sin(phi0a + phi0b) + 
             128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
              sin(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2))/
        (2.*sqrt(4/pow(curvb,2) - 
            (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
            (4*(1 + 2*curvb*d0b)*cos(phi0b)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
             (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                 pow(curva,2)*
                  (1 + 4*curvb*d0b + 
                    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                 2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b))) - 
            (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2) + 
            (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b)) + 
            (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2))))/4. );
   double dxdcurvb( ((2*sin(phi0b))/pow(curvb,2) + 
       (-8/pow(curvb,3) - (16*d0b*(1 + 2*curvb*d0b)*pow(cos(phi0b),2))/
           pow(curvb,2) + (8*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/
           pow(curvb,3) - (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*(8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*
                  cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                  pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
               2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (4*(1 + 2*curvb*d0b)*(2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)) - 
          (8*d0b*cos(phi0b)*(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) + 
          (4*(1 + 2*curvb*d0b)*cos(phi0b)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
           (pow(curvb,2)*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))) - 
          (4*curvb - 64*pow(curva,2)*curvb*pow(d0a,2) - 
             128*pow(curva,3)*curvb*pow(d0a,3) - 
             64*pow(curva,4)*curvb*pow(d0a,4) - 
             64*pow(curva,3)*d0a*d0b - 192*curva*pow(curvb,2)*d0a*d0b - 
             64*pow(curva,4)*pow(d0a,2)*d0b - 
             960*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b - 
             1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b - 
             768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b - 
             64*pow(curva,2)*curvb*pow(d0b,2) - 
             640*pow(curva,3)*curvb*d0a*pow(d0b,2) - 
             256*curva*pow(curvb,3)*d0a*pow(d0b,2) - 
             640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2) - 
             1280*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2) - 
             2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2) - 
             192*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
             1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3) - 
             1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3) - 
             128*pow(curva,2)*pow(curvb,3)*pow(d0b,4) - 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4) + 
             pow(1 + 2*curva*d0a,2)*
              (-4*curvb + 64*pow(curvb,3)*pow(d0a,2) + 
                16*curva*pow(curvb,2)*d0a*
                 (4*d0b + 4*curvb*(pow(d0a,2) + 2*pow(d0b,2))) + 
                32*curva*curvb*d0a*
                 (1 + 4*curvb*d0b + 
                   2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                pow(curva,2)*(8*d0b + 
                   192*pow(curvb,2)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                   16*curvb*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                   64*pow(curvb,3)*
                    (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                      2*pow(d0b,4))))*cos(2*phi0a) - 
             2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
              (1 + 4*curva*d0a + 
                4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2)))*
              cos(phi0a - 3*phi0b) - 
             12*curva*(1 + 2*curva*d0a)*d0b*pow(1 + 2*curvb*d0b,2)*
              (4*pow(curva,2)*d0b + 
                curvb*(1 + 4*curva*d0a + 
                   4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
              cos(phi0a - 3*phi0b) + 
             8*pow(curva,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,3)*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
             32*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - 2*phi0b)) + 
             48*pow(curva,2)*curvb*pow(d0b,2)*cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,3)*curvb*d0a*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             192*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - 2*phi0b)) + 
             96*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - 2*phi0b)) + 
             64*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - 2*phi0b)) + 2*curvb*cos(4*phi0a - 2*phi0b) + 
             16*curva*curvb*d0a*cos(4*phi0a - 2*phi0b) + 
             48*pow(curva,2)*curvb*pow(d0a,2)*cos(4*phi0a - 2*phi0b) + 
             64*pow(curva,3)*curvb*pow(d0a,3)*cos(4*phi0a - 2*phi0b) + 
             32*pow(curva,4)*curvb*pow(d0a,4)*cos(4*phi0a - 2*phi0b) + 
             12*pow(curvb,2)*d0b*cos(4*phi0a - 2*phi0b) + 
             96*curva*pow(curvb,2)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
             288*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             384*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
              cos(4*phi0a - 2*phi0b) + 
             16*pow(curvb,3)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
             128*curva*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             384*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) + 
             256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
              cos(4*phi0a - 2*phi0b) - 2*curva*cos(phi0a - phi0b) + 
             12*pow(curva,2)*d0a*cos(phi0a - phi0b) + 
             24*pow(curvb,2)*d0a*cos(phi0a - phi0b) + 
             48*pow(curva,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
             168*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a - phi0b) + 
             32*pow(curva,4)*pow(d0a,3)*cos(phi0a - phi0b) + 
             432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a - phi0b) + 
             480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
              cos(phi0a - phi0b) + 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
              cos(phi0a - phi0b) + 24*curva*curvb*d0b*cos(phi0a - phi0b) + 
             432*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - phi0b) + 
             64*pow(curvb,3)*d0a*d0b*cos(phi0a - phi0b) + 
             1152*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             448*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
             768*pow(curva,4)*curvb*pow(d0a,3)*d0b*cos(phi0a - phi0b) + 
             1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a - phi0b) + 
             1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(phi0a - phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
              cos(phi0a - phi0b) + 
             56*pow(curva,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
             144*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - phi0b) + 
             112*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
             1728*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             4320*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             2880*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a - phi0b) + 
             288*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a - phi0b) + 
             128*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a - phi0b) + 
             576*pow(curva,4)*curvb*d0a*pow(d0b,3)*cos(phi0a - phi0b) + 
             1536*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             3840*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             2560*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a - phi0b) + 
             480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
              cos(phi0a - phi0b) + 
             256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
              cos(phi0a - phi0b) + 
             512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
              cos(phi0a - phi0b) - 4*curvb*cos(2*(phi0a - phi0b)) - 
             48*curva*curvb*d0a*cos(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*curvb*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
             256*pow(curva,3)*curvb*pow(d0a,3)*cos(2*(phi0a - phi0b)) - 
             128*pow(curva,4)*curvb*pow(d0a,4)*cos(2*(phi0a - phi0b)) - 
             24*pow(curva,2)*d0b*cos(2*(phi0a - phi0b)) - 
             24*pow(curvb,2)*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             288*curva*pow(curvb,2)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
             96*pow(curva,4)*pow(d0a,2)*d0b*cos(2*(phi0a - phi0b)) - 
             1056*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*d0b*
              cos(2*(phi0a - phi0b)) - 
             768*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
              cos(2*(phi0a - phi0b)) - 
             176*pow(curva,2)*curvb*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             32*pow(curvb,3)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
             704*pow(curva,3)*curvb*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             384*curva*pow(curvb,3)*d0a*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             704*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1408*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             2048*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*pow(d0b,2)*
              cos(2*(phi0a - phi0b)) - 
             384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,3)*
              cos(2*(phi0a - phi0b)) - 
             256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,4)*
              cos(2*(phi0a - phi0b)) + 2*curva*cos(3*(phi0a - phi0b)) + 
             12*pow(curva,2)*d0a*cos(3*(phi0a - phi0b)) + 
             24*pow(curva,3)*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
             16*pow(curva,4)*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
             24*curva*curvb*d0b*cos(3*(phi0a - phi0b)) + 
             144*pow(curva,2)*curvb*d0a*d0b*cos(3*(phi0a - phi0b)) + 
             288*pow(curva,3)*curvb*pow(d0a,2)*d0b*
              cos(3*(phi0a - phi0b)) + 
             192*pow(curva,4)*curvb*pow(d0a,3)*d0b*
              cos(3*(phi0a - phi0b)) + 
             72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
             432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(3*(phi0a - phi0b)) + 
             64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
             384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) + 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(3*(phi0a - phi0b)) - 2*curva*cos(3*phi0a - phi0b) - 
             12*pow(curva,2)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curvb,2)*d0a*cos(3*phi0a - phi0b) - 
             24*pow(curva,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             168*curva*pow(curvb,2)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
             16*pow(curva,4)*pow(d0a,3)*cos(3*phi0a - phi0b) - 
             432*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
              cos(3*phi0a - phi0b) - 
             480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
              cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
              cos(3*phi0a - phi0b) - 
             24*curva*curvb*d0b*cos(3*phi0a - phi0b) - 
             144*pow(curva,2)*curvb*d0a*d0b*cos(3*phi0a - phi0b) - 
             64*pow(curvb,3)*d0a*d0b*cos(3*phi0a - phi0b) - 
             288*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             448*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(3*phi0a - phi0b) - 
             192*pow(curva,4)*curvb*pow(d0a,3)*d0b*cos(3*phi0a - phi0b) - 
             1152*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(3*phi0a - phi0b) - 
             1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(3*phi0a - phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
              cos(3*phi0a - phi0b) - 
             72*curva*pow(curvb,2)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
             432*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             864*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             576*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(3*phi0a - phi0b) - 
             64*curva*pow(curvb,3)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
             384*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             768*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(3*phi0a - phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(3*phi0a - phi0b) + 2*curvb*cos(2*phi0b) + 
             16*curva*curvb*d0a*cos(2*phi0b) + 
             80*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0b) + 
             128*pow(curva,3)*curvb*pow(d0a,3)*cos(2*phi0b) + 
             64*pow(curva,4)*curvb*pow(d0a,4)*cos(2*phi0b) + 
             8*pow(curva,2)*d0b*cos(2*phi0b) + 
             12*pow(curvb,2)*d0b*cos(2*phi0b) + 
             64*pow(curva,3)*d0a*d0b*cos(2*phi0b) + 
             96*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0b) + 
             64*pow(curva,4)*pow(d0a,2)*d0b*cos(2*phi0b) + 
             480*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
              cos(2*phi0b) + 768*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
              d0b*cos(2*phi0b) + 
             384*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*d0b*
              cos(2*phi0b) + 144*pow(curva,2)*curvb*pow(d0b,2)*
              cos(2*phi0b) + 16*pow(curvb,3)*pow(d0b,2)*cos(2*phi0b) + 
             640*pow(curva,3)*curvb*d0a*pow(d0b,2)*cos(2*phi0b) + 
             128*curva*pow(curvb,3)*d0a*pow(d0b,2)*cos(2*phi0b) + 
             640*pow(curva,4)*curvb*pow(d0a,2)*pow(d0b,2)*
              cos(2*phi0b) + 640*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*
              pow(d0b,2)*cos(2*phi0b) + 
             1024*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
              cos(2*phi0b) + 512*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*
              pow(d0b,2)*cos(2*phi0b) + 
             96*pow(curva,4)*pow(d0b,3)*cos(2*phi0b) + 
             384*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(2*phi0b) + 
             1536*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,3)*
              cos(2*phi0b) + 1536*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
              pow(d0b,3)*cos(2*phi0b) + 
             416*pow(curva,4)*curvb*pow(d0b,4)*cos(2*phi0b) + 
             256*pow(curva,2)*pow(curvb,3)*pow(d0b,4)*cos(2*phi0b) + 
             1024*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,4)*
              cos(2*phi0b) + 1024*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*
              pow(d0b,4)*cos(2*phi0b) + 
             576*pow(curva,4)*pow(curvb,2)*pow(d0b,5)*cos(2*phi0b) + 
             256*pow(curva,4)*pow(curvb,3)*pow(d0b,6)*cos(2*phi0b) + 
             4*curva*cos(phi0a + phi0b) - 
             24*pow(curva,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
             96*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a + phi0b) - 
             16*pow(curva,4)*pow(d0a,3)*cos(phi0a + phi0b) - 
             384*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*
              cos(phi0a + phi0b) - 
             480*pow(curva,3)*pow(curvb,2)*pow(d0a,4)*
              cos(phi0a + phi0b) - 
             192*pow(curva,4)*pow(curvb,2)*pow(d0a,5)*
              cos(phi0a + phi0b) - 
             160*pow(curva,2)*curvb*d0a*d0b*cos(phi0a + phi0b) - 
             480*pow(curva,3)*curvb*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             256*curva*pow(curvb,3)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
             320*pow(curva,4)*curvb*pow(d0a,3)*d0b*cos(phi0a + phi0b) - 
             1024*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*d0b*
              cos(phi0a + phi0b) - 
             1280*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*d0b*
              cos(phi0a + phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*d0b*
              cos(phi0a + phi0b) - 
             32*pow(curva,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
             72*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a + phi0b) - 
             64*pow(curva,4)*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
             720*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             1728*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             1152*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*pow(d0b,2)*
              cos(phi0a + phi0b) - 
             256*pow(curva,3)*curvb*pow(d0b,3)*cos(phi0a + phi0b) - 
             64*curva*pow(curvb,3)*pow(d0b,3)*cos(phi0a + phi0b) - 
             512*pow(curva,4)*curvb*d0a*pow(d0b,3)*cos(phi0a + phi0b) - 
             640*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             1536*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             1024*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,3)*
              cos(phi0a + phi0b) - 
             480*pow(curva,3)*pow(curvb,2)*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             960*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,4)*
              cos(phi0a + phi0b) - 
             256*pow(curva,3)*pow(curvb,3)*pow(d0b,5)*
              cos(phi0a + phi0b) - 
             512*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,5)*
              cos(phi0a + phi0b))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (2*(2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *(2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b)))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) - 
          (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*
             (2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *cos(phi0b)*sqrt(-(((-1 + 4*curva*d0a + 
                     4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (8*sqrt(2)*pow(curva,2)*curvb*d0b*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) + 
          (4*sqrt(2)*pow(curva,2)*(1 + 2*curvb*d0b)*cos(phi0b)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b)) + 
          (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*(8*curvb*d0a + 8*curva*curvb*pow(d0a,2))*
                  cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (2*curva*(1 + 2*curva*d0a)*d0b*cos(phi0a - 2*phi0b) + 
                  pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (1 + 4*pow(curva,2)*pow(d0b,2))*cos(phi0b)) + 
               2*d0b*(curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) - 
          (4*sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (2*curvb + 8*curva*curvb*d0a + 
               pow(curva,2)*(4*d0b + 
                  8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
               4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
               2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))
              *(-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),3) + 
          (4*sqrt(2)*pow(curva,2)*curvb*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4)))))/
           pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
             pow(curva,2)*(1 + 4*curvb*d0b + 
                4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
             2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
              cos(phi0a - phi0b),2) + 
          (2*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
             ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,4)*pow(curvb,4)) - 
               ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                    16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                    32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                    8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                    64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                    16*pow(curva,2)*pow(d0b,3) + 
                    16*pow(curva,2)*curvb*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                     cos(phi0a - phi0b) - 
                    16*(1 + 2*curva*d0a)*d0b*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)) + 
               (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,5))))/
           ((pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b))*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))) + 
          (sqrt(2)*pow(curva,2)*pow(curvb,2)*
             (-((1 + 2*curva*d0a)*
                  (curva + 4*pow(curvb,2)*d0a + 
                    4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
               (1 + 2*curvb*d0b)*
                (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   cos(phi0a - 2*phi0b) + 
                  curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                  (curvb + 4*pow(curva,2)*d0b + 
                     4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
             ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                  (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
                (pow(curva,4)*pow(curvb,4)) - 
               ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                    16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                    32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                    8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                    64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                    16*pow(curva,2)*pow(d0b,3) + 
                    16*pow(curva,2)*curvb*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                     cos(phi0a - phi0b) - 
                    16*(1 + 2*curva*d0a)*d0b*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4)) + 
               (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,5))))/
           (pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2)*
             sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                     8*pow(curvb,2)*pow(d0a,2) + 
                     16*curva*pow(curvb,2)*pow(d0a,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                     4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                     32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                     8*pow(curva,2)*pow(d0b,2) + 
                     4*pow(curvb,2)*pow(d0b,2) + 
                     32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                     32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                      pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                     8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                     8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                      (curva*d0b + 
                        curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))
                       *cos(phi0a - phi0b) + 
                     pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                      cos(2*(phi0a - phi0b)))*
                   pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                     curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                 (pow(curva,4)*pow(curvb,4))))))/
        (2.*sqrt(4/pow(curvb,2) - 
            (4*pow(1 + 2*curvb*d0b,2)*pow(cos(phi0b),2))/pow(curvb,2) - 
            (4*(1 + 2*curvb*d0b)*cos(phi0b)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b))))/
             (curvb*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
                 pow(curva,2)*
                  (1 + 4*curvb*d0b + 
                    4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
                 2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  cos(phi0a - phi0b))) - 
            (2*pow(curva,2) + 2*pow(curvb,2) - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0a,2) - 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3) - 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4) - 
               64*pow(curva,3)*curvb*d0a*d0b - 
               64*curva*pow(curvb,3)*d0a*d0b - 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b - 
               320*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b - 
               32*pow(curva,2)*pow(curvb,2)*pow(d0b,2) - 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2) - 
               64*curva*pow(curvb,4)*d0a*pow(d0b,2) - 
               320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) - 
               320*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2) - 
               64*pow(curva,2)*pow(curvb,3)*pow(d0b,3) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3) - 
               32*pow(curva,2)*pow(curvb,4)*pow(d0b,4) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4) + 
               pow(1 + 2*curva*d0a,2)*
                (-2*pow(curvb,2) + 16*pow(curvb,4)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*d0a*
                   (1 + 4*curvb*d0b + 
                     2*pow(curvb,2)*(pow(d0a,2) + 2*pow(d0b,2))) + 
                  pow(curva,2)*
                   (1 + 8*curvb*d0b + 
                     64*pow(curvb,3)*d0b*(pow(d0a,2) + pow(d0b,2)) + 
                     8*pow(curvb,2)*(2*pow(d0a,2) + 5*pow(d0b,2)) + 
                     16*pow(curvb,4)*
                      (pow(d0a,4) + 4*pow(d0a,2)*pow(d0b,2) + 
                        2*pow(d0b,4))))*cos(2*phi0a) - 
               2*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,3)*
                (4*pow(curva,2)*d0b + 
                  curvb*(1 + 4*curva*d0a + 
                     4*pow(curva,2)*(pow(d0a,2) + pow(d0b,2))))*
                cos(phi0a - 3*phi0b) + 
               pow(curva,2)*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,3)*d0a*cos(2*(phi0a - 2*phi0b)) + 
               4*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - 2*phi0b)) + 
               8*pow(curva,2)*curvb*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - 2*phi0b)) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - 2*phi0b)) + 
               32*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - 2*phi0b)) + 
               16*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - 2*phi0b)) + 
               pow(curvb,2)*cos(4*phi0a - 2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(4*phi0a - 2*phi0b) + 
               24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(4*phi0a - 2*phi0b) + 
               32*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(4*phi0a - 2*phi0b) + 
               16*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(4*phi0a - 2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(4*phi0a - 2*phi0b) + 
               32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               96*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               128*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) + 
               64*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(4*phi0a - 2*phi0b) - 2*curva*curvb*cos(phi0a - phi0b) + 
               12*pow(curva,2)*curvb*d0a*cos(phi0a - phi0b) + 
               8*pow(curvb,3)*d0a*cos(phi0a - phi0b) + 
               48*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a - phi0b) + 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a - phi0b) + 
               32*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a - phi0b) + 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a - phi0b) + 
               8*pow(curva,3)*d0b*cos(phi0a - phi0b) + 
               12*curva*pow(curvb,2)*d0b*cos(phi0a - phi0b) + 
               16*pow(curva,4)*d0a*d0b*cos(phi0a - phi0b) + 
               216*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - phi0b) + 
               16*pow(curvb,4)*d0a*d0b*cos(phi0a - phi0b) + 
               576*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a - phi0b) + 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a - phi0b) + 
               384*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a - phi0b) + 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a - phi0b) + 
               56*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a - phi0b) + 
               48*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a - phi0b) + 
               112*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a - phi0b) + 
               576*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               1440*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               960*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a - phi0b) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               32*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a - phi0b) + 
               288*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               384*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               960*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               640*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a - phi0b) + 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a - phi0b) + 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a - phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a - phi0b) - 
               2*pow(curva,2)*cos(2*(phi0a - phi0b)) - 
               2*pow(curvb,2)*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,3)*d0a*cos(2*(phi0a - phi0b)) - 
               24*curva*pow(curvb,2)*d0a*cos(2*(phi0a - phi0b)) - 
               8*pow(curva,4)*pow(d0a,2)*cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*
                cos(2*(phi0a - phi0b)) - 
               24*pow(curva,2)*curvb*d0b*cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,3)*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,3)*curvb*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,3)*d0a*d0b*cos(2*(phi0a - phi0b)) - 
               96*pow(curva,4)*curvb*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*d0b*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*(phi0a - phi0b)) - 
               88*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               8*pow(curvb,4)*pow(d0b,2)*cos(2*(phi0a - phi0b)) - 
               352*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               96*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               352*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*(phi0a - phi0b)) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,3)*pow(curvb,3)*d0a*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*(phi0a - phi0b)) - 
               64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,3)*pow(curvb,4)*d0a*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*(phi0a - phi0b)) + 
               2*curva*curvb*cos(3*(phi0a - phi0b)) + 
               12*pow(curva,2)*curvb*d0a*cos(3*(phi0a - phi0b)) + 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*(phi0a - phi0b)) + 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*(phi0a - phi0b)) + 
               12*curva*pow(curvb,2)*d0b*cos(3*(phi0a - phi0b)) + 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*(phi0a - phi0b)) + 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*(phi0a - phi0b)) + 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*(phi0a - phi0b)) + 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*(phi0a - phi0b)) + 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*(phi0a - phi0b)) + 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*(phi0a - phi0b)) + 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*(phi0a - phi0b)) - 2*curva*curvb*cos(3*phi0a - phi0b) - 
               12*pow(curva,2)*curvb*d0a*cos(3*phi0a - phi0b) - 
               8*pow(curvb,3)*d0a*cos(3*phi0a - phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               56*curva*pow(curvb,3)*pow(d0a,2)*cos(3*phi0a - phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(3*phi0a - phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(3*phi0a - phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(3*phi0a - phi0b) - 
               12*curva*pow(curvb,2)*d0b*cos(3*phi0a - phi0b) - 
               72*pow(curva,2)*pow(curvb,2)*d0a*d0b*
                cos(3*phi0a - phi0b) - 
               16*pow(curvb,4)*d0a*d0b*cos(3*phi0a - phi0b) - 
               144*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               112*curva*pow(curvb,4)*pow(d0a,2)*d0b*
                cos(3*phi0a - phi0b) - 
               96*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(3*phi0a - phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(3*phi0a - phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(3*phi0a - phi0b) - 
               144*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               288*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(3*phi0a - phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(3*phi0a - phi0b) - 
               96*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               192*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(3*phi0a - phi0b) - 2*pow(curva,2)*cos(2*phi0b) + 
               pow(curvb,2)*cos(2*phi0b) + 
               8*curva*pow(curvb,2)*d0a*cos(2*phi0b) + 
               40*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0b) + 
               64*pow(curva,3)*pow(curvb,2)*pow(d0a,3)*cos(2*phi0b) + 
               32*pow(curva,4)*pow(curvb,2)*pow(d0a,4)*cos(2*phi0b) + 
               8*pow(curva,2)*curvb*d0b*cos(2*phi0b) + 
               4*pow(curvb,3)*d0b*cos(2*phi0b) + 
               64*pow(curva,3)*curvb*d0a*d0b*cos(2*phi0b) + 
               32*curva*pow(curvb,3)*d0a*d0b*cos(2*phi0b) + 
               64*pow(curva,4)*curvb*pow(d0a,2)*d0b*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,3)*pow(d0a,2)*d0b*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,3)*pow(d0a,3)*
                d0b*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,3)*pow(d0a,4)*d0b*
                cos(2*phi0b) + 16*pow(curva,4)*pow(d0b,2)*cos(2*phi0b) + 
               72*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(2*phi0b) + 
               4*pow(curvb,4)*pow(d0b,2)*cos(2*phi0b) + 
               320*pow(curva,3)*pow(curvb,2)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 32*curva*pow(curvb,4)*d0a*pow(d0b,2)*
                cos(2*phi0b) + 320*pow(curva,4)*pow(curvb,2)*pow(d0a,2)*
                pow(d0b,2)*cos(2*phi0b) + 
               160*pow(curva,2)*pow(curvb,4)*pow(d0a,2)*pow(d0b,2)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*pow(d0a,3)*
                pow(d0b,2)*cos(2*phi0b) + 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,4)*pow(d0b,2)*
                cos(2*phi0b) + 96*pow(curva,4)*curvb*pow(d0b,3)*
                cos(2*phi0b) + 128*pow(curva,2)*pow(curvb,3)*pow(d0b,3)*
                cos(2*phi0b) + 512*pow(curva,3)*pow(curvb,3)*d0a*
                pow(d0b,3)*cos(2*phi0b) + 
               512*pow(curva,4)*pow(curvb,3)*pow(d0a,2)*pow(d0b,3)*
                cos(2*phi0b) + 208*pow(curva,4)*pow(curvb,2)*pow(d0b,4)*
                cos(2*phi0b) + 64*pow(curva,2)*pow(curvb,4)*pow(d0b,4)*
                cos(2*phi0b) + 256*pow(curva,3)*pow(curvb,4)*d0a*
                pow(d0b,4)*cos(2*phi0b) + 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,2)*pow(d0b,4)*
                cos(2*phi0b) + 192*pow(curva,4)*pow(curvb,3)*pow(d0b,5)*
                cos(2*phi0b) + 64*pow(curva,4)*pow(curvb,4)*pow(d0b,6)*
                cos(2*phi0b) + 4*curva*curvb*cos(phi0a + phi0b) - 
               24*pow(curva,3)*curvb*pow(d0a,2)*cos(phi0a + phi0b) - 
               32*curva*pow(curvb,3)*pow(d0a,2)*cos(phi0a + phi0b) - 
               16*pow(curva,4)*curvb*pow(d0a,3)*cos(phi0a + phi0b) - 
               128*pow(curva,2)*pow(curvb,3)*pow(d0a,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0a,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,4)*pow(curvb,3)*pow(d0a,5)*
                cos(phi0a + phi0b) - 
               80*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a + phi0b) - 
               240*pow(curva,3)*pow(curvb,2)*pow(d0a,2)*d0b*
                cos(phi0a + phi0b) - 
               64*curva*pow(curvb,4)*pow(d0a,2)*d0b*cos(phi0a + phi0b) - 
               160*pow(curva,4)*pow(curvb,2)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               256*pow(curva,2)*pow(curvb,4)*pow(d0a,3)*d0b*
                cos(phi0a + phi0b) - 
               320*pow(curva,3)*pow(curvb,4)*pow(d0a,4)*d0b*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*pow(d0a,5)*d0b*
                cos(phi0a + phi0b) - 
               32*pow(curva,3)*curvb*pow(d0b,2)*cos(phi0a + phi0b) - 
               24*curva*pow(curvb,3)*pow(d0b,2)*cos(phi0a + phi0b) - 
               64*pow(curva,4)*curvb*d0a*pow(d0b,2)*cos(phi0a + phi0b) - 
               240*pow(curva,2)*pow(curvb,3)*d0a*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               576*pow(curva,3)*pow(curvb,3)*pow(d0a,2)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               384*pow(curva,4)*pow(curvb,3)*pow(d0a,3)*pow(d0b,2)*
                cos(phi0a + phi0b) - 
               128*pow(curva,3)*pow(curvb,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               16*curva*pow(curvb,4)*pow(d0b,3)*cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,2)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,2)*pow(curvb,4)*d0a*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               384*pow(curva,3)*pow(curvb,4)*pow(d0a,2)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               256*pow(curva,4)*pow(curvb,4)*pow(d0a,3)*pow(d0b,3)*
                cos(phi0a + phi0b) - 
               160*pow(curva,3)*pow(curvb,3)*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               320*pow(curva,4)*pow(curvb,3)*d0a*pow(d0b,4)*
                cos(phi0a + phi0b) - 
               64*pow(curva,3)*pow(curvb,4)*pow(d0b,5)*
                cos(phi0a + phi0b) - 
               128*pow(curva,4)*pow(curvb,4)*d0a*pow(d0b,5)*
                cos(phi0a + phi0b))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2) + 
            (4*sqrt(2)*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0b)*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             (pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b)) + 
            (2*sqrt(2)*pow(curva,2)*pow(curvb,2)*
               (-((1 + 2*curva*d0a)*
                    (curva + 4*pow(curvb,2)*d0a + 
                      4*curva*pow(curvb,2)*pow(d0a,2))*cos(phi0a)) + 
                 (1 + 2*curvb*d0b)*
                  (curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     cos(phi0a - 2*phi0b) + 
                    curvb*pow(1 + 2*curva*d0a,2)*cos(2*phi0a - phi0b) - 
                    (curvb + 4*pow(curva,2)*d0b + 
                       4*pow(curva,2)*curvb*pow(d0b,2))*cos(phi0b)))*
               sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                       8*pow(curvb,2)*pow(d0a,2) + 
                       16*curva*pow(curvb,2)*pow(d0a,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                       4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                       32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                       8*pow(curva,2)*pow(d0b,2) + 
                       4*pow(curvb,2)*pow(d0b,2) + 
                       32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                       32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                        pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                       8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                       8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                        (curva*d0b + 
                          curvb*
                           (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                        cos(phi0a - phi0b) + 
                       pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                        cos(2*(phi0a - phi0b)))*
                     pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                       curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                   (pow(curva,4)*pow(curvb,4)))))/
             pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
               pow(curva,2)*(1 + 4*curvb*d0b + 
                  4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
               2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                cos(phi0a - phi0b),2))))/4. );

   double dydd0a( -((4*curva*pow(curvb,2) + 
           8*pow(curva,2)*pow(curvb,2)*d0a - 
           4*pow(curva,2)*curvb*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (2*pow(curva,2)*cos(phi0a) + 4*pow(curvb,2)*cos(phi0a) + 
        24*curva*pow(curvb,2)*d0a*cos(phi0a) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(phi0a) - 
        2*pow(curva,2)*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*curvb*d0b*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        4*curva*curvb*cos(2*phi0a - phi0b) - 
        8*pow(curva,2)*curvb*d0a*cos(2*phi0a - phi0b) - 
        8*curva*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0a)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curva + 8*pow(curva,2)*d0a + 16*pow(curvb,2)*d0a + 
                  48*curva*pow(curvb,2)*pow(d0a,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,3) + 
                  32*curva*curvb*d0b + 64*pow(curva,2)*curvb*d0a*d0b + 
                  32*curva*pow(curvb,2)*pow(d0b,2) + 
                  64*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2) - 
                  8*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(phi0a - phi0b) - 
                  16*curva*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curva*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydphi0a( -(curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
         sin(phi0a - phi0b)*(curva*cos(phi0a) + 
           2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (-(curva*sin(phi0a)) - 2*pow(curva,2)*d0a*sin(phi0a) - 
        4*pow(curvb,2)*d0a*sin(phi0a) - 
        12*curva*pow(curvb,2)*pow(d0a,2)*sin(phi0a) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*sin(phi0a) + 
        curva*sin(phi0a - 2*phi0b) + 
        2*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) + 
        4*curva*curvb*d0b*sin(phi0a - 2*phi0b) + 
        8*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) + 
        4*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) + 
        8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) + 2*curvb*sin(2*phi0a - phi0b) + 
        8*curva*curvb*d0a*sin(2*phi0a - phi0b) + 
        8*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) + 
        4*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) + 
        16*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) + 
        16*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(1 + 2*curva*d0a)*cos(phi0a)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,3)) - 
             ((8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) - 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurva( -((4*pow(curvb,2)*d0a + 
           2*curva*(1 + 4*curvb*d0b + 
              4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
           4*curva*curvb*d0a*(1 + 2*curvb*d0b)*cos(phi0a - phi0b) - 
           2*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (cos(phi0a) + 4*curva*d0a*cos(phi0a) + 
        12*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
        16*curva*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
        cos(phi0a - 2*phi0b) - 4*curva*d0a*cos(phi0a - 2*phi0b) - 
        4*curvb*d0b*cos(phi0a - 2*phi0b) - 
        16*curva*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
        4*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        16*curva*pow(curvb,2)*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        4*curvb*d0a*cos(2*phi0a - phi0b) - 
        8*curva*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
        8*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
        16*curva*pow(curvb,2)*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) + 
        8*curva*d0b*cos(phi0b) + 24*curva*curvb*pow(d0b,2)*cos(phi0b) + 
        16*curva*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*curva*pow(curvb,2)*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                (2*curvb*d0a*sin(phi0a) - (1 + 2*curvb*d0b)*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((4*d0a + 8*curva*pow(d0a,2) + 
                  16*pow(curvb,2)*pow(d0a,3) + 
                  16*curva*pow(curvb,2)*pow(d0a,4) + 32*curvb*d0a*d0b + 
                  64*curva*curvb*pow(d0a,2)*d0b + 16*curva*pow(d0b,2) + 
                  32*pow(curvb,2)*d0a*pow(d0b,2) + 
                  64*curva*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                  32*curva*curvb*pow(d0b,3) + 
                  16*curva*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0b + curvb*(pow(d0a,2) + pow(d0b,2)))*
                   cos(phi0a - phi0b) - 
                  16*d0a*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*d0a*(1 + 2*curva*d0a)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,5)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydd0b( -((pow(curva,2)*(4*curvb + 8*pow(curvb,2)*d0b) - 
           4*curva*pow(curvb,2)*(1 + 2*curva*d0a)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (-4*curva*curvb*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*curvb*d0a*cos(phi0a - 2*phi0b) - 
        8*curva*pow(curvb,2)*d0b*cos(phi0a - 2*phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*d0a*d0b*cos(phi0a - 2*phi0b) - 
        2*pow(curvb,2)*cos(2*phi0a - phi0b) - 
        8*curva*pow(curvb,2)*d0a*cos(2*phi0a - phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*cos(2*phi0a - phi0b) + 
        4*pow(curva,2)*cos(phi0b) + 2*pow(curvb,2)*cos(phi0b) + 
        24*pow(curva,2)*curvb*d0b*cos(phi0b) + 
        24*pow(curva,2)*pow(curvb,2)*pow(d0b,2)*cos(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*sin(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,3)) - 
             ((4*curvb + 32*curva*curvb*d0a + 
                  32*pow(curva,2)*curvb*pow(d0a,2) + 
                  16*pow(curva,2)*d0b + 8*pow(curvb,2)*d0b + 
                  64*curva*pow(curvb,2)*d0a*d0b + 
                  64*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b + 
                  48*pow(curva,2)*curvb*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0b,3) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva + 2*curva*curvb*d0b)*cos(phi0a - phi0b) - 
                  16*curvb*(1 + 2*curva*d0a)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*curvb*pow(1 + 2*curva*d0a,2)*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
	 )) );
   double dydphi0b( (curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
        sin(phi0a - phi0b)*(curva*cos(phi0a) + 
          2*pow(curva,2)*d0a*cos(phi0a) + 4*pow(curvb,2)*d0a*cos(phi0a) + 
          12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
          curva*cos(phi0a - 2*phi0b) - 
          2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
          4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
          8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
          4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
           cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
          4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
          4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
          2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
          8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
          8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
           cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
          4*pow(curva,2)*d0b*cos(phi0b) + 2*pow(curvb,2)*d0b*cos(phi0b) + 
          12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
          8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
          sqrt(2)*pow(curva,2)*pow(curvb,2)*
           sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (2.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (-2*curva*sin(phi0a - 2*phi0b) - 
        4*pow(curva,2)*d0a*sin(phi0a - 2*phi0b) - 
        8*curva*curvb*d0b*sin(phi0a - 2*phi0b) - 
        16*pow(curva,2)*curvb*d0a*d0b*sin(phi0a - 2*phi0b) - 
        8*curva*pow(curvb,2)*pow(d0b,2)*sin(phi0a - 2*phi0b) - 
        16*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
         sin(phi0a - 2*phi0b) - curvb*sin(2*phi0a - phi0b) - 
        4*curva*curvb*d0a*sin(2*phi0a - phi0b) - 
        4*pow(curva,2)*curvb*pow(d0a,2)*sin(2*phi0a - phi0b) - 
        2*pow(curvb,2)*d0b*sin(2*phi0a - phi0b) - 
        8*curva*pow(curvb,2)*d0a*d0b*sin(2*phi0a - phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
         sin(2*phi0a - phi0b) - curvb*sin(phi0b) - 
        4*pow(curva,2)*d0b*sin(phi0b) - 2*pow(curvb,2)*d0b*sin(phi0b) - 
        12*pow(curva,2)*curvb*pow(d0b,2)*sin(phi0b) - 
        8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*sin(phi0b) + 
        (pow(curva,2)*pow(curvb,2)*
           ((2*(1 + 2*curvb*d0b)*
                (-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*cos(phi0b)*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,3)*pow(curvb,4)) - 
             ((-8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   sin(phi0a - phi0b) + 
                  2*pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   sin(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );
   double dydcurvb( -((2*curvb + 8*curva*curvb*d0a + 
           pow(curva,2)*(4*d0b + 8*curvb*(pow(d0a,2) + pow(d0b,2))) - 
           4*curva*curvb*(1 + 2*curva*d0a)*d0b*cos(phi0a - phi0b) - 
           2*curva*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b))*
         (curva*cos(phi0a) + 2*pow(curva,2)*d0a*cos(phi0a) + 
           4*pow(curvb,2)*d0a*cos(phi0a) + 
           12*curva*pow(curvb,2)*pow(d0a,2)*cos(phi0a) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,3)*cos(phi0a) - 
           curva*cos(phi0a - 2*phi0b) - 
           2*pow(curva,2)*d0a*cos(phi0a - 2*phi0b) - 
           4*curva*curvb*d0b*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*curvb*d0a*d0b*cos(phi0a - 2*phi0b) - 
           4*curva*pow(curvb,2)*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*d0a*pow(d0b,2)*
            cos(phi0a - 2*phi0b) - curvb*cos(2*phi0a - phi0b) - 
           4*curva*curvb*d0a*cos(2*phi0a - phi0b) - 
           4*pow(curva,2)*curvb*pow(d0a,2)*cos(2*phi0a - phi0b) - 
           2*pow(curvb,2)*d0b*cos(2*phi0a - phi0b) - 
           8*curva*pow(curvb,2)*d0a*d0b*cos(2*phi0a - phi0b) - 
           8*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*d0b*
            cos(2*phi0a - phi0b) + curvb*cos(phi0b) + 
           4*pow(curva,2)*d0b*cos(phi0b) + 
           2*pow(curvb,2)*d0b*cos(phi0b) + 
           12*pow(curva,2)*curvb*pow(d0b,2)*cos(phi0b) + 
           8*pow(curva,2)*pow(curvb,2)*pow(d0b,3)*cos(phi0b) + 
           sqrt(2)*pow(curva,2)*pow(curvb,2)*
            sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                    8*pow(curvb,2)*pow(d0a,2) + 
                    16*curva*pow(curvb,2)*pow(d0a,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                    4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                    32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                    8*pow(curva,2)*pow(d0b,2) + 
                    4*pow(curvb,2)*pow(d0b,2) + 
                    32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                    32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                     pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                    8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                    8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                     (curva*d0b + 
                       curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                     cos(phi0a - phi0b) + 
                    pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                     cos(2*(phi0a - phi0b)))*
                  pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                    curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
                (pow(curva,4)*pow(curvb,4))))))/
      (4.*pow(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          ,2)) + (8*curvb*d0a*cos(phi0a) + 
        24*curva*curvb*pow(d0a,2)*cos(phi0a) + 
        16*pow(curva,2)*curvb*pow(d0a,3)*cos(phi0a) - 
        4*curva*d0b*cos(phi0a - 2*phi0b) - 
        8*pow(curva,2)*d0a*d0b*cos(phi0a - 2*phi0b) - 
        8*curva*curvb*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        16*pow(curva,2)*curvb*d0a*pow(d0b,2)*cos(phi0a - 2*phi0b) - 
        cos(2*phi0a - phi0b) - 4*curva*d0a*cos(2*phi0a - phi0b) - 
        4*pow(curva,2)*pow(d0a,2)*cos(2*phi0a - phi0b) - 
        4*curvb*d0b*cos(2*phi0a - phi0b) - 
        16*curva*curvb*d0a*d0b*cos(2*phi0a - phi0b) - 
        16*pow(curva,2)*curvb*pow(d0a,2)*d0b*cos(2*phi0a - phi0b) + 
        cos(phi0b) + 4*curvb*d0b*cos(phi0b) + 
        12*pow(curva,2)*pow(d0b,2)*cos(phi0b) + 
        16*pow(curva,2)*curvb*pow(d0b,3)*cos(phi0b) + 
        2*sqrt(2)*pow(curva,2)*curvb*
         sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                 8*pow(curvb,2)*pow(d0a,2) + 
                 16*curva*pow(curvb,2)*pow(d0a,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 4*curvb*d0b + 
                 32*curva*curvb*d0a*d0b + 
                 32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                 8*pow(curva,2)*pow(d0b,2) + 
                 4*pow(curvb,2)*pow(d0b,2) + 
                 32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                 32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*pow(d0b,2) + 
                 16*pow(curva,2)*curvb*pow(d0b,3) + 
                 8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                 8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                  (curva*d0b + curvb*
                     (d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                  cos(phi0a - phi0b) + 
                 pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                  cos(2*(phi0a - phi0b)))*
               pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                 curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
             (pow(curva,4)*pow(curvb,4)))) + 
        (pow(curva,2)*pow(curvb,2)*
           ((-2*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                ((1 + 2*curva*d0a)*sin(phi0a) - 2*curva*d0b*sin(phi0b))*
                (curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b)))/
              (pow(curva,4)*pow(curvb,4)) - 
             ((16*curvb*pow(d0a,2) + 32*curva*curvb*pow(d0a,3) + 
                  16*pow(curva,2)*curvb*pow(d0a,4) + 4*d0b + 
                  32*curva*d0a*d0b + 32*pow(curva,2)*pow(d0a,2)*d0b + 
                  8*curvb*pow(d0b,2) + 64*curva*curvb*d0a*pow(d0b,2) + 
                  64*pow(curva,2)*curvb*pow(d0a,2)*pow(d0b,2) + 
                  16*pow(curva,2)*pow(d0b,3) + 
                  16*pow(curva,2)*curvb*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (d0a + curva*pow(d0a,2) + curva*pow(d0b,2))*
                   cos(phi0a - phi0b) - 
                  16*(1 + 2*curva*d0a)*d0b*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  4*pow(1 + 2*curva*d0a,2)*d0b*(1 + 2*curvb*d0b)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,4)) + 
             (4*(-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                  8*pow(curvb,2)*pow(d0a,2) + 
                  16*curva*pow(curvb,2)*pow(d0a,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                  4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                  32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                  8*pow(curva,2)*pow(d0b,2) + 
                  4*pow(curvb,2)*pow(d0b,2) + 
                  32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                  32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                   pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                  8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                  8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                   (curva*d0b + 
                     curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                   cos(phi0a - phi0b) + 
                  pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                   cos(2*(phi0a - phi0b)))*
                pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                  curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
              (pow(curva,4)*pow(curvb,5))))/
         (sqrt(2)*sqrt(-(((-1 + 4*curva*d0a + 4*pow(curva,2)*pow(d0a,2) + 
                   8*pow(curvb,2)*pow(d0a,2) + 
                   16*curva*pow(curvb,2)*pow(d0a,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0a,4) + 
                   4*curvb*d0b + 32*curva*curvb*d0a*d0b + 
                   32*pow(curva,2)*curvb*pow(d0a,2)*d0b + 
                   8*pow(curva,2)*pow(d0b,2) + 
                   4*pow(curvb,2)*pow(d0b,2) + 
                   32*curva*pow(curvb,2)*d0a*pow(d0b,2) + 
                   32*pow(curva,2)*pow(curvb,2)*pow(d0a,2)*
                    pow(d0b,2) + 16*pow(curva,2)*curvb*pow(d0b,3) + 
                   8*pow(curva,2)*pow(curvb,2)*pow(d0b,4) - 
                   8*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*
                    (curva*d0b + 
                      curvb*(d0a + curva*pow(d0a,2) + curva*pow(d0b,2)))*
                    cos(phi0a - phi0b) + 
                   pow(1 + 2*curva*d0a,2)*pow(1 + 2*curvb*d0b,2)*
                    cos(2*(phi0a - phi0b)))*
                 pow(curvb*(1 + 2*curva*d0a)*sin(phi0a) - 
                   curva*(1 + 2*curvb*d0b)*sin(phi0b),2))/
               (pow(curva,4)*pow(curvb,4))))))/
      (4.*(pow(curvb,2) + 4*curva*pow(curvb,2)*d0a + 
          pow(curva,2)*(1 + 4*curvb*d0b + 
             4*pow(curvb,2)*(pow(d0a,2) + pow(d0b,2))) - 
          2*curva*curvb*(1 + 2*curva*d0a)*(1 + 2*curvb*d0b)*cos(phi0a - phi0b)
          )) );

   ex = sqrt( ed0ad0a * sqr( dxdd0a ) +
	      ephi0aphi0a * sqr( dxdphi0a ) +
	      ecurvacurva * sqr( dxdcurva ) +
	      2 * ed0acurva * dxdd0a * dxdcurva +
	      2 * ed0aphi0a * dxdd0a * dxdphi0a +
	      2 * ecurvaphi0a * dxdcurva * dxdphi0a +
	      ed0bd0b * sqr( dxdd0b ) +
	      ephi0bphi0b * sqr( dxdphi0b ) +
	      ecurvbcurvb * sqr( dxdcurvb ) +
	      2 * ed0bcurvb * dxdd0b * dxdcurvb +
	      2 * ed0bphi0b * dxdd0b * dxdphi0b +
	      2 * ecurvbphi0b * dxdcurvb * dxdphi0b );

   ey = sqrt( ed0ad0a * sqr( dydd0a ) +
	      ephi0aphi0a * sqr( dydphi0a ) +
	      ecurvacurva * sqr( dydcurva ) +
	      2 * ed0acurva * dydd0a * dydcurva +
	      2 * ed0aphi0a * dydd0a * dydphi0a +
	      2 * ecurvaphi0a * dydcurva * dydphi0a +
	      ed0bd0b * sqr( dydd0b ) +
	      ephi0bphi0b * sqr( dydphi0b ) +
	      ecurvbcurvb * sqr( dydcurvb ) +
	      2 * ed0bcurvb * dydd0b * dydcurvb +
	      2 * ed0bphi0b * dydd0b * dydphi0b +
	      2 * ecurvbphi0b * dydcurvb * dydphi0b );

   return true;
}

